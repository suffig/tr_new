import{b as ee,c as Ee,S as he,s as I,u as q,r as y,j as e,z as P,t as J,a as pe,L as De,d as Re,e as Be,f as _e,h as Le,i as Ve,k as re,l as ue,g as be,m as Ke,n as Oe,o as Ge,p as Je}from"./main-j9d4A_9Q.js";import{g as Ue,r as He,u as We,a as qe,s as Ze,c as Qe,b as Ye}from"./versionTeamManager-D0xpEaBm.js";import{B as ce}from"./banTypes-DuNOJEIt.js";import{d as H,s as G}from"./dataManager-C-az5647.js";const Xe="alcoholCalculatorValues",ye="2.0",de=(n=null)=>{const t=n||ee();return{aekPlayer:"",realPlayer:"",aekGoals:0,realGoals:0,mode:"manual",gameDay:new Date().toISOString().split("T")[0],beerCount:{aek:0,real:0},alexanderShots:{cl40:0,cl20:0},philipShots:{cl40:0,cl20:0},cumulativeShots:{aek:0,real:0,total:0,lastMatchId:null,lastUpdated:null},lastUpdated:new Date().toISOString(),drinkingStartTime:null,version:ye,season:t}},ve=(n=null)=>{try{const t=n||ee(),s=Ee("alcoholCalculator",t);let a=localStorage.getItem(s);if(!a&&t===he.LEGACY&&(a=localStorage.getItem(Xe),a&&(console.log("Migrating legacy alcohol calculator data to season-based storage"),localStorage.setItem(s,a))),!a)return de(t);const r=JSON.parse(a);if(!r.version||r.version!==ye&&r.version!=="1.0")return console.log("Alcohol calculator: Version mismatch, using defaults"),de(t);const i=de(t);return{...i,...r,season:t,beerCount:{...i.beerCount,...r.beerCount||{}},alexanderShots:{...i.alexanderShots,...r.alexanderShots||{}},philipShots:{...i.philipShots,...r.philipShots||{}},cumulativeShots:{...i.cumulativeShots,...r.cumulativeShots||{}}}}catch(t){return console.error("Error loading alcohol calculator values:",t),de(n)}},et=(n,t=null)=>{try{const s=t||ee(),a={...n,lastUpdated:new Date().toISOString(),version:ye,season:s},r=Ee("alcoholCalculator",s);return localStorage.setItem(r,JSON.stringify(a)),typeof window<"u"&&window.dispatchEvent(new CustomEvent("alcoholCalculatorValuesChanged",{detail:{...a,season:s}})),!0}catch(s){return console.error("Error saving alcohol calculator values:",s),!1}},tt=(n,t,s=null)=>{const a=s||ee(),r={...t,...n,lastUpdated:new Date().toISOString(),season:a};return n.beerCount&&(r.beerCount={...t.beerCount,...n.beerCount}),n.cumulativeShots&&(r.cumulativeShots={...t.cumulativeShots,...n.cumulativeShots}),et(r,a),r},Te=(n,t=null,s=null)=>{try{const a=s||ee(),r=t||ve(a);if(!n||typeof n!="object")return console.warn("Invalid match object provided to addShotsFromNewMatch"),r;const i=n.goalsa||0,c=n.goalsb||0,u=Math.floor(c/2)*2,o=Math.floor(i/2)*2;return tt({cumulativeShots:{aek:r.cumulativeShots.aek+u,real:r.cumulativeShots.real+o,total:r.cumulativeShots.total+u+o,lastMatchId:n.id,lastUpdated:new Date().toISOString()}},r,a)}catch(a){return console.error("Error adding shots from new match:",a),t||ve(s)}};typeof window<"u"&&(window.updateAlcoholCalculatorFromMatch=n=>{try{Te(n)}catch(t){console.warn("Failed to update alcohol calculator from match:",t)}});async function fe(n){var t,s;try{if(console.log(`Starting deletion of match ${n}`),n==null)throw new Error("No match ID provided for deletion");console.log(`Processing match ID for deletion: ${n} (type: ${typeof n})`);let a;if(typeof n=="string"){if(n.trim()==="")throw new Error("Empty string provided as match ID");if(a=parseInt(n,10),isNaN(a))throw new Error(`Invalid match ID string: "${n}" cannot be converted to number`)}else if(typeof n=="bigint"){const p=Number(n);BigInt(p)===n?a=p:a=n}else if(typeof n=="number")a=n;else throw new Error(`Unsupported match ID type: ${typeof n}. Expected string, number, or bigint.`);const r=typeof a=="number"&&Number.isInteger(a)&&a>0,i=typeof a=="bigint"&&a>0n;if(!r&&!i)throw new Error(`Invalid match ID after conversion: ${a} (type: ${typeof a}). Must be a positive integer.`);console.log(`Converted match ID: ${a} (type: ${typeof a})`);const{data:c,error:u}=await I.select("matches","date,prizeaek,prizereal,goalslista,goalslistb,manofthematch,yellowa,reda,yellowb,redb",{id:a});if(u)throw console.error("Error fetching match:",u),u;if(!c||c.length===0){const p=`Match with ID ${a} not found in database`;throw console.error(p),new Error(p)}const o=c[0];o.date||console.warn(`Match ${a} has no date - this may cause issues with transaction cleanup`),console.log("Deleting match data:",o),console.log(`Fetching transactions for match ${a} before deletion`);const{data:h,error:d}=await I.select("transactions","team,amount,type",{match_id:a});if(d)throw console.error("Error fetching transactions:",d),d;const m=h||[];if(console.log(`Found ${m.length} transactions to reverse:`,m.map(p=>`${p.type}: ${p.amount} (${p.team})`)),console.log(`Reversing financial changes for ${(m==null?void 0:m.length)||0} transactions`),m&&m.length>0)for(const p of m)if(p.type==="Echtgeld-Ausgleich"){const{data:w,error:l}=await I.select("finances","debt",{team:p.team});if(l){console.error(`Error fetching finances for team ${p.team}:`,l);continue}const x=w&&w.length>0?w[0]:null;let E=((x==null?void 0:x.debt)||0)-p.amount;E<0&&(E=0),await I.update("finances",{debt:E},{team:p.team})}else{const{data:w,error:l}=await I.select("finances","balance",{team:p.team});if(l){console.error(`Error fetching finances for team ${p.team}:`,l);continue}const x=w&&w.length>0?w[0]:null;let E=((x==null?void 0:x.balance)||0)-p.amount;E<0&&(E=0),await I.update("finances",{balance:E},{team:p.team})}if(typeof o.prizeaek=="number"&&o.prizeaek!==0){const{data:p,error:w}=await I.select("finances","balance",{team:"AEK"});if(w)console.error("Error fetching AEK finances:",w);else if(p&&p.length>0){const l=p[0];let x=((l==null?void 0:l.balance)||0)-o.prizeaek;x<0&&(x=0),await I.update("finances",{balance:x},{team:"AEK"})}}if(typeof o.prizereal=="number"&&o.prizereal!==0){const{data:p,error:w}=await I.select("finances","balance",{team:"Real"});if(w)console.error("Error fetching Real finances:",w);else if(p&&p.length>0){const l=p[0];let x=((l==null?void 0:l.balance)||0)-o.prizereal;x<0&&(x=0),await I.update("finances",{balance:x},{team:"Real"})}}console.log(`Deleting ${(m==null?void 0:m.length)||0} transactions for match ${a}`);const{error:S}=await I.delete("transactions",{match_id:a});if(S)throw console.error("Error deleting transactions:",S),S;const{data:f,error:g}=await I.select("transactions","id",{match_id:a});if(g)console.warn("Could not verify transaction deletion:",g);else{if(f&&f.length>0)throw console.error(`‚ùå Failed to delete ${f.length} transactions for match ${a}`),new Error(`Transaction deletion incomplete: ${f.length} transactions still exist`);console.log(`‚úÖ Successfully deleted all transactions for match ${a}`)}const k=async(p,w)=>{if(!p||!Array.isArray(p))return;const l={};if(p.length>0&&typeof p[0]=="object"&&p[0].player!==void 0)p.forEach(x=>{x.player&&(l[x.player]=(l[x.player]||0)+(x.count||1))});else for(const x of p)x&&(l[x]=(l[x]||0)+1);for(const[x,v]of Object.entries(l)){const{data:E,error:j}=await I.select("players","goals",{name:x,team:w});if(j){console.error(`Error fetching player ${x} for goal removal:`,j);continue}if(!E||E.length===0){console.warn(`Player ${x} not found in team ${w} for goal removal`);continue}const $=E[0];let _=(($==null?void 0:$.goals)||0)-v;_<0&&(_=0);const{error:T}=await I.update("players",{goals:_},{name:x,team:w});T?console.error(`Error updating goals for player ${x}:`,T):console.log(`‚úÖ Updated goals for ${x} (${w}): ${$.goals} ‚Üí ${_}`)}};if(await k(o.goalslista,"AEK"),await k(o.goalslistb,"Real"),o.manofthematch){let p=null;const w=(l,x)=>!l||!l.length?!1:typeof l[0]=="object"&&l[0].player!==void 0?l.some(v=>v.player===x):l.includes(x);if(w(o.goalslista,o.manofthematch))p="AEK";else if(w(o.goalslistb,o.manofthematch))p="Real";else{const{data:l,error:x}=await I.select("players","team",{name:o.manofthematch});x?console.error(`Error fetching player ${o.manofthematch} for team lookup:`,x):l&&l.length>0?p=l[0].team:console.warn(`Player ${o.manofthematch} not found for SdS team determination`)}if(p){const{data:l,error:x}=await I.select("spieler_des_spiels","count",{name:o.manofthematch,team:p});if(x)console.error(`Error fetching SdS entry for ${o.manofthematch}:`,x);else if(l&&l.length>0){const v=l[0],E=Math.max(0,v.count-1),{error:j}=await I.update("spieler_des_spiels",{count:E},{name:o.manofthematch,team:p});j?console.error(`Error updating SdS count for ${o.manofthematch}:`,j):console.log(`‚úÖ Updated SdS count for ${o.manofthematch} (${p}): ${v.count} ‚Üí ${E}`)}else console.warn(`SdS entry for ${o.manofthematch} in team ${p} not found`)}}(o.yellowa>0||o.reda>0||o.yellowb>0||o.redb>0)&&console.log(`Match had cards: AEK(${o.yellowa}Y,${o.reda}R) Real(${o.yellowb}Y,${o.redb}R)`),console.log(`Deleting match ${a} from matches table`);const{error:b}=await I.delete("matches",{id:a});if(b)throw console.error("Error deleting match:",b),b;const{data:A,error:C}=await I.select("matches","id",{id:a});if(C)console.warn("Could not verify match deletion:",C);else{if(A&&A.length>0)throw console.error(`‚ùå Failed to delete match ${a}`),new Error(`Match deletion failed: match ${a} still exists`);console.log(`‚úÖ Successfully deleted match ${a}`)}console.log(`‚úÖ Successfully deleted match ${a} and all related data`),console.log(`üìã Deletion Summary for Match ${a}:`),console.log("   - Match record: deleted"),console.log(`   - Transactions: ${m.length} deleted`),console.log(`   - Player goals: updated for ${((t=o.goalslista)==null?void 0:t.length)||0} AEK + ${((s=o.goalslistb)==null?void 0:s.length)||0} Real goals`),console.log(`   - Player of the match: ${o.manofthematch?"updated":"none"}`),console.log(`   - Prize money: AEK ${o.prizeaek||0}, Real ${o.prizereal||0} (reversed)`),console.log(`   - Match date: ${o.date}`)}catch(a){throw console.error(`Failed to delete match ${typeof matchId<"u"?matchId:n||"unknown"}:`,a),console.error("Error details:",{matchId:typeof matchId<"u"?matchId:"undefined",matchIdType:typeof matchId,originalId:n,originalIdType:typeof n,errorMessage:a.message,errorStack:a.stack}),a}}class we{static async submitMatch(t){var A;const{date:s,teama:a="AEK",teamb:r="Real",goalsa:i,goalsb:c,goalslista:u=[],goalslistb:o=[],ownGoalsA:h=0,ownGoalsB:d=0,yellowa:m=0,reda:S=0,yellowb:f=0,redb:g=0,manofthematch:k,editId:b=null}=t;try{const{prizeaek:C,prizereal:p,winner:w,loser:l}=this.calculatePrizeMoney(i,c,m,S,f,g);b&&await this.deleteMatchTransactions(b);const x=[...u],v=[...o];h>0&&v.push({count:h,player:"Eigentore_AEK"}),d>0&&x.push({count:d,player:"Eigentore_Real"});const E={date:s,teama:a,teamb:r,goalsa:parseInt(i)||0,goalsb:parseInt(c)||0,goalslista:u,goalslistb:o,yellowa:parseInt(m)||0,reda:parseInt(S)||0,yellowb:parseInt(f)||0,redb:parseInt(g)||0,manofthematch:k||null,prizeaek:C,prizereal:p},j=await I.insert("matches",E);if(j.error)throw new Error(`Match insert failed: ${j.error.message}`);const $=(A=j.data)==null?void 0:A.id,_=new Date().toISOString().slice(0,10);if(x.length>0){const T=x.filter(R=>typeof R=="object"&&R.player?!R.player.startsWith("Eigentore_"):!R.startsWith("Eigentore_"));await this.updatePlayersGoals(T,"AEK")}if(v.length>0){const T=v.filter(R=>typeof R=="object"&&R.player?!R.player.startsWith("Eigentore_"):!R.startsWith("Eigentore_"));await this.updatePlayersGoals(T,"Real")}k&&await this.updatePlayerOfTheMatchStats(k),await this.processFinancialTransactions({matchId:$,date:_,prizeaek:C,prizereal:p,manofthematch:k,winner:w,loser:l}),await this.decrementBansAfterMatch();try{Te({id:$,goalsa:parseInt(i)||0,goalsb:parseInt(c)||0,date:s})}catch(T){console.warn("Failed to update alcohol calculator:",T)}return{success:!0,matchId:$,message:`Match ${a} vs ${r} (${i}:${c}) erfolgreich hinzugef√ºgt`}}catch(C){throw console.error("Error in submitMatch:",C),new Error(`Fehler beim Speichern des Matches: ${C.message}`)}}static calculatePrizeMoney(t,s,a,r,i,c){let u=0,o=0,h=null,d=null;return t>s?(h="AEK",d="Real"):t<s&&(h="Real",d="AEK"),h&&d&&(h==="AEK"?(u=1e6-s*5e4-a*2e4-r*5e4,o=-(5e5+t*5e4+i*2e4+c*5e4)):(o=1e6-t*5e4-i*2e4-c*5e4,u=-(5e5+s*5e4+a*2e4+r*5e4))),{prizeaek:u,prizereal:o,winner:h,loser:d}}static async updatePlayersGoals(t,s){const a={};if(t.length>0&&typeof t[0]=="object"&&t[0].player!==void 0)t.forEach(r=>{r.player&&!r.player.startsWith("Eigentore_")&&(a[r.player]=(a[r.player]||0)+(r.count||1))});else for(const r of t)!r||!r.trim()||r.startsWith("Eigentore_")||(a[r]=(a[r]||0)+1);for(const[r,i]of Object.entries(a))try{const c=await I.select("players","id, goals",{eq:{name:r,team:s}});if(c.data&&c.data.length>0){const u=c.data[0],o=(u.goals||0)+i;await I.update("players",{goals:o},u.id)}}catch(c){console.warn(`Failed to update goals for player ${r}:`,c)}}static async updatePlayerOfTheMatchStats(t){try{const s=await I.select("players","team",{eq:{name:t}});if(!s.data||s.data.length===0){console.warn(`Player ${t} not found for SdS stats`);return}const a=s.data[0].team,r=await I.select("spieler_des_spiels","*",{eq:{name:t,team:a}});if(r.data&&r.data.length>0){const i=r.data[0];await I.update("spieler_des_spiels",{count:i.count+1},i.id)}else await I.insert("spieler_des_spiels",{name:t,team:a,count:1})}catch(s){console.warn(`Failed to update SdS stats for ${t}:`,s)}}static async processFinancialTransactions({matchId:t,date:s,prizeaek:a,prizereal:r,manofthematch:i,winner:c,loser:u}){const o=await this.getTeamFinance("AEK"),h=await this.getTeamFinance("Real");let d=o.balance||0,m=h.balance||0;const S=i?await this.getSdSBonus(i,"AEK"):0,f=i?await this.getSdSBonus(i,"Real"):0;S>0&&(d+=S,await this.insertTransaction({date:s,type:"SdS Bonus",team:"AEK",amount:S,match_id:t,info:"SdS Bonus"}),await this.updateTeamBalance("AEK",d)),f>0&&(m+=f,await this.insertTransaction({date:s,type:"SdS Bonus",team:"Real",amount:f,match_id:t,info:"SdS Bonus"}),await this.updateTeamBalance("Real",m)),a!==0&&(d+=a,d<0&&(d=0),await this.insertTransaction({date:s,type:"Preisgeld",team:"AEK",amount:a,match_id:t,info:"Preisgeld"}),await this.updateTeamBalance("AEK",d)),r!==0&&(m+=r,m<0&&(m=0),await this.insertTransaction({date:s,type:"Preisgeld",team:"Real",amount:r,match_id:t,info:"Preisgeld"}),await this.updateTeamBalance("Real",m)),c&&u&&await this.processEchtgeldAusgleich({date:s,matchId:t,winner:c,loser:u,aekBalance:d,realBalance:m,prizeaek:a,prizereal:r,sdsBonusAek:S>0?1:0,sdsBonusReal:f>0?1:0,manofthematch:i})}static async getTeamFinance(t){const s=await I.select("finances","*",{eq:{team:t}});return s.data&&s.data.length>0?s.data[0]:{balance:0,debt:0}}static async getSdSBonus(t,s){const a=await I.select("players","team",{eq:{name:t}});return a.data&&a.data.length>0&&a.data[0].team===s?1e5:0}static async insertTransaction(t){return await I.insert("transactions",t)}static async updateTeamBalance(t,s){const a=await I.select("finances","id",{eq:{team:t}});return a.data&&a.data.length>0?await I.update("finances",{balance:s},a.data[0].id):await I.insert("finances",{team:t,balance:s,debt:0})}static async processEchtgeldAusgleich({date:t,matchId:s,winner:a,loser:r,aekBalance:i,realBalance:c,prizeaek:u,prizereal:o,sdsBonusAek:h,sdsBonusReal:d,manofthematch:m}){const S=await this.getTeamFinance("AEK"),f=await this.getTeamFinance("Real"),g={AEK:S.debt||0,Real:f.debt||0},k=($,_,T)=>{let R=$;T&&(R+=1e5);let O=(Math.abs(_)-R)/1e5;return O<0&&(O=0),5+Math.round(O)},b=k(i,u,h),A=k(c,o,d),C=r==="AEK"?b:A,p=g[a],w=g[r],l=Math.min(p,C*1),x=Math.max(0,p-l),v=C*1-l,E=w+Math.max(0,v),j=await I.select("finances","id",{eq:{team:a}});if(j.data&&j.data.length>0&&await I.update("finances",{debt:x},j.data[0].id),v>0){await this.insertTransaction({date:t,type:"Echtgeld-Ausgleich",team:r,amount:Math.max(0,v),match_id:s,info:"Echtgeld-Ausgleich"});const $=await I.select("finances","id",{eq:{team:r}});$.data&&$.data.length>0&&await I.update("finances",{debt:E},$.data[0].id)}l>0&&await this.insertTransaction({date:t,type:"Echtgeld-Ausgleich (getilgt)",team:a,amount:-l,match_id:s,info:"Echtgeld-Ausgleich (getilgt)"})}static async deleteMatchTransactions(t){try{await fe(t)}catch(s){throw console.error(`Failed to delete match ${t} comprehensively:`,s),s}}static async decrementBansAfterMatch(){try{const t=await I.select("bans","*");if(!t.data)return;for(const s of t.data)if(s.matchesserved<s.totalgames){const a=s.matchesserved+1;await I.update("bans",{matchesserved:a},s.id)}}catch(t){console.warn("Failed to decrement bans:",t)}}}function st(){const{data:n}=q("players","*"),[t,s]=y.useState(!1),[a,r]=y.useState({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),[i,c]=y.useState(!1),u=(l,x,v)=>l.reduce((j,$)=>j+$.count,0)+v,o=l=>{r(x=>{const v={...x,...l};v.goalsa=u(v.goalslista,v.ownGoalsA,v.ownGoalsB),v.goalsb=u(v.goalslistb,v.ownGoalsB,v.ownGoalsA);const{prizeaek:E,prizereal:j}=we.calculatePrizeMoney(v.goalsa,v.goalsb,v.yellowa,v.reda,v.yellowb,v.redb);return v.prizeaek=E,v.prizereal=j,v})},h=(l,x)=>{o({[l]:x})},d=async l=>{l.preventDefault(),c(!0);try{const x=await we.submitMatch({date:a.date,teama:a.teama.trim(),teamb:a.teamb.trim(),goalsa:a.goalsa,goalsb:a.goalsb,goalslista:a.goalslista,goalslistb:a.goalslistb,ownGoalsA:a.ownGoalsA,ownGoalsB:a.ownGoalsB,yellowa:parseInt(a.yellowa)||0,reda:parseInt(a.reda)||0,yellowb:parseInt(a.yellowb)||0,redb:parseInt(a.redb)||0,manofthematch:a.manofthematch||null});r({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),s(!1),P.success(x.message),J("match-created",{matchId:x.matchId||"latest",date:a.date,teama:a.teama,teamb:a.teamb,goalsa:a.goalsa,goalsb:a.goalsb,manofthematch:a.manofthematch})}catch(x){console.error("Match submission error:",x),P.error(x.message||"Fehler beim Hinzuf√ºgen des Spiels")}finally{c(!1)}},m=()=>{if(!a.date||a.goalsa===a.goalsb||a.goalsa===0&&a.goalsb===0||!a.manofthematch||a.manofthematch.trim()==="")return!1;if(a.goalsa>0){const l=a.goalslista.reduce((v,E)=>v+E.count,0),x=a.ownGoalsB||0;if(l+x<a.goalsa)return!1}if(a.goalsb>0){const l=a.goalslistb.reduce((v,E)=>v+E.count,0),x=a.ownGoalsA||0;if(l+x<a.goalsb)return!1}return!0},S=()=>{const l=[];if(a.date||l.push("Datum fehlt"),a.goalsa===0&&a.goalsb===0&&l.push("Mindestens ein Tor erforderlich"),a.goalsa===a.goalsb&&(a.goalsa>0||a.goalsb>0)&&l.push("Unentschieden nicht erlaubt"),(!a.manofthematch||a.manofthematch.trim()==="")&&l.push("Spieler des Spiels fehlt"),a.goalsa>0){const x=a.goalslista.reduce((E,j)=>E+j.count,0),v=a.ownGoalsB||0;x+v<a.goalsa&&l.push(`AEK Torsch√ºtzen fehlen (${x+v}/${a.goalsa})`)}if(a.goalsb>0){const x=a.goalslistb.reduce((E,j)=>E+j.count,0),v=a.ownGoalsA||0;x+v<a.goalsb&&l.push(`Real Torsch√ºtzen fehlen (${x+v}/${a.goalsb})`)}return{isValid:l.length===0,issues:l}},f=(l,x)=>{const v=Math.max(0,(a[l]||0)+x);o({[l]:v})},g=l=>n?n.filter(x=>x.team===l):[],k=()=>n?a.motmTeamFilter==="all"?n:n.filter(l=>l.team===a.motmTeamFilter):[],b=(l,x)=>{const v=l==="AEK"?"goalslista":"goalslistb";o({[v]:a[v].map(E=>E.player===x?{...E,count:E.count+1}:E).concat(a[v].find(E=>E.player===x)?[]:[{player:x,count:1}])})},A=(l,x)=>{const v=l==="AEK"?"goalslista":"goalslistb";o({[v]:a[v].map(E=>E.player===x?{...E,count:Math.max(0,E.count-1)}:E).filter(E=>E.count>0)})},C=(l,x)=>{const v=l==="AEK"?"ownGoalsA":"ownGoalsB",E=Math.max(0,a[v]+x);o({[v]:E})},p=(l,x)=>{if(!x)return;const v=l==="AEK"?"goalslista":"goalslistb",E=a[v].find(j=>j.player===x);o(E?{[v]:a[v].map(j=>j.player===x?{...j,count:j.count+1}:j)}:{[v]:[...a[v],{player:x,count:1}]})},w=(l,x)=>{const v=l==="AEK"?"goalslista":"goalslistb";o({[v]:a[v].filter(E=>E.player!==x)})};return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neues Spiel hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"F√ºgen Sie ein neues Spiel zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"‚öΩ"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Spiel hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um ein neues Spiel zu erfassen."}),e.jsxs("button",{onClick:()=>s(!0),className:"btn-primary inline-flex items-center px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neues Spiel erfassen"]})]})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center z-[60] p-2 sm:p-4 overflow-y-auto",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg w-full max-w-lg modal-content match-modal-content modal-mobile-safe my-4 sm:my-8",style:{maxHeight:"calc(100vh - 2rem)"},children:e.jsxs("div",{className:"p-4 sm:p-6 overflow-y-auto mobile-safe-bottom",style:{maxHeight:"calc(100vh - 4rem)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 sticky top-0 bg-bg-secondary z-10 pb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neues Spiel"}),e.jsx("button",{onClick:()=>s(!1),className:"text-text-secondary hover:text-text-primary text-2xl font-bold bg-bg-tertiary hover:bg-bg-hover rounded-full w-8 h-8 flex items-center justify-center transition-colors",disabled:i,children:"√ó"})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"‚öΩ Spielpaarung"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("div",{className:"bg-blue-100 text-blue-800 px-4 py-2 rounded-lg font-medium",children:"AEK Athen"}),e.jsx("div",{className:"text-gray-500 font-bold text-xl",children:"vs"}),e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded-lg font-medium",children:"Real Madrid"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:a.date,onChange:l=>h("date",l.target.value),className:"form-input",required:!0,disabled:i})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"‚öΩ Live Torwertung"}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-red-50 rounded-xl p-6 mb-4 text-center border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"text-4xl font-bold text-gray-800 mb-2",children:[e.jsx("span",{className:"text-blue-600",children:a.goalsa}),e.jsx("span",{className:"mx-4 text-gray-400",children:":"}),e.jsx("span",{className:"text-red-600",children:a.goalsb})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:[e.jsx("span",{className:"font-medium text-blue-700",children:"AEK Athen"}),e.jsx("span",{className:"mx-2",children:"vs"}),e.jsx("span",{className:"font-medium text-red-700",children:"Real Madrid"})]}),(a.goalsa>0||a.goalsb>0)&&e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:a.goalsa>a.goalsb?"üèÜ AEK f√ºhrt":a.goalsb>a.goalsa?"üèÜ Real f√ºhrt":"‚öñÔ∏è Unentschieden"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-blue-600 mb-3",children:"‚öΩ AEK Athen Torsch√ºtzen"})}),e.jsx("div",{className:"space-y-2",children:a.goalslista.map((l,x)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:l.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[l.count," Tor",l.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>A("AEK",l.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:l.count}),e.jsx("button",{type:"button",onClick:()=>b("AEK",l.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"}),e.jsx("button",{type:"button",onClick:()=>w("AEK",l.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:i,title:"Torsch√ºtze entfernen",children:"‚úï"})]})]},`aek-${l.player}-${x}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:l=>{l.target.value&&(p("AEK",l.target.value),l.target.value="")},className:"w-full form-input bg-blue-100 border-blue-300 text-blue-800",disabled:i,children:[e.jsx("option",{value:"",children:"+ Torsch√ºtze hinzuf√ºgen"}),g("AEK").map(l=>e.jsxs("option",{value:l.name,children:[l.name," (",l.position,")"]},l.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Z√§hlen f√ºr Real Madrid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>C("AEK",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i||a.ownGoalsA===0,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:a.ownGoalsA}),e.jsx("button",{type:"button",onClick:()=>C("AEK",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-red-600 mb-3",children:"‚öΩ Real Madrid Torsch√ºtzen"})}),e.jsx("div",{className:"space-y-2",children:a.goalslistb.map((l,x)=>e.jsxs("div",{className:"flex items-center justify-between bg-red-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:l.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[l.count," Tor",l.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>A("Real",l.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:l.count}),e.jsx("button",{type:"button",onClick:()=>b("Real",l.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"}),e.jsx("button",{type:"button",onClick:()=>w("Real",l.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:i,title:"Torsch√ºtze entfernen",children:"‚úï"})]})]},`real-${l.player}-${x}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:l=>{l.target.value&&(p("Real",l.target.value),l.target.value="")},className:"w-full form-input bg-red-100 border-red-300 text-red-800",disabled:i,children:[e.jsx("option",{value:"",children:"+ Torsch√ºtze hinzuf√ºgen"}),g("Real").map(l=>e.jsxs("option",{value:l.name,children:[l.name," (",l.position,")"]},l.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Z√§hlen f√ºr AEK Athen"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>C("Real",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i||a.ownGoalsB===0,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:a.ownGoalsB}),e.jsx("button",{type:"button",onClick:()=>C("Real",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"üü®üü• Karten"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"AEK Athen"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü® Gelbe Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-yellow-50 border border-yellow-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>f("yellowa",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i||a.yellowa<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:a.yellowa}),e.jsx("button",{type:"button",onClick:()=>f("yellowa",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü• Rote Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-red-50 border border-red-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>f("reda",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i||a.reda<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:a.reda}),e.jsx("button",{type:"button",onClick:()=>f("reda",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Real Madrid"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü® Gelbe Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-yellow-50 border border-yellow-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>f("yellowb",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i||a.yellowb<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:a.yellowb}),e.jsx("button",{type:"button",onClick:()=>f("yellowb",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü• Rote Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-red-50 border border-red-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>f("redb",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i||a.redb<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:a.redb}),e.jsx("button",{type:"button",onClick:()=>f("redb",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:i,children:"+"})]})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"‚≠ê Spieler des Spiels"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-text-muted mb-2",children:"Team Filter:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>h("motmTeamFilter","all"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${a.motmTeamFilter==="all"?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:i,children:"Alle"}),e.jsx("button",{type:"button",onClick:()=>h("motmTeamFilter","AEK"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${a.motmTeamFilter==="AEK"?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:i,children:"AEK"}),e.jsx("button",{type:"button",onClick:()=>h("motmTeamFilter","Real"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${a.motmTeamFilter==="Real"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,disabled:i,children:"Real"})]})]}),e.jsxs("select",{value:a.manofthematch,onChange:l=>h("manofthematch",l.target.value),className:"form-input",disabled:i,children:[e.jsx("option",{value:"",children:"Keinen Spieler ausw√§hlen"}),k().map(l=>e.jsxs("option",{value:l.name,children:[l.name," (",l.team," - ",l.position,")"]},l.id))]}),!n||n.length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler verf√ºgbar. Bitte f√ºgen Sie erst Spieler hinzu."})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"üí∞ Preisgelder (automatisch berechnet)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld AEK (‚Ç¨)"}),e.jsx("input",{type:"number",value:a.prizeaek,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld Real (‚Ç¨)"}),e.jsx("input",{type:"number",value:a.prizereal,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]})]}),e.jsx("p",{className:"text-xs text-text-muted mt-2",children:"Basierend auf Ergebnis und Karten: Gewinner 1M‚Ç¨ - (Verlierer-Tore √ó 50k‚Ç¨) - (Karten √ó 20k‚Ç¨/50k‚Ç¨)"})]}),a.goalsa===a.goalsb&&(a.goalsa>0||a.goalsb>0)&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 mr-2",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-red-800",children:"Unentschieden nicht erlaubt"}),e.jsx("p",{className:"text-sm text-red-700",children:"Ein Team muss gewinnen. Unentschieden sind in dieser App nicht m√∂glich."})]})]})}),!a.manofthematch&&(a.goalsa>0||a.goalsb>0)&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-yellow-600 mr-2",children:"‚≠ê"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-yellow-800",children:"Spieler des Spiels erforderlich"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Bitte w√§hlen Sie einen Spieler des Spiels aus, bevor Sie das Match speichern."})]})]})}),m()&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-green-800 mb-3 flex items-center",children:[e.jsx("i",{className:"fas fa-check-circle mr-2"}),"Spiel-Zusammenfassung"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Datum:"}),e.jsx("span",{className:"font-medium text-green-800",children:new Date(a.date).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Ergebnis:"}),e.jsxs("span",{className:"font-medium text-green-800",children:["AEK ",a.goalsa," : ",a.goalsb," Real"]})]}),a.manofthematch&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Spieler des Spiels:"}),e.jsx("span",{className:"font-medium text-green-800",children:a.manofthematch})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Preisgelder:"}),e.jsxs("span",{className:"font-medium text-green-800",children:["AEK ",a.prizeaek.toLocaleString(),"‚Ç¨, Real ",a.prizereal.toLocaleString(),"‚Ç¨"]})]})]})]}),!m()&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-2 mt-1",children:"‚ö†Ô∏è"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-red-800 mb-1",children:"Formular unvollst√§ndig"}),e.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:S().issues.map((l,x)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:"‚Ä¢"}),e.jsx("span",{children:l})]},x))})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4 pb-20 sm:pb-4",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:i,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:i||!m(),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${m()?"bg-green-600 hover:bg-green-700 text-white":"bg-red-500 text-white cursor-not-allowed opacity-75"} ${i?"opacity-50 cursor-not-allowed":""}`,children:i?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):m()?"‚úÖ Spiel speichern":`‚ùå ${S().issues[0]||"Eingaben unvollst√§ndig"}`})]})]})]})})})]})}const Z=[{value:"AEK",label:"AEK Athen",color:"blue",icon:"aek"},{value:"Real",label:"Real Madrid",color:"red",icon:"real"},{value:"Ehemalige",label:"Ehemalige",color:"gray",icon:"‚ö´"}],ne=(n,t=null)=>{try{return Ue(n,t).label}catch(s){console.error("Error getting team display:",s);const a=Z.find(r=>r.value===n);return a?a.label:n}};function at(){const{data:n}=q("players","*"),[t,s]=y.useState(!1),[a,r]=y.useState(""),[i,c]=y.useState({player_id:"",type:"",reason:"",customDuration:1}),[u,o]=y.useState(!1),h=(g,k)=>{c(b=>({...b,[g]:k})),g==="team"&&c(b=>({...b,player_id:""}))},d=()=>!n||!a?[]:n.filter(g=>g.team===a),m=async g=>{var k;g.preventDefault(),o(!0);try{const b=n==null?void 0:n.find(x=>x.id===parseInt(i.player_id)),A=ce.find(x=>x.value===i.type);if(!b)throw new Error("Spieler nicht gefunden");if(!A)throw new Error("Sperrart nicht gefunden");const p=(k=(await I.select("bans","*",{eq:{player_id:b.id}})).data)==null?void 0:k.find(x=>(x.matchesserved||0)<(x.totalgames||0));if(p)throw new Error(`Spieler "${b.name}" ist bereits gesperrt (${p.totalgames-p.matchesserved} Spiele verbleibend)`);const w=A.fixedDuration?A.duration:i.customDuration,l=await I.insert("bans",{player_id:b.id,team:b.team,type:A.value,totalgames:w,matchesserved:0,reason:i.reason||A.value});if(l.error)throw new Error(`Ban insert failed: ${l.error.message}`);c({player_id:"",type:"",reason:"",customDuration:1}),r(""),s(!1),P.success(`Sperre f√ºr "${b.name}" erfolgreich hinzugef√ºgt!`)}catch(b){console.error("Ban submission error:",b),P.error(b.message||"Fehler beim Hinzuf√ºgen der Sperre")}finally{o(!1)}},S=a&&i.player_id&&i.type,f=ce.find(g=>g.value===i.type);return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Sperre hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erstellen Sie eine neue Spielersperre in der Datenbank."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üö´"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Sperre hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Spielersperre zu erfassen."}),e.jsxs("button",{onClick:()=>s(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre erfassen"]})]})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Sperre"}),e.jsx("button",{onClick:()=>s(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:u,children:"√ó"})]}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:a,onChange:g=>{r(g.target.value),c(k=>({...k,player_id:""}))},className:"form-input",required:!0,disabled:u,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),Z.filter(g=>g.value!=="Ehemalige").map(g=>e.jsx("option",{value:g.value,children:ne(g.value)},g.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spieler *"}),e.jsxs("select",{value:i.player_id,onChange:g=>h("player_id",g.target.value),className:"form-input",required:!0,disabled:u||!a,children:[e.jsx("option",{value:"",children:a?"Spieler w√§hlen":"Bitte zuerst Team w√§hlen"}),d().map(g=>e.jsxs("option",{value:g.id,children:[g.name," (",g.position,")"]},g.id))]}),a&&d().length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler im gew√§hlten Team verf√ºgbar."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Sperrart *"}),e.jsxs("select",{value:i.type,onChange:g=>h("type",g.target.value),className:"form-input",required:!0,disabled:u,children:[e.jsx("option",{value:"",children:"Sperrart w√§hlen"}),ce.map(g=>e.jsxs("option",{value:g.value,children:[g.icon," ",g.label,g.fixedDuration?` (${g.duration} Spiel${g.duration!==1?"e":""})`:` (1-${g.maxDuration} Spiele)`]},g.value))]})]}),f&&!f.fixedDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Spiele *"}),e.jsx("select",{value:i.customDuration,onChange:g=>h("customDuration",parseInt(g.target.value)),className:"form-input",required:!0,disabled:u,children:Array.from({length:f.maxDuration},(g,k)=>k+1).map(g=>e.jsxs("option",{value:g,children:[g," Spiel",g!==1?"e":""]},g))}),e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["W√§hlen Sie zwischen ",f.minDuration," und ",f.maxDuration," Spielen"]})]}),f&&f.fixedDuration&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Gelb-Rote Karten haben immer eine feste Sperre von 1 Spiel."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zus√§tzlicher Grund (optional)"}),e.jsx("input",{type:"text",value:i.reason,onChange:g=>h("reason",g.target.value),className:"form-input",placeholder:"Weitere Details zur Sperre...",disabled:u})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:u,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!S||u||!n||n.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:u?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Sperrarten"}),e.jsx("div",{className:"space-y-2",children:ce.map(g=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:g.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:g.label})]}),e.jsx("span",{className:"text-sm text-text-muted",children:g.fixedDuration?`${g.duration} Spiel${g.duration!==1?"e":""} (fest)`:`1-${g.maxDuration} Spiele (variabel)`})]},g.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-yellow-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie die Sperre in der Sperren-√úbersicht einsehen und verwalten."})]})]})})]})}const Ne=[{value:"TH",label:"Torwart (TH)"},{value:"IV",label:"Innenverteidiger (IV)"},{value:"AV",label:"Au√üenverteidiger (AV)"},{value:"ZM",label:"Zentrales Mittelfeld (ZM)"},{value:"OM",label:"Offensives Mittelfeld (OM)"},{value:"ST",label:"St√ºrmer (ST)"}];function rt(){const[n,t]=y.useState(!1),[s,a]=y.useState({name:"",team:"",position:"",goals:0,value:0}),[r,i]=y.useState(!1),c=(h,d)=>{a(m=>({...m,[h]:d}))},u=async h=>{h.preventDefault(),i(!0);try{const d=await I.select("players","*",{eq:{name:s.name.trim(),team:s.team.trim()}});if(d.data&&d.data.length>0)throw new Error(`Spieler "${s.name}" existiert bereits im Team "${s.team}"`);const m=await I.insert("players",{name:s.name.trim(),team:s.team.trim(),position:s.position.trim().toUpperCase(),goals:parseInt(s.goals)||0,value:parseFloat(s.value)||0});if(m.error)throw new Error(`Player insert failed: ${m.error.message}`);a({name:"",team:"",position:"",goals:0,value:0}),t(!1),P.success(`Spieler "${s.name}" erfolgreich hinzugef√ºgt!`)}catch(d){console.error("Player submission error:",d),P.error(d.message||"Fehler beim Hinzuf√ºgen des Spielers")}finally{i(!1)}},o=s.name&&s.team&&s.position&&s.value!=="";return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neuen Spieler hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"F√ºgen Sie einen neuen Spieler zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üë§"}),e.jsxs("h4",{className:"text-lg font-medium text-text-primary mb-2",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Spieler hinzuf√ºgen"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um einen neuen Spieler zu erfassen."}),e.jsxs("button",{onClick:()=>t(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neuen Spieler erfassen"]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neuer Spieler"}),e.jsx("button",{onClick:()=>t(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:r,children:"√ó"})]}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spielername *"}),e.jsx("input",{type:"text",value:s.name,onChange:h=>c("name",h.target.value),className:"form-input",placeholder:"z.B. Max Mustermann",required:!0,disabled:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s.team,onChange:h=>c("team",h.target.value),className:"form-input",required:!0,disabled:r,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),Z.map(h=>e.jsx("option",{value:h.value,children:ne(h.value)},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position *"}),e.jsxs("select",{value:s.position,onChange:h=>c("position",h.target.value),className:"form-input",required:!0,disabled:r,children:[e.jsx("option",{value:"",children:"Position w√§hlen"}),Ne.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Marktwert (Millionen ‚Ç¨) *"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:s.value,onChange:h=>c("value",h.target.value),onFocus:h=>h.target.select(),className:"form-input",placeholder:"0.0",disabled:r}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Marktwert in Millionen Euro (z.B. 1.5 f√ºr 1.5M ‚Ç¨)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Tore"}),e.jsx("input",{type:"number",min:"0",value:s.goals,onChange:h=>c("goals",h.target.value),onFocus:h=>h.target.select(),className:"form-input",placeholder:"0",disabled:r})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>t(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:r,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!o||r,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Teams"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:Z.map(h=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${h.color==="blue"?"text-blue-600":h.color==="red"?"text-red-600":"text-gray-600"}`,children:ne(h.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",h.value,")"]})]},h.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Positionen"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Ne.map(h=>e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:e.jsx("span",{className:"font-medium text-text-primary text-sm",children:h.label})},h.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-green-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie den Spieler in der Kader-√úbersicht einsehen und verwalten."})]})]})})]})}const Se=[{value:"Preisgeld",label:"Preisgeld",icon:"üèÜ"},{value:"Strafe",label:"Strafe",icon:"üìâ"},{value:"Spielerkauf",label:"Spielerkauf",icon:"üë§"},{value:"Spielerverkauf",label:"Spielerverkauf",icon:"üí∞"},{value:"Echtgeld-Ausgleich",label:"Echtgeld-Ausgleich",icon:"üí≥"},{value:"SdS Bonus",label:"Spieler des Spiels Bonus",icon:"‚≠ê"},{value:"Sonstiges",label:"Sonstiges",icon:"üìà"}];function nt(){const[n,t]=y.useState(!1),[s,a]=y.useState({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),[r,i]=y.useState(!1),c=(d,m)=>{a(S=>({...S,[d]:m}))},u=async d=>{d.preventDefault(),i(!0);try{const m=parseFloat(s.amount),S=await I.insert("transactions",{date:s.date,type:s.type.trim(),team:s.team.trim(),amount:m,info:s.info.trim(),match_id:null});if(S.error)throw new Error(`Transaction insert failed: ${S.error.message}`);await o(s.team.trim(),s.type.trim(),m),a({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),t(!1),P.success("Transaktion erfolgreich hinzugef√ºgt!")}catch(m){console.error("Transaction submission error:",m),P.error(m.message||"Fehler beim Hinzuf√ºgen der Transaktion")}finally{i(!1)}},o=async(d,m,S)=>{try{const f=await I.select("finances","*",{eq:{team:d}});let g=f.data&&f.data.length>0?f.data[0]:{team:d,balance:0,debt:0},k={};if(m==="Echtgeld-Ausgleich")k.debt=(g.debt||0)+S;else{let b=(g.balance||0)+S;b<0&&(b=0),k.balance=b}g.id?await I.update("finances",k,g.id):await I.insert("finances",{team:d,balance:k.balance||0,debt:k.debt||0})}catch(f){console.warn("Failed to update finances:",f)}},h=s.team&&s.type&&s.amount&&s.date;return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Transaktion hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erfassen Sie eine neue finanzielle Transaktion."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üí∞"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Transaktion hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Transaktion zu erfassen."}),e.jsxs("button",{onClick:()=>t(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Transaktion erfassen"]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Transaktion"}),e.jsx("button",{onClick:()=>t(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:r,children:"√ó"})]}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:s.team,onChange:d=>c("team",d.target.value),className:"form-input",required:!0,disabled:r,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),Z.filter(d=>d.value!=="Ehemalige").map(d=>e.jsx("option",{value:d.value,children:ne(d.value)},d.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Transaktionsart *"}),e.jsxs("select",{value:s.type,onChange:d=>c("type",d.target.value),className:"form-input",required:!0,disabled:r,children:[e.jsx("option",{value:"",children:"Typ w√§hlen"}),Se.map(d=>e.jsxs("option",{value:d.value,children:[d.icon," ",d.label]},d.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Betrag (‚Ç¨) *"}),e.jsx("input",{type:"number",step:"0.01",value:s.amount,onChange:d=>c("amount",d.target.value),onFocus:d=>d.target.select(),className:"form-input",placeholder:"0.00",required:!0,disabled:r}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Negative Werte f√ºr Ausgaben, positive f√ºr Einnahmen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Beschreibung"}),e.jsx("input",{type:"text",value:s.info,onChange:d=>c("info",d.target.value),className:"form-input",placeholder:"Zus√§tzliche Informationen...",disabled:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:s.date,onChange:d=>c("date",d.target.value),className:"form-input",required:!0,disabled:r})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>t(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:r,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!h||r,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Transaktionsarten"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Se.map(d=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:d.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:d.label})]},d.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Teams"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Z.filter(d=>d.value!=="Ehemalige").map(d=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${d.color==="blue"?"text-blue-600":"text-red-600"}`,children:ne(d.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",d.value,")"]})]},d.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie die Transaktion in der Finanzen-√úbersicht einsehen."})]})]})})]})}function it(){var je;const[n,t]=y.useState("players"),[s,a]=y.useState(!1),[r,i]=y.useState(""),[c,u]=y.useState(new Set),{data:o,refetch:h}=q("players","*",{order:{column:"id",ascending:!1}}),{data:d,refetch:m}=q("matches","*",{order:{column:"date",ascending:!1}}),{data:S,refetch:f}=q("bans","*",{order:{column:"id",ascending:!1}}),{data:g,refetch:k}=q("transactions","*",{order:{column:"date",ascending:!1}}),{remove:b}=pe("players"),{remove:A}=pe("bans"),{remove:C}=pe("transactions"),p=[{id:"players",label:"Spieler l√∂schen",icon:"fas fa-users"},{id:"matches",label:"Spiele l√∂schen (Einzel & Bulk)",icon:"fas fa-futbol"},{id:"bans",label:"Sperren l√∂schen",icon:"fas fa-ban"},{id:"transactions",label:"Transaktionen l√∂schen",icon:"fas fa-euro-sign"}],w=N=>{t(N),i(""),u(new Set)},l=(N,M)=>{const F=new Set(c);M?F.add(N):F.delete(N),u(F)},x=N=>{const M=Q(N);c.size===M.length?u(new Set):u(new Set(M.map(F=>F.id)))},v=async()=>{if(c.size===0){P.error("Keine Spiele ausgew√§hlt");return}const M=((d==null?void 0:d.filter(B=>c.has(B.id)))||[]).reduce((B,X)=>B+((g==null?void 0:g.filter(xe=>xe.match_id===X.id).length)||0),0);let F=`Sind Sie sicher, dass Sie ${c.size} ausgew√§hlte Spiele l√∂schen m√∂chten?`;if(M>0&&(F+=`

Achtung: ${M} zugeh√∂rige Transaktion(en) werden ebenfalls gel√∂scht.`),F+=`

Dieser Vorgang kann nicht r√ºckg√§ngig gemacht werden!`,!confirm(F))return;a(!0);let D=0,z=0;try{for(const B of c)try{console.log(`Deleting match ${B}`),await fe(B),D++}catch(X){console.error(`Failed to delete match ${B}:`,X),z++}u(new Set),D>0&&z===0?P.success(`Alle ${D} Spiele erfolgreich gel√∂scht`):D>0&&z>0?P.success(`${D} Spiele gel√∂scht, ${z} fehlgeschlagen`):P.error(`Alle ${z} L√∂schvorg√§nge fehlgeschlagen`),m(),k(),setTimeout(()=>{m(),k()},1e3)}catch(B){console.error("Bulk delete error:",B),P.error("Fehler beim Bulk-L√∂schen: "+B.message),u(new Set)}finally{a(!1)}},E=()=>{switch(n){case"players":return{total:(o==null?void 0:o.length)||0,filtered:O(o).length};case"matches":return{total:(d==null?void 0:d.length)||0,filtered:Q(d).length};case"bans":return{total:(S==null?void 0:S.length)||0,filtered:te(S).length};case"transactions":return{total:(g==null?void 0:g.length)||0,filtered:se(g).length};default:return{total:0,filtered:0}}},j=async N=>{const M=(S==null?void 0:S.filter(D=>D.player_id===N.id||D.player_name===N.name))||[];let F=`Sind Sie sicher, dass Sie ${N.name} (${N.team}) l√∂schen m√∂chten?`;if(M.length>0&&(F+=`

Achtung: ${M.length} zugeh√∂rige Sperre(n) werden ebenfalls gel√∂scht.`),N.goals&&N.goals>0&&(F+=`
Der Spieler hat ${N.goals} Tor(e) erzielt.`),!!confirm(F)){a(!0);try{await b(N.id),P.success(`Spieler ${N.name} erfolgreich gel√∂scht`),h(),M.length>0&&f()}catch(D){P.error("Fehler beim L√∂schen des Spielers: "+D.message)}finally{a(!1)}}},$=async N=>{const M=(g==null?void 0:g.filter(z=>z.match_id===N.id))||[],F=`AEK ${N.goalsa||0} - ${N.goalsb||0} Real`;let D=`Sind Sie sicher, dass Sie das Spiel vom ${new Date(N.date).toLocaleDateString("de-DE")} (${F}) l√∂schen m√∂chten?`;if(M.length>0&&(D+=`

Achtung: ${M.length} zugeh√∂rige Transaktion(en) werden ebenfalls gel√∂scht.`),N.manofthematch&&(D+=`
Spieler des Spiels: ${N.manofthematch}`),!!confirm(D)){a(!0);try{console.log(`Attempting to delete match ${N.id}`),await fe(N.id),console.log(`Successfully deleted match ${N.id}`),P.success("Spiel erfolgreich gel√∂scht"),m(),k(),setTimeout(()=>{m(),k()},1e3)}catch(z){console.error("Error deleting match:",z);let B="Fehler beim L√∂schen des Spiels: ";z.message.includes("not found")?B+=`Spiel mit ID ${N.id} wurde nicht in der Datenbank gefunden. M√∂glicherweise wurde es bereits gel√∂scht.`:z.message.includes("Invalid match ID")?B+=`Ung√ºltige Spiel-ID: ${N.id}`:z.message.includes("fetch failed")||z.message.includes("network")?B+="Netzwerkfehler. Bitte √ºberpr√ºfen Sie Ihre Internetverbindung.":B+=z.message,P.error(B)}finally{a(!1)}}},_=async N=>{var z;const M=N.player_name||(N.player_id&&o?(z=o.find(B=>B.id===N.player_id))==null?void 0:z.name:"Unbekannter Spieler"),F=Math.max(0,(N.totalgames||0)-(N.matchesserved||0));let D=`Sind Sie sicher, dass Sie die Sperre f√ºr ${M} l√∂schen m√∂chten?`;if(D+=`
Sperrtyp: ${N.type}`,F>0?D+=`
Noch ${F} Spiel(e) verbleibend`:D+=`
Sperre bereits abgesessen`,N.reason&&(D+=`
Grund: ${N.reason}`),!!confirm(D)){a(!0);try{await A(N.id),P.success(`Sperre f√ºr ${M} erfolgreich gel√∂scht`),f()}catch(B){P.error("Fehler beim L√∂schen der Sperre: "+B.message)}finally{a(!1)}}},T=async N=>{const M=N.match_id&&d?d.find(D=>D.id===N.match_id):null;let F=`Sind Sie sicher, dass Sie die Transaktion "${N.type}" l√∂schen m√∂chten?`;if(F+=`
Betrag: ${N.amount>0?"+":""}${N.amount}M ‚Ç¨ (${N.team})`,N.date&&(F+=`
Datum: ${new Date(N.date).toLocaleDateString("de-DE")}`),N.info&&(F+=`
Info: ${N.info}`),M&&(F+=`
Zugeh√∂riges Spiel: ${new Date(M.date).toLocaleDateString("de-DE")} (AEK ${M.goalsa||0} - ${M.goalsb||0} Real)`),!!confirm(F)){a(!0);try{await C(N.id),P.success("Transaktion erfolgreich gel√∂scht"),k()}catch(D){P.error("Fehler beim L√∂schen der Transaktion: "+D.message)}finally{a(!1)}}},R=N=>{const M=Z.find(F=>F.value===N);return M?M.icon:"‚ö´"},O=N=>r?(N||[]).filter(M=>{var F,D,z;return((F=M.name)==null?void 0:F.toLowerCase().includes(r.toLowerCase()))||((D=M.team)==null?void 0:D.toLowerCase().includes(r.toLowerCase()))||((z=M.position)==null?void 0:z.toLowerCase().includes(r.toLowerCase()))}):N||[],Q=N=>r?(N||[]).filter(M=>{var F;return new Date(M.date).toLocaleDateString("de-DE").includes(r)||((F=M.manofthematch)==null?void 0:F.toLowerCase().includes(r.toLowerCase()))}):N||[],te=N=>r?(N||[]).filter(M=>{var D,z,B,X;const F=M.player_name||(M.player_id&&o?(D=o.find(xe=>xe.id===M.player_id))==null?void 0:D.name:"");return(F==null?void 0:F.toLowerCase().includes(r.toLowerCase()))||((z=M.type)==null?void 0:z.toLowerCase().includes(r.toLowerCase()))||((B=M.team)==null?void 0:B.toLowerCase().includes(r.toLowerCase()))||((X=M.reason)==null?void 0:X.toLowerCase().includes(r.toLowerCase()))}):N||[],se=N=>r?(N||[]).filter(M=>{var F,D,z,B;return((F=M.type)==null?void 0:F.toLowerCase().includes(r.toLowerCase()))||((D=M.team)==null?void 0:D.toLowerCase().includes(r.toLowerCase()))||((z=M.info)==null?void 0:z.toLowerCase().includes(r.toLowerCase()))||((B=M.amount)==null?void 0:B.toString().includes(r))}):N||[],ae=()=>{const N=O(o);return!N||N.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:r?"Keine Spieler gefunden":"Keine Spieler vorhanden"}):e.jsx("div",{className:"space-y-2",children:N.map(M=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:R(M.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:M.name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[M.team," ‚Ä¢ ",M.position,M.goals!==void 0&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ ",M.goals," Tore"]})]})]})]}),e.jsxs("button",{onClick:()=>j(M),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},M.id))})},Y=()=>{const N=Q(d);if(!N||N.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:r?"Keine Spiele gefunden":"Keine Spiele vorhanden"});const M=N.length>0&&N.every(D=>c.has(D.id)),F=c.size>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-secondary rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M,onChange:()=>x(d),className:"w-4 h-4 text-accent-primary focus:ring-accent-primary border-gray-300 rounded"}),e.jsxs("span",{className:"text-sm text-text-primary",children:[M?"Alle abw√§hlen":"Alle ausw√§hlen"," (",N.length,")"]})]}),c.size>0&&e.jsxs("span",{className:"text-sm text-accent-primary font-medium",children:[c.size," ausgew√§hlt"]})]}),F&&e.jsxs("button",{onClick:v,disabled:s,className:"btn-primary btn-sm bg-red-600 hover:bg-red-700 text-white disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),c.size," Spiele l√∂schen"]})]}),e.jsx("div",{className:"space-y-2",children:N.map(D=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("label",{className:"flex items-center cursor-pointer",children:e.jsx("input",{type:"checkbox",checked:c.has(D.id),onChange:z=>l(D.id,z.target.checked),className:"w-4 h-4 text-accent-primary focus:ring-accent-primary border-gray-300 rounded"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-text-primary",children:["ID ",D.id," ‚Ä¢ ",new Date(D.date).toLocaleDateString("de-DE")]}),e.jsxs("p",{className:"text-sm text-text-muted",children:["AEK ",D.goalsa||0," - ",D.goalsb||0," Real"]}),D.manofthematch&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:[e.jsx("i",{className:"fas fa-star mr-1"}),"SdS: ",D.manofthematch]})]}),e.jsxs("button",{onClick:()=>$(D),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Einzeln l√∂schen"]})]})})]},D.id))})]})},ie=()=>{const N=te(S);if(!N||N.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:r?"Keine Sperren gefunden":"Keine Sperren vorhanden"});const M=D=>{if(D.player_name)return D.player_name;if(D.player_id&&o){const z=o.find(B=>B.id===D.player_id);return z?z.name:"Unbekannter Spieler"}return"Unbekannter Spieler"},F=D=>{const z=(D.totalgames||0)-(D.matchesserved||0);return Math.max(0,z)};return e.jsx("div",{className:"space-y-2",children:N.map(D=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:R(D.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:M(D)}),e.jsxs("p",{className:"text-sm text-text-muted",children:[D.type," ‚Ä¢ ",D.totalgames||0," Spiele",F(D)>0?` (${F(D)} verbleibend)`:" (abgesessen)"]}),D.reason&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Grund: ",D.reason]})]})]}),e.jsxs("button",{onClick:()=>_(D),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},D.id))})},le=()=>{const N=se(g);if(!N||N.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:r?"Keine Transaktionen gefunden":"Keine Transaktionen vorhanden"});const M=F=>{if(!F.match_id||!d)return null;const D=d.find(z=>z.id===F.match_id);return D?`Match: ${new Date(D.date).toLocaleDateString("de-DE")} (AEK ${D.goalsa||0} - ${D.goalsb||0} Real)`:null};return e.jsx("div",{className:"space-y-2",children:N.map(F=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:R(F.team)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:F.type}),e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsxs("span",{className:F.amount>0?"text-green-600":"text-red-600",children:[F.amount>0?"+":"",F.amount,"M ‚Ç¨"]}),F.date&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ ",new Date(F.date).toLocaleDateString("de-DE")]})]}),F.info&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:F.info}),M(F)&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[e.jsx("i",{className:"fas fa-futbol mr-1"}),M(F)]})]})]}),e.jsxs("button",{onClick:()=>T(F),disabled:s,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},F.id))})},oe=()=>{switch(n){case"players":return ae();case"matches":return Y();case"bans":return ie();case"transactions":return le();default:return ae()}};return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Daten l√∂schen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Verwalten Sie die L√∂schung von Spielern, Spielen, Sperren und Transaktionen."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-6",children:p.map(N=>e.jsxs("button",{onClick:()=>w(N.id),className:`p-3 rounded-lg text-sm font-medium transition-colors ${n===N.id?"bg-accent-red text-white":"bg-bg-tertiary text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${N.icon} mr-2`}),N.label]},N.id))}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:`${(je=p.find(N=>N.id===n))==null?void 0:je.label.replace(" l√∂schen","")} durchsuchen...`,value:r,onChange:N=>i(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent-red focus:border-transparent text-text-primary bg-bg-secondary"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"fas fa-search text-text-muted"})}),r&&e.jsx("button",{onClick:()=>i(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-text-muted hover:text-text-primary",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[r&&e.jsxs("p",{className:"text-xs text-text-muted",children:[e.jsx("i",{className:"fas fa-filter mr-1"}),"Gefiltert nach: ‚Äú",r,"‚Äù"]}),e.jsx("p",{className:"text-xs text-text-muted ml-auto",children:(()=>{const N=E();return r?`${N.filtered} von ${N.total} Eintr√§gen`:`${N.total} Eintr√§ge`})()})]})]}),e.jsxs("div",{className:"modern-card",children:[s&&e.jsx(De,{message:"L√∂sche..."}),!s&&oe()]}),e.jsx("div",{className:"mt-6 modern-card bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-3",children:e.jsx("i",{className:"fas fa-exclamation-triangle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Achtung"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Das L√∂schen von Daten ist permanent und kann nicht r√ºckg√§ngig gemacht werden. Bitte √ºberpr√ºfen Sie Ihre Auswahl sorgf√§ltig, bevor Sie fortfahren."})]})]})})]})}function lt({data:n=[],searchFields:t=[],filterOptions:s=[],onResults:a,placeholder:r="Suchen...",showCount:i=!0,searchExtractor:c}){const[u,o]=y.useState(""),[h,d]=y.useState({}),[m,S]=y.useState(""),[f,g]=y.useState("asc"),k=y.useRef(null),b=y.useMemo(()=>{let l=[...n];if(u.trim()){const x=u.toLowerCase().trim();l=l.filter(v=>{if(c){const E=c(v);return E&&E.toLowerCase().includes(x)}return t.some(E=>{const j=me(v,E);return j&&j.toString().toLowerCase().includes(x)})})}return Object.entries(h).forEach(([x,v])=>{if(v&&v!=="all"){const E=s.find(j=>j.key===x);E&&E.filterFn?l=l.filter(j=>E.filterFn(j,v)):l=l.filter(j=>me(j,x)===v)}}),m&&l.sort((x,v)=>{const E=me(x,m),j=me(v,m);let $=0;return typeof E=="number"&&typeof j=="number"?$=E-j:E instanceof Date&&j instanceof Date?$=E.getTime()-j.getTime():$=String(E).localeCompare(String(j)),f==="desc"?-$:$}),l},[n,u,h,m,f,t,s,c]);y.useEffect(()=>{a&&JSON.stringify(b)!==k.current&&(k.current=JSON.stringify(b),a(b))},[b,a]);const A=(l,x)=>{d(v=>({...v,[l]:x}))},C=l=>{m===l?g(f==="asc"?"desc":"asc"):(S(l),g("asc"))},p=()=>{o(""),d({}),S(""),g("asc")},w=u||Object.values(h).some(l=>l&&l!=="all")||m;return e.jsxs("div",{className:"bg-bg-primary border border-border-light rounded-lg shadow-sm mb-4",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center",children:e.jsx("span",{className:"text-text-secondary","aria-hidden":"true",children:"üîç"})}),e.jsx("input",{type:"text",value:u,onChange:l=>o(l.target.value),placeholder:`${r} (Strg+K f√ºr globale Suche)`,className:"w-full pl-10 pr-20 py-2 bg-bg-secondary border border-border-light rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:ring-2 focus:ring-primary-green focus:border-transparent"}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center gap-1 pr-3",children:[e.jsx("button",{onClick:()=>{const l=new CustomEvent("global-search-toggle");window.dispatchEvent(l)},className:"text-text-secondary hover:text-primary-green transition-colors p-1 rounded",title:"Globale Suche √∂ffnen (Strg+K)",children:e.jsx("span",{"aria-hidden":"true",children:"üåê"})}),u&&e.jsx("button",{onClick:()=>o(""),className:"text-text-secondary hover:text-text-primary transition-colors p-1 rounded",title:"Suchfeld leeren",children:e.jsx("span",{"aria-hidden":"true",children:"‚úï"})})]})]})}),(s.length>0||m)&&e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[s.map(l=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-sm font-medium text-text-primary",children:[l.label,":"]}),e.jsxs("select",{value:h[l.key]||"",onChange:x=>A(l.key,x.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Alle"}),l.options.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))]})]},l.key)),t.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sortieren:"}),e.jsxs("select",{value:m,onChange:l=>S(l.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Standard"}),t.map(l=>e.jsx("option",{value:l,children:ke(l)},l))]}),m&&e.jsx("button",{onClick:()=>C(m),className:"px-2 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary hover:bg-bg-tertiary transition-colors duration-200",title:`Sortierung: ${f==="asc"?"Aufsteigend":"Absteigend"}`,children:f==="asc"?"‚Üë":"‚Üì"})]}),w&&e.jsx("button",{onClick:p,className:"px-3 py-1 bg-red-100 text-red-800 border border-red-200 rounded text-sm hover:bg-red-200 transition-colors duration-200",children:"Filter zur√ºcksetzen"})]})}),i&&e.jsx("div",{className:"px-4 py-2 bg-bg-secondary border-b border-border-light",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:b.length===n.length?`${n.length} Eintr√§ge`:`${b.length} von ${n.length} Eintr√§gen`}),w&&e.jsxs("div",{className:"flex items-center gap-2",children:[u&&e.jsxs("span",{className:"bg-primary-green bg-opacity-10 text-primary-green px-2 py-1 rounded text-xs",children:['üîç "',u,'"']}),Object.entries(h).filter(([,l])=>l&&l!=="all").map(([l,x])=>{const v=s.find(j=>j.key===l),E=v==null?void 0:v.options.find(j=>j.value===x);return e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:[v==null?void 0:v.label,": ",(E==null?void 0:E.label)||x]},l)}),m&&e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs",children:["üìä ",ke(m)," ",f==="asc"?"‚Üë":"‚Üì"]})]})]})})]})}function me(n,t){return!n||!t?"":t.split(".").reduce((s,a)=>s&&s[a]!==void 0?s[a]:"",n)}function ke(n){return{name:"Name",team:"Team",position:"Position",value:"Wert",date:"Datum",goalsa:"AEK Tore",goalsb:"Real Tore",type:"Typ",amount:"Betrag",description:"Beschreibung",totalgames:"Gesamt Spiele",matchesserved:"Gespielte Spiele"}[n]||n.charAt(0).toUpperCase()+n.slice(1)}function Ce({onNavigate:n}){const[t,s]=y.useState("players"),[a,r]=y.useState([]),{data:i,loading:c}=q("players","*"),{data:u,loading:o}=q("matches","*",{order:{column:"date",ascending:!1}}),{data:h,loading:d}=q("transactions","*",{order:{column:"date",ascending:!1}}),{data:m,loading:S}=q("bans","*",{order:{column:"id",ascending:!1}}),f=c||o||d||S,g=[{id:"players",label:"Spieler",icon:"fas fa-users",data:i||[],searchFields:["name","position","team","value"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"},{value:"Ehemalige",label:"Ehemalige"}]},{key:"position",label:"Position",options:[{value:"TH",label:"Torwart"},{value:"IV",label:"Innenverteidiger"},{value:"LV",label:"Linksverteidiger"},{value:"RV",label:"Rechtsverteidiger"},{value:"ZDM",label:"Defensives Mittelfeld"},{value:"ZM",label:"Zentrales Mittelfeld"},{value:"ZOM",label:"Offensives Mittelfeld"},{value:"LM",label:"Linkes Mittelfeld"},{value:"RM",label:"Rechtes Mittelfeld"},{value:"LF",label:"Linker Fl√ºgel"},{value:"RF",label:"Rechter Fl√ºgel"},{value:"ST",label:"St√ºrmer"}]}]},{id:"matches",label:"Spiele",icon:"fas fa-futbol",data:u||[],searchFields:["date","goalsa","goalsb","goalscorers","manofthematch","teama","teamb"],filterOptions:[],searchExtractor:C=>{const p=[];if(C.date&&p.push(new Date(C.date).toLocaleDateString("de-DE")),C.teama&&p.push(C.teama),C.teamb&&p.push(C.teamb),C.goalsa!==void 0&&p.push(C.goalsa.toString()),C.goalsb!==void 0&&p.push(C.goalsb.toString()),C.goalslista)try{const w=typeof C.goalslista=="string"?JSON.parse(C.goalslista):C.goalslista;Array.isArray(w)&&w.forEach(l=>{typeof l=="string"?p.push(l):l&&l.player&&p.push(l.player)})}catch{}if(C.goalslistb)try{const w=typeof C.goalslistb=="string"?JSON.parse(C.goalslistb):C.goalslistb;Array.isArray(w)&&w.forEach(l=>{typeof l=="string"?p.push(l):l&&l.player&&p.push(l.player)})}catch{}return C.manofthematch&&(p.push(C.manofthematch),p.push("Spieler des Spiels"),p.push("SdS")),p.join(" ").toLowerCase()}},{id:"transactions",label:"Transaktionen",icon:"fas fa-euro-sign",data:h||[],searchFields:["type","description","amount","date"],filterOptions:[{key:"type",label:"Typ",options:[{value:"transfer",label:"Transfer"},{value:"preis",label:"Preisgeld"},{value:"strafe",label:"Strafe"},{value:"sonstige",label:"Sonstige"}],filterFn:(C,p)=>{var x,v;const w=((x=C.type)==null?void 0:x.toLowerCase())||"",l=((v=C.description)==null?void 0:v.toLowerCase())||"";switch(p){case"transfer":return w.includes("transfer")||l.includes("transfer");case"preis":return w.includes("preis")||l.includes("preis")||C.amount>0;case"strafe":return w.includes("strafe")||l.includes("strafe");case"sonstige":return!w.includes("transfer")&&!w.includes("preis")&&!w.includes("strafe");default:return!0}}}]},{id:"bans",label:"Sperren",icon:"fas fa-ban",data:m||[],searchFields:["player_name","team","type","reason"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"}]},{key:"type",label:"Typ",options:[{value:"Gelbe Karte",label:"Gelbe Karte"},{value:"Gelb-Rote Karte",label:"Gelb-Rote Karte"},{value:"Rote Karte",label:"Rote Karte"},{value:"Verletzung",label:"Verletzung"}]}]}],k=g.find(C=>C.id===t),b=(C,p)=>{switch(p){case"players":n==null||n("squad");break;case"matches":n==null||n("matches");break;case"transactions":n==null||n("finances");break;case"bans":n==null||n("bans");break}},A=()=>{const C=a.length>0?a:k.data;return C.length===0?e.jsxs("div",{className:"p-6 text-center text-text-secondary",children:[e.jsx("i",{className:`${k.icon} text-4xl mb-2`}),e.jsxs("p",{children:["Keine ",k.label.toLowerCase()," gefunden"]})]}):e.jsx("div",{className:"divide-y divide-border-light",children:C.map(p=>e.jsxs("button",{onClick:()=>b(p,t),className:"w-full p-4 hover:bg-bg-secondary transition-colors text-left focus:outline-none focus:ring-2 focus:ring-primary-green focus:ring-inset",children:[t==="players"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:p.name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[p.position," ‚Ä¢ ",p.team," ‚Ä¢ ",p.value||0,"M ‚Ç¨"]}),(p.goals||0)>0&&e.jsxs("p",{className:"text-xs text-primary-green",children:["‚öΩ ",p.goals||0," Tore"]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[p.value||0,"M ‚Ç¨"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zum Spieler ‚Üí"})]})]}),t==="matches"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:new Date(p.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[p.teama||"AEK"," ",p.goalsa||0," - ",p.goalsb||0," ",p.teamb||"Real"]}),(()=>{const w=[];try{if(p.goalslista){const l=typeof p.goalslista=="string"?JSON.parse(p.goalslista):p.goalslista;Array.isArray(l)&&l.forEach(x=>{const v=typeof x=="string"?x:x==null?void 0:x.player;v&&w.push(`${v} (AEK)`)})}if(p.goalslistb){const l=typeof p.goalslistb=="string"?JSON.parse(p.goalslistb):p.goalslistb;Array.isArray(l)&&l.forEach(x=>{const v=typeof x=="string"?x:x==null?void 0:x.player;v&&w.push(`${v} (Real)`)})}}catch{}return w.length>0?e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["‚öΩ ",w.slice(0,3).join(", "),w.length>3?"...":""]}):null})(),p.manofthematch&&e.jsxs("p",{className:"text-xs text-yellow-600 mt-1",children:["‚≠ê SdS: ",p.manofthematch]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[(p.goalsa||0)+(p.goalsb||0)," Tore"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zum Spiel ‚Üí"})]})]}),t==="transactions"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:p.type||"Transaktion"}),e.jsx("p",{className:"text-sm text-text-secondary",children:p.description||"Keine Beschreibung"}),e.jsx("p",{className:"text-xs text-text-secondary",children:new Date(p.date).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:`text-lg font-bold ${(p.amount||0)>=0?"text-green-600":"text-red-600"}`,children:[(p.amount||0)>0?"+":"",p.amount||0,"‚Ç¨"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zu Finanzen ‚Üí"})]})]}),t==="bans"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:p.player_name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[p.team," ‚Ä¢ ",p.type]}),p.reason&&e.jsx("p",{className:"text-xs text-text-secondary",children:p.reason})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-sm text-accent-red",children:[p.duration||1," Spiel",(p.duration||1)!==1?"e":""]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zu Sperren ‚Üí"})]})]})]},p.id))})};return f?e.jsx(De,{message:"Lade Daten..."}):e.jsxs("div",{className:"p-4 pb-20 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:"üîç Globale Suche"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Durchsuche alle Daten zentral an einem Ort"})]}),e.jsx("div",{className:"icon-only-nav flex overflow-x-auto space-x-2 pb-2",children:g.map(C=>e.jsxs("button",{onClick:()=>{s(C.id),r([])},className:`search-nav-button flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${t===C.id?"bg-primary-green text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary"}`,title:C.label,"aria-label":C.label,children:[e.jsx("i",{className:C.icon}),e.jsx("span",{className:"font-medium hidden sm:inline",children:C.label}),e.jsxs("span",{className:"text-xs opacity-75",children:["(",C.data.length,")"]})]},C.id))}),e.jsx(lt,{data:k.data,searchFields:k.searchFields,filterOptions:k.filterOptions,searchExtractor:k.searchExtractor,onResults:r,placeholder:`${k.label} durchsuchen...`}),e.jsxs("div",{className:"modern-card",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("h4",{className:"font-medium text-text-primary",children:[a.length>0?"Suchergebnisse":`Alle ${k.label}`,e.jsxs("span",{className:"text-text-secondary ml-2",children:["(",a.length>0?a.length:k.data.length,")"]})]})}),A()]})]})}function ot(){const{theme:n,autoMode:t,toggleTheme:s,setAutoTheme:a,setManualTheme:r}=Re();return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üé®"}),"Design & Darstellung"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Darstellungsmodus"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>a(!0),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${t?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"üåó"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Automatisch"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Folgt den Systemeinstellungen"})]}),e.jsxs("button",{onClick:()=>r("light"),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${!t&&n==="light"?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"‚òÄÔ∏è"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Hell"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Helle Darstellung"})]}),e.jsxs("button",{onClick:()=>r("dark"),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${!t&&n==="dark"?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"üåô"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Dunkel"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Dunkle Darstellung"})]})]})]}),e.jsx("div",{className:"bg-bg-tertiary rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Aktueller Modus"}),e.jsx("div",{className:"text-xs text-text-muted",children:t?`Automatisch (${n==="dark"?"Dunkel":"Hell"} - basierend auf Systemeinstellung)`:`Manuell (${n==="dark"?"Dunkel":"Hell"})`})]}),e.jsx("div",{className:"text-2xl",children:n==="dark"?"üåô":"‚òÄÔ∏è"})]})}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Schnellwechsel"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Wechselt zwischen Hell und Dunkel"})]}),e.jsxs("button",{onClick:s,className:"bg-primary-green hover:bg-primary-green-dark text-white px-4 py-2 rounded-lg transition-all duration-300 flex items-center space-x-2",children:[e.jsx("span",{children:n==="dark"?"‚òÄÔ∏è":"üåô"}),e.jsxs("span",{className:"text-sm font-medium",children:["Zu ",n==="dark"?"Hell":"Dunkel"]})]})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üí°"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Darstellungshinweise"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Automatisch:"})," Wechselt automatisch basierend auf Ihren Systemeinstellungen"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Hell:"})," Optimiert f√ºr helle Umgebungen und bessere Akkulaufzeit"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Dunkel:"})," Reduziert Augenbelastung bei schwachem Licht"]}),e.jsx("p",{children:"‚Ä¢ Alle Karten, Modals und UI-Elemente passen sich automatisch an"})]})]})]})})]})})}function ct(){const[n,t]=y.useState({primaryGreen:"#10B981",primaryGreenDark:"#059669",primaryGreenLight:"#34D399",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#3B82F6"}),[s]=y.useState([{name:"Standard",colors:{primaryGreen:"#10B981",primaryGreenDark:"#059669",primaryGreenLight:"#34D399",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#3B82F6"}},{name:"AEK Blau",colors:{primaryGreen:"#1E40AF",primaryGreenDark:"#1E3A8A",primaryGreenLight:"#3B82F6",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#60A5FA"}},{name:"Real Rot",colors:{primaryGreen:"#DC2626",primaryGreenDark:"#B91C1C",primaryGreenLight:"#EF4444",accentOrange:"#F59E0B",accentRed:"#F87171",accentBlue:"#3B82F6"}},{name:"Dunkles Gold",colors:{primaryGreen:"#D97706",primaryGreenDark:"#B45309",primaryGreenLight:"#F59E0B",accentOrange:"#FBBF24",accentRed:"#EF4444",accentBlue:"#3B82F6"}}]),[a,r]=y.useState(!1),[i,c]=y.useState("Standard");y.useEffect(()=>{const f=localStorage.getItem("fifa-tracker-custom-colors");if(f)try{const g=JSON.parse(f);t(g),u(g)}catch(g){console.error("Error loading custom colors:",g)}},[]);const u=f=>{const g=document.documentElement;g.style.setProperty("--primary-green",f.primaryGreen),g.style.setProperty("--primary-green-dark",f.primaryGreenDark),g.style.setProperty("--primary-green-light",f.primaryGreenLight),g.style.setProperty("--accent-orange",f.accentOrange),g.style.setProperty("--accent-red",f.accentRed),g.style.setProperty("--accent-blue",f.accentBlue)},o=(f,g)=>{const k={...n,[f]:g};t(k),r(!0),c("Benutzerdefiniert"),u(k)},h=f=>{t(f.colors),c(f.name),r(!0),u(f.colors)},d=()=>{localStorage.setItem("fifa-tracker-custom-colors",JSON.stringify(n)),r(!1);const f=new CustomEvent("show-toast",{detail:{message:"Farbschema gespeichert!",type:"success"}});window.dispatchEvent(f)},m=()=>{const f=s[0].colors;t(f),c("Standard"),r(!0),u(f)},S=({label:f,colorKey:g,value:k,description:b})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:f}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"color",value:k,onChange:A=>o(g,A.target.value),className:"w-12 h-12 rounded-lg border-2 border-border-medium cursor-pointer appearance-none",style:{background:k}}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 rounded-lg border-2 border-white pointer-events-none shadow-sm"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"text",value:k,onChange:A=>o(g,A.target.value),className:"w-full px-3 py-2 text-sm border border-border-medium rounded-lg bg-bg-secondary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green/50",placeholder:"#000000"}),b&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:b})]})]})]});return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üé®"}),"Farbkonfiguration"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-3",children:"Vorgefertigte Farbschemata"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:s.map(f=>e.jsxs("button",{onClick:()=>h(f),className:`p-3 rounded-lg border-2 transition-all duration-300 ${i===f.name?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:f.colors.primaryGreen}}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:f.colors.accentRed}}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:f.colors.accentBlue}})]}),e.jsx("div",{className:"text-xs font-medium text-text-primary",children:f.name})]},f.name))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-text-primary",children:"Individuelle Farbanpassung"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(S,{label:"Prim√§rfarbe",colorKey:"primaryGreen",value:n.primaryGreen,description:"Hauptfarbe f√ºr Buttons und Akzente"}),e.jsx(S,{label:"Prim√§rfarbe (Dunkel)",colorKey:"primaryGreenDark",value:n.primaryGreenDark,description:"Dunklere Variante f√ºr Hover-Effekte"}),e.jsx(S,{label:"Prim√§rfarbe (Hell)",colorKey:"primaryGreenLight",value:n.primaryGreenLight,description:"Hellere Variante f√ºr Highlights"}),e.jsx(S,{label:"Akzentfarbe Orange",colorKey:"accentOrange",value:n.accentOrange,description:"Orange Akzente und Warnungen"}),e.jsx(S,{label:"Akzentfarbe Rot",colorKey:"accentRed",value:n.accentRed,description:"Rote Akzente und Fehler"}),e.jsx(S,{label:"Akzentfarbe Blau",colorKey:"accentBlue",value:n.accentBlue,description:"Blaue Akzente und Informationen"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-border-light",children:[e.jsx("button",{onClick:d,disabled:!a,className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-300 ${a?"bg-primary-green hover:bg-primary-green-dark text-white":"bg-border-medium text-text-muted cursor-not-allowed"}`,children:a?"Farben speichern":"Keine √Ñnderungen"}),e.jsx("button",{onClick:m,className:"py-3 px-4 bg-bg-tertiary hover:bg-border-light text-text-primary border border-border-medium rounded-lg font-medium transition-all duration-300",children:"Zur√ºcksetzen"})]}),e.jsxs("div",{className:"mt-8 p-6 bg-gradient-to-r from-gray-50 to-blue-50 rounded-2xl border border-gray-200",children:[e.jsxs("h5",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-eye text-blue-500"}),"Live-Vorschau"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("button",{className:"btn-primary text-sm py-3 px-4 rounded-xl font-medium transition-all duration-200 hover:shadow-lg transform hover:scale-105",style:{backgroundColor:n.primaryGreen,borderColor:n.primaryGreen},children:"Prim√§r Button"}),e.jsx("div",{className:"px-4 py-3 rounded-xl text-white text-sm font-medium shadow-md",style:{backgroundColor:n.accentRed},children:"Rot Akzent"}),e.jsx("div",{className:"px-4 py-3 rounded-xl text-white text-sm font-medium shadow-md",style:{backgroundColor:n.accentBlue},children:"Blau Akzent"}),e.jsx("div",{className:"px-4 py-3 rounded-xl text-white text-sm font-medium shadow-md",style:{backgroundColor:n.accentOrange},children:"Orange Akzent"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üí°"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Farbhinweise"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsx("p",{children:"‚Ä¢ √Ñnderungen werden sofort in der Vorschau angezeigt"}),e.jsx("p",{children:"‚Ä¢ Gespeicherte Farben werden automatisch bei der n√§chsten Anmeldung geladen"}),e.jsx("p",{children:"‚Ä¢ Verwenden Sie Hex-Codes (#RRGGBB) f√ºr pr√§zise Farben"}),e.jsx("p",{children:"‚Ä¢ Team-spezifische Presets helfen bei der schnellen Anpassung"})]})]})]})})]})})}class dt{constructor(){this.isSupported="serviceWorker"in navigator&&"PushManager"in window,this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent),this.permission=Notification.permission,this.subscription=null,this.settings=this.loadSettings()}async initialize(){if(!this.isSupported)return console.warn("Push notifications not supported"),!1;try{if("serviceWorker"in navigator){const t=await navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered:",t)}return this.permission=Notification.permission,!0}catch(t){return console.error("Failed to initialize notifications:",t),!1}}async requestPermission(){if(!this.isSupported)throw new Error("Notifications not supported");if(this.permission==="granted")return!0;try{if(this.isIOS){const t=await Notification.requestPermission();return this.permission=t,t==="granted"}else{const t=await Notification.requestPermission();return this.permission=t,t==="granted"}}catch(t){return console.error("Permission request failed:",t),!1}}async subscribe(){if(!this.isSupported||this.permission!=="granted")throw new Error("Cannot subscribe: permission not granted");try{const t=await navigator.serviceWorker.ready,s=await t.pushManager.getSubscription();if(s)return this.subscription=s,s;const a=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.getVAPIDKey()});return this.subscription=a,await this.sendSubscriptionToServer(a),a}catch(t){throw console.error("Subscription failed:",t),t}}async unsubscribe(){if(!this.subscription)return!0;try{return await this.subscription.unsubscribe(),await this.removeSubscriptionFromServer(this.subscription),this.subscription=null,!0}catch(t){return console.error("Unsubscribe failed:",t),!1}}async scheduleMatchReminder(t,s=30){if(!this.settings.matchReminders)return;const a=new Date(t.date),r=new Date(a.getTime()-s*60*1e3),i=new Date;if(r<=i)return;const c=r.getTime()-i.getTime();setTimeout(()=>{this.showNotification({title:"‚öΩ FIFA Match Reminder",body:`Match starting in ${s} minutes: AEK vs Real Madrid`,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`match-reminder-${t.id}`,data:{type:"match_reminder",matchId:t.id,url:"/matches"},actions:[{action:"view",title:"View Match",icon:"/assets/icon-180.png"},{action:"dismiss",title:"Dismiss"}]})},c)}async notifyAchievement(t){this.settings.achievements&&await this.showNotification({title:"üèÜ Achievement Unlocked!",body:t.title,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`achievement-${t.id}`,data:{type:"achievement",achievementId:t.id,url:"/stats"}})}async notifyGoal(t,s,a){this.settings.goals&&await this.showNotification({title:"‚öΩ GOAL!",body:`${a} scored for ${s}!`,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`goal-${t.id}-${Date.now()}`,data:{type:"goal",matchId:t.id,url:"/matches"}})}async notifyEvent(t){this.settings.events&&await this.showNotification({title:`üéâ ${t.name}`,body:t.description,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`event-${t.id}`,data:{type:"event",eventId:t.id,url:"/events"}})}async showNotification(t){if(this.permission!=="granted"){console.warn("Cannot show notification: permission not granted");return}try{"serviceWorker"in navigator?await(await navigator.serviceWorker.ready).showNotification(t.title,{body:t.body,icon:t.icon,badge:t.badge,tag:t.tag,data:t.data,actions:t.actions||[],vibrate:this.isIOS?void 0:[200,100,200],requireInteraction:!1,silent:!1}):new Notification(t.title,{body:t.body,icon:t.icon,tag:t.tag,data:t.data})}catch(s){console.error("Failed to show notification:",s)}}updateSettings(t){this.settings={...this.settings,...t},localStorage.setItem("fifa-tracker-notification-settings",JSON.stringify(this.settings))}loadSettings(){const t=localStorage.getItem("fifa-tracker-notification-settings"),s={matchReminders:!0,goals:!0,achievements:!0,events:!0,reminderTime:30};return t?{...s,...JSON.parse(t)}:s}getVAPIDKey(){return"BEl62iUYgUivxIkv69yViEuiBIa40HI0DLLuxazjqak_7kYDjLE2cI5GkJM-5z9z9LzsQI7JClZgZmKjgKrRxfQ"}async sendSubscriptionToServer(t){try{console.log("Would send subscription to server:",t)}catch(s){console.error("Failed to send subscription to server:",s)}}async removeSubscriptionFromServer(t){try{console.log("Would remove subscription from server:",t)}catch(s){console.error("Failed to remove subscription from server:",s)}}async testNotification(){await this.showNotification({title:"üß™ Test Notification",body:"FUSTA notifications are working!",icon:"/assets/icon-180.png",tag:"test-notification"})}getStatus(){return{supported:this.isSupported,permission:this.permission,subscribed:!!this.subscription,isIOS:this.isIOS,settings:this.settings}}}const V=new dt;typeof window<"u"&&(window.NotificationService=V,V.initialize());function mt(){const[n,t]=y.useState(V.getStatus()),[s,a]=y.useState(V.settings),[r,i]=y.useState(!1);y.useEffect(()=>{t(V.getStatus()),a(V.settings)},[]);const c=async()=>{i(!0);try{await V.requestPermission()&&await V.subscribe(),t(V.getStatus())}catch(d){console.error("Permission request failed:",d);const m=new CustomEvent("show-toast",{detail:{message:"Benachrichtigungen konnten nicht aktiviert werden.",type:"error"}});window.dispatchEvent(m)}finally{i(!1)}},u=async()=>{i(!0);try{await V.unsubscribe(),t(V.getStatus())}catch(d){console.error("Unsubscribe failed:",d)}finally{i(!1)}},o=(d,m)=>{const S={...s,[d]:m};a(S),V.updateSettings(S)},h=async()=>{try{await V.testNotification();const d=new CustomEvent("show-toast",{detail:{message:"Test-Benachrichtigung gesendet!",type:"success"}});window.dispatchEvent(d)}catch(d){console.error("Test notification failed:",d)}};return n.supported?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üì±"}),"Push-Benachrichtigungen"]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Status"}),e.jsxs("div",{className:"text-xs text-text-muted",children:[n.permission==="granted"?"Benachrichtigungen aktiviert":n.permission==="denied"?"Benachrichtigungen blockiert":"Berechtigung ausstehend",n.isIOS&&" (iOS)"]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${n.permission==="granted"?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":n.permission==="denied"?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300"}`,children:n.permission==="granted"?"Aktiv":n.permission==="denied"?"Blockiert":"Ausstehend"})]})}),n.permission!=="granted"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:c,disabled:r||n.permission==="denied",className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-300 ${n.permission==="denied"?"bg-border-medium text-text-muted cursor-not-allowed":"bg-primary-green hover:bg-primary-green-dark text-white"}`,children:r?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Aktiviere..."]}):n.permission==="denied"?"In Browsereinstellungen aktivieren":"Benachrichtigungen aktivieren"}),n.permission==="denied"&&e.jsx("p",{className:"text-xs text-text-muted mt-2 text-center",children:"√ñffnen Sie die Browsereinstellungen und erlauben Sie Benachrichtigungen f√ºr diese Seite."})]}),n.permission==="granted"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-text-primary",children:"Benachrichtigungseinstellungen"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"‚öΩ Spiel-Erinnerungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Erinnerungen vor Spielbeginn"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.matchReminders,onChange:d=>o("matchReminders",d.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),s.matchReminders&&e.jsxs("div",{className:"ml-4 p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Erinnerungszeit (Minuten vor Spielbeginn)"}),e.jsxs("select",{value:s.reminderTime,onChange:d=>o("reminderTime",parseInt(d.target.value)),className:"w-full px-3 py-2 text-sm border border-border-medium rounded-lg bg-bg-secondary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green/50",children:[e.jsx("option",{value:5,children:"5 Minuten"}),e.jsx("option",{value:15,children:"15 Minuten"}),e.jsx("option",{value:30,children:"30 Minuten"}),e.jsx("option",{value:60,children:"1 Stunde"}),e.jsx("option",{value:120,children:"2 Stunden"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"‚öΩ Tor-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei Toren w√§hrend Live-Matches"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.goals,onChange:d=>o("goals",d.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"üèÜ Achievement-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei freigeschalteten Erfolgen"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.achievements,onChange:d=>o("achievements",d.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"üéâ Event-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei neuen Events und Turnieren"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.events,onChange:d=>o("events",d.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-border-light",children:[e.jsx("button",{onClick:h,className:"flex-1 py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all duration-300",children:"Test-Benachrichtigung"}),e.jsx("button",{onClick:u,disabled:r,className:"py-2 px-4 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-all duration-300 disabled:opacity-50",children:r?"Deaktiviere...":"Deaktivieren"})]})]}),n.isIOS&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üì±"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"iOS-Hinweis"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsx("p",{children:'‚Ä¢ Installieren Sie die App √ºber "Zum Home-Bildschirm hinzuf√ºgen" f√ºr beste Benachrichtigungen'}),e.jsx("p",{children:"‚Ä¢ Benachrichtigungen funktionieren nur bei aktiver App oder im Hintergrund"}),e.jsx("p",{children:"‚Ä¢ √úberpr√ºfen Sie die iOS-Einstellungen f√ºr App-Benachrichtigungen"})]})]})]})})]})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üì±"}),"Push-Benachrichtigungen"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-yellow-500 text-xl flex-shrink-0",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200 mb-1",children:"Nicht unterst√ºtzt"}),e.jsx("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:"Ihr Browser unterst√ºtzt keine Push-Benachrichtigungen. Verwenden Sie einen modernen Browser oder installieren Sie die App f√ºr Benachrichtigungen."})]})]})})]})})}function ht(){const[n,t]=y.useState({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}}),[s,a]=y.useState(!1),[r,i]=y.useState(!0);y.useEffect(()=>{c()},[]);const c=async()=>{try{i(!0),console.log("üîÑ [AdminTab] Loading managers from database...");const m=await H.getManagers();if(console.log("üìä [AdminTab] Manager data result:",m),m&&m.data&&Array.isArray(m.data)&&m.data.length>=2){console.log("‚úÖ [AdminTab] Manager data loaded successfully:",m.data);const S=m.data.find(g=>g.id===1)||{name:"Alexander",gewicht:110,age:30},f=m.data.find(g=>g.id===2)||{name:"Philip",gewicht:105,age:30};console.log("üë§ [AdminTab] AEK Manager:",S),console.log("üë§ [AdminTab] Real Manager:",f),t({aek:{name:S.name,age:S.age||30,weight:S.gewicht},real:{name:f.name,age:f.age||30,weight:f.gewicht}})}else console.warn("‚ö†Ô∏è [AdminTab] No manager data found, using defaults. Result:",m),await u()}catch(m){console.error("‚ùå [AdminTab] Error loading manager settings from database:",m),await u()}finally{i(!1)}},u=async()=>{try{console.log("üîß [AdminTab] Initializing default managers...");const m={name:"Alexander",gewicht:110,age:30},S=await H.insertManager(m);console.log("‚úÖ [AdminTab] AEK manager created:",S);const f={name:"Philip",gewicht:105,age:30},g=await H.insertManager(f);console.log("‚úÖ [AdminTab] Real manager created:",g),t({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}})}catch(m){console.error("‚ùå [AdminTab] Error initializing managers:",m),t({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}})}},o=(m,S,f)=>{t(g=>({...g,[m]:{...g[m],[S]:S==="name"?f:parseInt(f)||0}})),a(!0)},h=async()=>{try{i(!0),console.log("üíæ [TeamSettings] Saving manager settings:",n);const m={name:n.aek.name,gewicht:n.aek.weight,age:n.aek.age},S={name:n.real.name,gewicht:n.real.weight,age:n.real.age};console.log("üíæ [TeamSettings] AEK Data:",m),console.log("üíæ [TeamSettings] Real Data:",S);const f=await H.updateManager(1,m);console.log("üíæ [TeamSettings] AEK Update Result:",f);const g=await H.updateManager(2,S);console.log("üíæ [TeamSettings] Real Update Result:",g),a(!1),window.dispatchEvent(new CustomEvent("managerSettingsChanged")),P.success("Manager-Einstellungen erfolgreich gespeichert!",{duration:3e3,position:"top-center"})}catch(m){console.error("Error saving manager settings:",m),P.error(`Fehler beim Speichern: ${m.message||"Unbekannter Fehler"}`,{duration:5e3,position:"top-center"})}finally{i(!1)}},d=()=>{t({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}}),a(!0)};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx(ot,{}),e.jsx(ct,{}),e.jsx(mt,{}),r?e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-green"}),e.jsx("span",{className:"ml-2 text-text-muted",children:"Lade Manager-Einstellungen..."})]})}):e.jsxs("div",{className:"modern-card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"üèÜ Team-Manager Einstellungen"}),s&&e.jsx("span",{className:"text-sm text-orange-600 font-medium",children:"Ungespeicherte √Ñnderungen"})]}),e.jsx("div",{className:"text-sm text-text-muted mb-6",children:"Hier k√∂nnen Sie die Daten der Team-Manager f√ºr die BAK-Berechnung anpassen."}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4 p-4 border border-blue-200 rounded-lg bg-blue-50",children:[e.jsxs("h4",{className:"font-medium text-blue-800 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded mr-2"}),"AEK Manager"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.aek.name,onChange:m=>o("aek","name",m.target.value),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Manager Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Alter"}),e.jsx("input",{type:"number",min:"18",max:"80",value:n.aek.age,onChange:m=>o("aek","age",m.target.value),onFocus:m=>m.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gewicht (kg)"}),e.jsx("input",{type:"number",min:"40",max:"200",value:n.aek.weight,onChange:m=>o("aek","weight",m.target.value),onFocus:m=>m.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 border border-red-200 rounded-lg bg-red-50",children:[e.jsxs("h4",{className:"font-medium text-red-800 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-red-600 rounded mr-2"}),"Real Manager"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.real.name,onChange:m=>o("real","name",m.target.value),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Manager Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Alter"}),e.jsx("input",{type:"number",min:"18",max:"80",value:n.real.age,onChange:m=>o("real","age",m.target.value),onFocus:m=>m.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gewicht (kg)"}),e.jsx("input",{type:"number",min:"40",max:"200",value:n.real.weight,onChange:m=>o("real","weight",m.target.value),onFocus:m=>m.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-border-light",children:[e.jsx("button",{onClick:d,className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-200 transition-colors",children:"Standardwerte wiederherstellen"}),e.jsx("button",{onClick:h,disabled:!s||r,className:`px-4 py-2 text-sm rounded-lg transition-colors ${s&&!r?"bg-primary-green text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:r?"Speichern...":"Einstellungen speichern"})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Hinweis:"})," Diese Einstellungen werden f√ºr die BAK-Berechnung in der Statistik verwendet. Die Werte werden in der Datenbank gespeichert."]})})]})]})}function ut(){const[n,t]=y.useState(()=>{const h=localStorage.getItem("eventsTabEnabled");return h!==null?JSON.parse(h):!1}),[s,a]=y.useState({title:"",message:"",type:"general"}),[r,i]=y.useState(()=>{const h=localStorage.getItem("customEvents");return h?JSON.parse(h):[]}),c=h=>{t(h),localStorage.setItem("eventsTabEnabled",JSON.stringify(h)),setTimeout(()=>{window.location.reload()},500)},u=()=>{if(!s.title||!s.message){alert("Bitte Titel und Nachricht eingeben");return}J(s.type,{title:s.title,message:s.message,timestamp:new Date().toISOString(),custom:!0});const d=[{id:Date.now(),...s,timestamp:new Date().toISOString()},...r.slice(0,9)];i(d),localStorage.setItem("customEvents",JSON.stringify(d)),a({title:"",message:"",type:"general"}),alert("Benachrichtigung gesendet!")},o=[{value:"general",label:"üì¢ Allgemein",color:"bg-gray-500"},{value:"match-created",label:"‚öΩ Spiel erstellt",color:"bg-green-500"},{value:"player-ban",label:"üö´ Spieler gesperrt",color:"bg-red-500"},{value:"financial-milestone",label:"üí∞ Finanzmeilenstein",color:"bg-yellow-500"},{value:"achievement-unlocked",label:"üèÖ Achievement",color:"bg-purple-500"},{value:"system-update",label:"üîÑ System Update",color:"bg-blue-500"}];return e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üéâ"}),"Events Tab Konfiguration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-secondary rounded-lg border border-border-light",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:"Events Tab anzeigen"}),e.jsx("div",{className:"text-sm text-text-muted",children:"Zeigt den Events Tab in der Navigation an oder blendet ihn aus"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:h=>c(h.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Hinweis:"})," Der Events Tab ist standardm√§√üig ausgeblendet. Nach dem Aktivieren wird die Seite neu geladen um die Navigation zu aktualisieren."]})})]})]}),e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üöÄ"}),"Schnell-Tests f√ºr Push-Benachrichtigungen"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>J("match-result",{goalsa:3,goalsb:1,manofthematch:"Max M√ºller",date:new Date().toISOString()}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"‚öΩ"}),"Spielergebnis-Test"]}),e.jsxs("button",{onClick:()=>J("player-ban",{playerName:"Tom Schmidt",games:3}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üö´"}),"Spieler-Sperre"]}),e.jsxs("button",{onClick:()=>J("financial-milestone",{team:"AEK Athen",amount:250}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üí∞"}),"Finanzmeilenstein"]}),e.jsxs("button",{onClick:()=>J("achievement-unlocked",{name:"Torj√§ger",description:"10 Tore in einer Saison"}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üèÖ"}),"Achievement"]}),e.jsxs("button",{onClick:()=>J("system-update",{message:"Neue Funktionen verf√ºgbar!"}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üîÑ"}),"System-Update"]}),e.jsxs("button",{onClick:()=>{setTimeout(()=>J("match-created",{date:new Date().toISOString()}),0),setTimeout(()=>J("player-ban",{playerName:"Test Player",games:1}),300),setTimeout(()=>J("financial-milestone",{team:"Real Madrid",amount:100}),600)},className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üìö"}),"Mehrere Tests"]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Tipp:"})," Diese Buttons testen die neuen Push-Up Benachrichtigungen mit realistischen Daten und Animationen."]})})]}),e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üì¢"}),"Individuelle Push-Benachrichtigungen"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Nachrichtentyp"}),e.jsx("select",{value:s.type,onChange:h=>a(d=>({...d,type:h.target.value})),className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors",children:o.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Titel"}),e.jsx("input",{type:"text",value:s.title,onChange:h=>a(d=>({...d,title:h.target.value})),placeholder:"z.B. Neues Tournament startet",className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Nachricht"}),e.jsx("textarea",{value:s.message,onChange:h=>a(d=>({...d,message:h.target.value})),placeholder:"z.B. Das Weihnachts-Tournament beginnt morgen um 19:00 Uhr!",rows:3,className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors resize-none"})]}),e.jsxs("button",{onClick:u,disabled:!s.title||!s.message,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("i",{className:"fas fa-paper-plane mr-2"}),"Benachrichtigung senden"]})]})]}),r.length>0&&e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üìã"}),"Gesendete Benachrichtigungen"]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:r.map(h=>{var d;return e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg border border-border-light",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-text-primary text-sm flex items-center",children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${((d=o.find(m=>m.value===h.type))==null?void 0:d.color)||"bg-gray-500"}`}),h.title]}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:h.message}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:new Date(h.timestamp).toLocaleString("de-DE")})]})})},h.id)})}),r.length>=10&&e.jsx("div",{className:"text-xs text-text-muted mt-2 text-center",children:"Nur die letzten 10 Benachrichtigungen werden angezeigt"})]})]})}const gt=()=>{const[n,t]=y.useState(ee());return y.useEffect(()=>{const s=a=>{t(a.detail.newSeason)};return window.addEventListener("seasonChanged",s),()=>window.removeEventListener("seasonChanged",s)},[]),{currentSeason:n,isLegacy:n===he.LEGACY,isFC26:n===he.FC26}},Ae=()=>{const[n,t]=y.useState([]),[s,a]=y.useState(!1),{currentSeason:r}=gt();y.useEffect(()=>{const u=()=>{t(Le())};u();const o=()=>{setTimeout(u,100)};return window.addEventListener("seasonChanged",o),window.addEventListener("legacyDataMigrated",o),window.addEventListener("fc26EnvironmentInitialized",o),()=>{window.removeEventListener("seasonChanged",o),window.removeEventListener("legacyDataMigrated",o),window.removeEventListener("fc26EnvironmentInitialized",o)}},[]);const i=async u=>{try{a(!0);const o=Ve(u);if(o){const h=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),d=URL.createObjectURL(h),m=document.createElement("a");m.href=d,m.download=`fifa-tracker-${u}-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(d),console.log(`Exported ${u} data successfully`)}else console.error("Failed to export season data")}catch(o){console.error("Error exporting season data:",o)}finally{a(!1)}},c=u=>{const o=["matches","players","bans","transactions","alcoholCalculator"],h={};return o.forEach(d=>{try{const m=`fifa_season_${u}_${d}`,S=localStorage.getItem(m);if(S){const f=JSON.parse(S);Array.isArray(f)?h[d]=f.length:typeof f=="object"&&(h[d]=1)}else h[d]=0}catch{h[d]=0}}),h};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-6",children:[e.jsx("div",{className:`w-16 h-16 bg-gradient-to-br from-emerald-500 to-cyan-500 rounded-2xl \r
                        flex items-center justify-center text-white shadow-lg border border-emerald-300`,children:e.jsx("i",{className:"fas fa-calendar-alt text-2xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-1",children:"Saison-Manager"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Verwalten Sie Legacy- und FC26-Daten"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-emerald-50 via-teal-50 to-cyan-50 rounded-2xl p-6 border border-emerald-200 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-emerald-400 to-cyan-400 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("i",{className:"fas fa-calendar-check text-white text-xl"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:"Aktuelle Saison"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:Be[r]}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Alle Aktionen werden in dieser Saison gespeichert"})]})]}),e.jsx("div",{className:"text-6xl opacity-20",children:r===he.FC26?"‚ö°":"üìö"})]})}),e.jsx(_e,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Daten√ºbersicht pro Saison"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:n.map(u=>{const o=c(u.id),h=Object.values(o).reduce((d,m)=>d+m,0);return e.jsxs("div",{className:`p-6 rounded-xl border-2 ${u.isActive?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-xl",style:{backgroundColor:u.color+"20",color:u.color},children:u.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:u.name}),e.jsx("p",{className:"text-sm text-gray-600",children:u.description})]})]}),u.isActive&&e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:"Aktiv"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Gesamt Eintr√§ge:"}),e.jsx("span",{className:"font-medium text-gray-800",children:h})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"‚öΩ Spiele:"}),e.jsx("span",{className:"font-medium",children:o.matches||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üë• Spieler:"}),e.jsx("span",{className:"font-medium",children:o.players||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üö´ Sperren:"}),e.jsx("span",{className:"font-medium",children:o.bans||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üí∞ Transaktionen:"}),e.jsx("span",{className:"font-medium",children:o.transactions||0})]})]}),o.alcoholCalculator>0&&e.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t border-gray-200",children:[e.jsx("span",{className:"text-gray-600",children:"üç∫ Alkohol-Tracker:"}),e.jsx("span",{className:"font-medium text-green-600",children:"Konfiguriert"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>i(u.id),disabled:!u.hasData||s,className:`flex-1 px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 \r
                                 rounded-lg text-sm transition-colors disabled:opacity-50 \r
                                 disabled:cursor-not-allowed`,children:s?"Exportiert...":"üì• Export"}),u.hasData&&e.jsx("div",{className:"flex-1 px-3 py-2 text-center text-sm",children:e.jsx("span",{className:"text-green-600 font-medium",children:"‚úì Daten vorhanden"})})]})})]},u.id)})})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-600 text-2xl",children:"üí°"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-amber-800 mb-2",children:"FC26 Saison-System"}),e.jsxs("div",{className:"space-y-2 text-sm text-amber-700",children:[e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Legacy:"})," Alle bisherigen FIFA-Daten bleiben erhalten und zug√§nglich"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"FC26:"})," Neue Saison mit frischen Daten f√ºr FIFA Club 26"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Isolation:"})," Jede Saison hat separate Speicherbereiche"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Wechsel:"})," Beliebig zwischen Saisons wechseln m√∂glich"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Export:"})," Backup-Funktion f√ºr alle Saisondaten"]})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Technische Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Speicher-System:"}),e.jsx("br",{}),"‚Ä¢ Lokaler Browser-Speicher",e.jsx("br",{}),"‚Ä¢ Automatische Datenmigration",e.jsx("br",{}),"‚Ä¢ Versionsverwaltung"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Datentypen:"}),e.jsx("br",{}),"‚Ä¢ Spiele und Ergebnisse",e.jsx("br",{}),"‚Ä¢ Spieler und Teams",e.jsx("br",{}),"‚Ä¢ Finanzen und Statistiken"]})]})]})]})},xt=()=>{const[n,t]=y.useState([]),[s,a]=y.useState(""),[r,i]=y.useState(!1),[c,u]=y.useState({version:"",displayName:"",description:""}),[o,h]=y.useState(!1),d=()=>{const b=ue(),A=be(),C=b.sort((p,w)=>{if(!p.isCustom&&w.isCustom)return-1;if(p.isCustom&&!w.isCustom)return 1;if(!p.isCustom&&!w.isCustom)return p.id==="FC25"?-1:w.id==="FC25"?1:0;const l=new Date(p.createdAt||0);return new Date(w.createdAt||0)-l});t(C),a(A)};y.useEffect(()=>{d();const b=()=>{d()};return window.addEventListener("fifaVersionChanged",b),window.addEventListener("fifaVersionAdded",b),window.addEventListener("fifaVersionRemoved",b),()=>{window.removeEventListener("fifaVersionChanged",b),window.removeEventListener("fifaVersionAdded",b),window.removeEventListener("fifaVersionRemoved",b)}},[]);const m=async b=>{b.preventDefault(),h(!0);try{const{version:A,displayName:C,description:p}=c;if(!A.trim())throw new Error("Version identifier ist erforderlich");const w=A.trim().toUpperCase();if(!/^[A-Za-z]+\d*$/.test(w))throw new Error("Version Format ung√ºltig. Verwenden Sie Formate wie FC27, EA25, etc.");const l={displayName:C.trim()||w,description:p.trim()||`Custom FIFA Version ${w}`,createdAt:new Date().toISOString(),createdBy:"admin"};await Ke(w,l),u({version:"",displayName:"",description:""}),i(!1),P.success(`FIFA Version ${w} erfolgreich hinzugef√ºgt!`)}catch(A){P.error(A.message)}finally{h(!1)}},S=async b=>{if(window.confirm(`Sind Sie sicher, dass Sie Version "${b}" l√∂schen m√∂chten?`))try{await Ge(b),P.success(`Version ${b} erfolgreich entfernt!`)}catch(A){P.error(A.message)}},f=async b=>{try{Oe(b),P.success(`Zu Version ${re(b)} gewechselt!`),setTimeout(()=>{window.location.reload()},1e3)}catch(A){P.error(`Fehler beim Wechseln der Version: ${A.message}`)}},g=b=>b.isLegacy?"bg-gray-100 text-gray-700":b.isCurrent?"bg-blue-100 text-blue-700":b.isCustom?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700",k=b=>b.isLegacy?"Legacy":b.isCurrent?"Standard":b.isCustom?"Custom":"Standard";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-br from-purple-500 to-blue-600 rounded-xl \r
                          flex items-center justify-center text-white text-xl font-bold`,children:"üéÆ"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"FIFA Versionen-Manager"}),e.jsx("p",{className:"text-gray-600",children:"Verwalten und erstellen Sie FIFA Versionen f√ºr zukunftssichere Datenorganisation"})]})]}),e.jsxs("button",{onClick:()=>i(!r),className:`px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg \r
                     transition-colors flex items-center gap-2`,children:[e.jsx("span",{className:"text-lg",children:"+"}),"Neue Version"]})]}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl p-6 border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Aktuelle FIFA Version"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:s}),e.jsxs("p",{className:"text-lg text-gray-600",children:["(",re(s),")"]})]}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Alle neuen Daten werden in dieser Version gespeichert"})]}),e.jsx("div",{className:"text-4xl",children:"üéÆ"})]})}),r&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Neue FIFA Version hinzuf√ºgen"}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Version Identifier *"}),e.jsx("input",{type:"text",value:c.version,onChange:b=>u(A=>({...A,version:b.target.value})),placeholder:"z.B. FC27, EA25, FIFA28",className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 \r
                           focus:ring-purple-500 focus:border-purple-500`,required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Format: Buchstaben gefolgt von optionalen Zahlen (FC27, EA25, etc.)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anzeigename"}),e.jsx("input",{type:"text",value:c.displayName,onChange:b=>u(A=>({...A,displayName:b.target.value})),placeholder:"z.B. FIFA Club 27",className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 \r
                           focus:ring-purple-500 focus:border-purple-500`})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Beschreibung"}),e.jsx("textarea",{value:c.description,onChange:b=>u(A=>({...A,description:b.target.value})),placeholder:"Beschreibung der neuen Version...",rows:3,className:`w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 \r
                         focus:ring-purple-500 focus:border-purple-500`})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:o,className:`px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg \r
                         transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:o?"Wird hinzugef√ºgt...":"Version hinzuf√ºgen"}),e.jsx("button",{type:"button",onClick:()=>i(!1),className:`px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg \r
                         transition-colors`,children:"Abbrechen"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Verf√ºgbare FIFA Versionen"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:n.map(b=>{var A;return e.jsxs("div",{className:`p-6 rounded-xl border-2 ${b.isActive?"border-purple-500 bg-purple-50":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-xl font-bold text-gray-800",children:b.id}),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",b.name,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g(b)}`,children:k(b)}),b.isActive&&e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:"Aktiv"})]})]})}),e.jsx("div",{className:"text-2xl",children:b.isLegacy?"üìö":b.isCurrent?"‚ö°":"üéÆ"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:b.description||((A=b.metadata)==null?void 0:A.description)||"Keine Beschreibung verf√ºgbar"}),b.createdAt&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Erstellt: ",new Date(b.createdAt).toLocaleDateString("de-DE")]})]}),e.jsxs("div",{className:"flex gap-2",children:[!b.isActive&&e.jsx("button",{onClick:()=>f(b.id),className:`flex-1 px-3 py-2 bg-purple-100 hover:bg-purple-200 text-purple-700 \r
                             rounded-lg text-sm transition-colors`,children:"Aktivieren"}),b.isCustom&&e.jsx("button",{onClick:()=>S(b.id),disabled:b.isActive,className:`px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg \r
                             text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed`,children:"L√∂schen"}),b.isActive&&e.jsx("div",{className:"flex-1 px-3 py-2 text-center text-sm",children:e.jsx("span",{className:"text-green-600 font-medium",children:"‚úì Aktive Version"})})]})]},b.id)})})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-600 text-2xl",children:"üí°"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-amber-800 mb-2",children:"FIFA Versionen-System"}),e.jsxs("div",{className:"space-y-2 text-sm text-amber-700",children:[e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Built-in Versionen:"})," FC25 (Legacy) und FC26 (Standard) sind vorinstalliert"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Custom Versionen:"})," Erstellen Sie eigene Versionen f√ºr zuk√ºnftige FIFA-Editionen"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Datenisolation:"})," Jede Version hat separate Datenbanken"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Zukunftssicher:"})," System ist bereit f√ºr FC27, FC28 und weitere Versionen"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Flexibilit√§t:"})," Wechseln Sie beliebig zwischen Versionen"]})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Technische Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Version-Management:"}),e.jsx("br",{}),"‚Ä¢ Dynamisches Hinzuf√ºgen neuer Versionen",e.jsx("br",{}),"‚Ä¢ Automatische Datenbankfilterung",e.jsx("br",{}),"‚Ä¢ Metadaten-Unterst√ºtzung"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Datenformat:"}),e.jsx("br",{}),"‚Ä¢ Version Identifier (FC27, EA25, etc.)",e.jsx("br",{}),"‚Ä¢ Anzeigename und Beschreibung",e.jsx("br",{}),"‚Ä¢ Erstellungsdatum und Metadaten"]})]})]})]})},pt=()=>{const[n,t]=y.useState(""),[s,a]=y.useState([]),[r,i]=y.useState({}),[c,u]=y.useState(""),[o,h]=y.useState(!1),[d,m]=y.useState(!1),[S,f]=y.useState(!1),[g,k]=y.useState("");y.useEffect(()=>(()=>{b();const $=()=>{b()},_=()=>{c&&A(c)};return window.addEventListener("fifaVersionChanged",$),window.addEventListener("versionTeamsChanged",_),()=>{window.removeEventListener("fifaVersionChanged",$),window.removeEventListener("versionTeamsChanged",_)}})(),[c]);const b=()=>{const j=be(),$=ue();t(j),a($),c||(u(j),A(j))},A=j=>{const $=Ye(j);i($),m(!1)},C=j=>{d&&!window.confirm("Sie haben ungespeicherte √Ñnderungen. M√∂chten Sie trotzdem die Version wechseln?")||(u(j),A(j))},p=(j,$,_)=>{i(T=>({...T,[j]:{...T[j],[$]:_}})),m(!0)},w=async(j,$)=>{if($){if(!$.type.startsWith("image/")){P.error("Bitte w√§hlen Sie eine Bilddatei aus");return}if($.size>2*1024*1024){P.error("Bild zu gro√ü. Maximum 2MB erlaubt.");return}try{h(!0),await We(j,$,c)?(P.success("Icon erfolgreich hochgeladen"),A(c)):P.error("Fehler beim Hochladen des Icons")}catch(_){console.error("Error uploading icon:",_),P.error("Fehler beim Hochladen des Icons")}finally{h(!1)}}},l=async j=>{try{h(!0),await qe(j,c)?(P.success("Icon entfernt"),A(c)):P.error("Fehler beim Entfernen des Icons")}catch($){console.error("Error removing icon:",$),P.error("Fehler beim Entfernen des Icons")}finally{h(!1)}},x=async()=>{try{h(!0),Ze(r,c)?(P.success("Team-Einstellungen gespeichert"),m(!1)):P.error("Fehler beim Speichern")}catch(j){console.error("Error saving teams:",j),P.error("Fehler beim Speichern")}finally{h(!1)}},v=async()=>{if(!g){P.error("Bitte w√§hlen Sie eine Quell-Version aus");return}try{h(!0),Qe(g,c)?(P.success(`Team-Einstellungen von ${re(g)} kopiert`),A(c),f(!1),k("")):P.error("Fehler beim Kopieren")}catch(j){console.error("Error copying teams:",j),P.error("Fehler beim Kopieren")}finally{h(!1)}},E=async()=>{if(window.confirm("M√∂chten Sie die Team-Einstellungen f√ºr diese Version auf die Standardwerte zur√ºcksetzen?"))try{h(!0),He(c)?(P.success("Team-Einstellungen zur√ºckgesetzt"),A(c)):P.error("Fehler beim Zur√ºcksetzen")}catch($){console.error("Error resetting teams:",$),P.error("Fehler beim Zur√ºcksetzen")}finally{h(!1)}};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Versions-spezifische Team-Einstellungen"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Konfigurieren Sie Team-Namen und Icons f√ºr verschiedene FIFA Versionen"})]}),e.jsx("div",{className:"text-4xl",children:"‚öΩ"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Version ausw√§hlen"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:s.map(j=>e.jsxs("button",{onClick:()=>C(j.id),className:`p-4 rounded-lg border-2 transition-all ${c===j.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[e.jsx("div",{className:"text-sm font-semibold",children:j.id}),e.jsx("div",{className:"text-xs mt-1",children:j.name}),j.id===n&&e.jsx("div",{className:"text-xs text-green-600 font-medium mt-1",children:"Aktiv"})]},j.id))})]}),c&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-800",children:["Team-Konfiguration f√ºr ",re(c)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(!0),className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Kopieren von..."}),e.jsx("button",{onClick:E,className:"px-3 py-1 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Zur√ºcksetzen"})]})]}),e.jsx("div",{className:"space-y-6",children:Object.entries(r).map(([j,$])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg border-2 border-gray-200 flex items-center justify-center overflow-hidden",children:$.customIcon?e.jsx("img",{src:$.customIcon,alt:$.label,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-2xl",children:$.icon==="aek"?"üîµ":$.icon==="real"?"üî¥":$.icon})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-800",children:j}),e.jsx("p",{className:"text-sm text-gray-600",children:$.label})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Team-Name"}),e.jsx("input",{type:"text",value:$.label,onChange:_=>p(j,"label",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Team-Name eingeben"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Farbe"}),e.jsxs("select",{value:$.color,onChange:_=>p(j,"color",_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"blue",children:"Blau"}),e.jsx("option",{value:"red",children:"Rot"}),e.jsx("option",{value:"green",children:"Gr√ºn"}),e.jsx("option",{value:"yellow",children:"Gelb"}),e.jsx("option",{value:"purple",children:"Lila"}),e.jsx("option",{value:"orange",children:"Orange"}),e.jsx("option",{value:"gray",children:"Grau"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon hochladen"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:_=>w(j,_.target.files[0]),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),$.customIcon&&e.jsx("button",{onClick:()=>l(j),className:"px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Entfernen"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximale Dateigr√∂√üe: 2MB. Unterst√ºtzte Formate: JPG, PNG, GIF"})]})]})]},j))}),d&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsx("button",{onClick:x,disabled:o,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:o?"Speichern...":"√Ñnderungen speichern"})})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Team-Einstellungen kopieren"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Von welcher Version m√∂chten Sie die Team-Einstellungen kopieren?"}),e.jsxs("select",{value:g,onChange:j=>k(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg mb-4 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Version ausw√§hlen..."}),s.filter(j=>j.id!==c).map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{f(!1),k("")},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Abbrechen"}),e.jsx("button",{onClick:v,disabled:!g||o,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Kopieren"})]})]})})]})},ft=["alcoholCalculatorValues","fifa_matches","fifa_players","fifa_bans","fifa_transactions","fifa_finances"],bt=["matches","players","bans","transactions","finances","alcoholCalculator"],Me=()=>{try{const n={};let t=!1;return ft.forEach(s=>{const a=localStorage.getItem(s);if(a&&a!=="[]"&&a!=="{}")try{n[s]=JSON.parse(a),t=!0}catch{n[s]=a,t=!0}}),t?n:null}catch(n){return console.error("Error getting legacy data:",n),null}},Fe=n=>{try{const t={};let s=!1;return bt.forEach(a=>{const r=`fifa_${n}_${a}`,i=localStorage.getItem(r);if(i&&i!=="[]"&&i!=="{}")try{t[a]=JSON.parse(i),s=!0}catch{t[a]=i,s=!0}}),s?t:null}catch(t){return console.error(`Error getting data for version ${n}:`,t),null}},yt=()=>{try{const n=Me();if(!n)throw new Error("Keine Legacy-Daten gefunden");const t={exportType:"legacy",exportDate:new Date().toISOString(),appVersion:"1.0.0",data:n,metadata:{recordCount:$e(n),description:"Legacy Datenexport vor FIFA Versioning System"}};return Pe(t,`legacy-data-export-${new Date().toISOString().slice(0,10)}.json`),!0}catch(n){throw console.error("Error exporting legacy data:",n),n}},jt=n=>{try{const t=Fe(n);if(!t)throw new Error(`Keine Daten f√ºr Version ${n} gefunden`);const s={exportType:"version",version:n,exportDate:new Date().toISOString(),appVersion:"1.0.0",data:t,metadata:{recordCount:$e(t),description:`Datenexport f√ºr FIFA Version ${n}`}};return Pe(s,`${n}-data-export-${new Date().toISOString().slice(0,10)}.json`),!0}catch(t){throw console.error(`Error exporting data for version ${n}:`,t),t}},vt=(n,t,s=!1)=>{try{const a=n==="legacy"?"fifa_transactions":`fifa_${n}_transactions`,r=n==="legacy"?"fifa_finances":`fifa_${n}_finances`,i=localStorage.getItem(a),c=localStorage.getItem(r);if(!i&&!c)throw new Error(`Keine Finanzdaten in Version ${n} gefunden`);const u=t==="legacy"?"fifa_transactions":`fifa_${t}_transactions`,o=t==="legacy"?"fifa_finances":`fifa_${t}_finances`,h=localStorage.getItem(u),d=localStorage.getItem(o);if((h||d)&&!s)throw new Error(`Version ${t} enth√§lt bereits Finanzdaten. Verwenden Sie '√úberschreiben' Option.`);return i&&localStorage.setItem(u,i),c&&localStorage.setItem(o,c),window.dispatchEvent(new CustomEvent("financialDataCopied",{detail:{fromVersion:n,toVersion:t,timestamp:new Date().toISOString()}})),!0}catch(a){throw console.error("Error copying financial data:",a),a}},wt=()=>{try{const n=[],t=localStorage.getItem("fifa_transactions"),s=localStorage.getItem("fifa_finances");(t||s)&&n.push({id:"legacy",name:"Legacy Daten",hasTransactions:!!t,hasFinances:!!s});const a=Je();return Object.keys(a).forEach(r=>{const i=`fifa_${r}_transactions`,c=`fifa_${r}_finances`,u=!!localStorage.getItem(i),o=!!localStorage.getItem(c);(u||o)&&n.push({id:r,name:`${r} (${a[r]})`,hasTransactions:u,hasFinances:o})}),n}catch(n){return console.error("Error getting versions with financial data:",n),[]}},$e=n=>{let t=0;return Object.values(n).forEach(s=>{Array.isArray(s)?t+=s.length:typeof s=="object"&&s!==null?t+=Object.keys(s).length:t+=1}),t},Pe=(n,t)=>{const s=JSON.stringify(n,null,2),a=new Blob([s],{type:"application/json"}),r=URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download=t,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)},Nt=async(n,t)=>{try{const s=await kt(n),a=JSON.parse(s);if(!a.data||!a.exportType)throw new Error("Ung√ºltiges Datenformat");const{data:r,exportType:i}=a;return i==="legacy"?Object.entries(r).forEach(([c,u])=>{const o=St(c);if(o){const h=`fifa_${t}_${o}`;localStorage.setItem(h,JSON.stringify(u))}}):i==="version"&&Object.entries(r).forEach(([c,u])=>{const o=`fifa_${t}_${c}`;localStorage.setItem(o,JSON.stringify(u))}),!0}catch(s){throw console.error("Error importing data:",s),s}},St=n=>({fifa_matches:"matches",fifa_players:"players",fifa_bans:"bans",fifa_transactions:"transactions",fifa_finances:"finances",alcoholCalculatorValues:"alcoholCalculator"})[n]||null,kt=n=>new Promise((t,s)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=s,a.readAsText(n)}),Ct=()=>{const[n,t]=y.useState([]),[s,a]=y.useState([]),[r,i]=y.useState(!1),[c,u]=y.useState(!1),[o,h]=y.useState(!1),[d,m]=y.useState(""),[S,f]=y.useState(""),[g,k]=y.useState(!1),[b,A]=y.useState(null),[C,p]=y.useState(""),[w,l]=y.useState({});y.useEffect(()=>(()=>{x();const R=()=>{x()};return window.addEventListener("financialDataCopied",R),window.addEventListener("fifaVersionChanged",R),()=>{window.removeEventListener("financialDataCopied",R),window.removeEventListener("fifaVersionChanged",R)}})(),[]);const x=()=>{const T=ue(),R=wt(),O=be();t(T),a(R),S||f(O),C||p(O),v()},v=()=>{var Q,te,se;const T={},R=Me();R&&(T.legacy={matches:((Q=R.fifa_matches)==null?void 0:Q.length)||0,players:((te=R.fifa_players)==null?void 0:te.length)||0,transactions:((se=R.fifa_transactions)==null?void 0:se.length)||0,hasData:!0}),ue().forEach(ae=>{var ie,le,oe;const Y=Fe(ae.id);Y&&(T[ae.id]={matches:((ie=Y.matches)==null?void 0:ie.length)||0,players:((le=Y.players)==null?void 0:le.length)||0,transactions:((oe=Y.transactions)==null?void 0:oe.length)||0,hasData:!0})}),l(T)},E=async()=>{try{i(!0),await yt(),P.success("Legacy-Daten erfolgreich exportiert")}catch(T){console.error("Error exporting legacy data:",T),P.error(`Fehler beim Export: ${T.message}`)}finally{i(!1)}},j=async T=>{try{i(!0),await jt(T),P.success(`Daten f√ºr ${re(T)} erfolgreich exportiert`)}catch(R){console.error(`Error exporting version ${T}:`,R),P.error(`Fehler beim Export: ${R.message}`)}finally{i(!1)}},$=async()=>{if(!d||!S){P.error("Bitte w√§hlen Sie Quell- und Ziel-Version aus");return}if(d===S){P.error("Quell- und Ziel-Version m√ºssen unterschiedlich sein");return}try{i(!0),await vt(d,S,g),P.success(`Finanzdaten von ${d} nach ${S} kopiert`),u(!1),x()}catch(T){console.error("Error copying financial data:",T),P.error(`Fehler beim Kopieren: ${T.message}`)}finally{i(!1)}},_=async()=>{if(!b||!C){P.error("Bitte w√§hlen Sie eine Datei und Ziel-Version aus");return}try{i(!0),await Nt(b,C),P.success(`Daten erfolgreich in ${C} importiert`),h(!1),A(null),x()}catch(T){console.error("Error importing data:",T),P.error(`Fehler beim Import: ${T.message}`)}finally{i(!1)}};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-xl p-6 border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Daten Export & Import"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Legacy-Daten downloaden und Finanzdaten zwischen Versionen kopieren"})]}),e.jsx("div",{className:"text-4xl",children:"üìä"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Daten√ºbersicht"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[w.legacy&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-medium text-amber-800 mb-2",children:"Legacy Daten"}),e.jsxs("div",{className:"space-y-1 text-sm text-amber-700",children:[e.jsxs("div",{children:["Matches: ",w.legacy.matches]}),e.jsxs("div",{children:["Spieler: ",w.legacy.players]}),e.jsxs("div",{children:["Transaktionen: ",w.legacy.transactions]})]})]}),n.map(T=>w[T.id]&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-medium text-blue-800 mb-2",children:T.name}),e.jsxs("div",{className:"space-y-1 text-sm text-blue-700",children:[e.jsxs("div",{children:["Matches: ",w[T.id].matches]}),e.jsxs("div",{children:["Spieler: ",w[T.id].players]}),e.jsxs("div",{children:["Transaktionen: ",w[T.id].transactions]})]})]},T.id))]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Daten exportieren"}),e.jsxs("div",{className:"space-y-4",children:[w.legacy&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-amber-800",children:"Legacy Daten"}),e.jsx("p",{className:"text-sm text-amber-600",children:"Urspr√ºngliche Daten vor dem Versioning-System"})]}),e.jsx("button",{onClick:E,disabled:r,className:"px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r?"Exportiere...":"Download"})]}),n.map(T=>w[T.id]&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-blue-800",children:T.name}),e.jsx("p",{className:"text-sm text-blue-600",children:"Versionsspezifische Daten"})]}),e.jsx("button",{onClick:()=>j(T.id),disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r?"Exportiere...":"Download"})]},T.id))]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:"Finanzdaten kopieren"}),e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Finanzen kopieren"})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-800 text-sm",children:"Kopieren Sie Transaktionen und Finanzst√§nde zwischen verschiedenen FIFA Versionen. Dies ist n√ºtzlich beim Wechsel zwischen Versionen oder beim √úbertragen historischer Daten."})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:"Daten importieren"}),e.jsx("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Daten importieren"})]}),e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsx("p",{className:"text-purple-800 text-sm",children:"Importieren Sie zuvor exportierte Daten in eine bestimmte FIFA Version. Unterst√ºtzt sowohl Legacy- als auch Versionsdatenformate."})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Finanzdaten kopieren"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Von Version"}),e.jsxs("select",{value:d,onChange:T=>m(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Version ausw√§hlen..."}),s.map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zu Version"}),e.jsxs("select",{value:S,onChange:T=>f(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Version ausw√§hlen..."}),n.map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"overwrite",checked:g,onChange:T=>k(T.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"overwrite",className:"ml-2 text-sm text-gray-700",children:"Bestehende Daten √ºberschreiben"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Abbrechen"}),e.jsx("button",{onClick:$,disabled:!d||!S||r,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r?"Kopiere...":"Kopieren"})]})]})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"Daten importieren"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Datei ausw√§hlen"}),e.jsx("input",{type:"file",accept:".json",onChange:T=>A(T.target.files[0]),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ziel-Version"}),e.jsxs("select",{value:C,onChange:T=>p(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[e.jsx("option",{value:"",children:"Version ausw√§hlen..."}),n.map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{h(!1),A(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Abbrechen"}),e.jsx("button",{onClick:_,disabled:!b||!C||r,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:r?"Importiere...":"Importieren"})]})]})})]})},At=()=>{const[n,t]=y.useState("season"),s=[{id:"season",label:"Saison-Manager",icon:"fas fa-calendar-alt",description:"Verwalten Sie Legacy- und FC26-Daten"},{id:"fifa-versions",label:"FIFA Versionen",icon:"fas fa-gamepad",description:"Verwalten und erstellen Sie FIFA Versionen"},{id:"version-teams",label:"Versions-Teams",icon:"fas fa-users-cog",description:"Konfigurieren Sie Team-Namen und Icons pro Version"},{id:"data-export",label:"Daten-Export",icon:"fas fa-download",description:"Legacy-Daten exportieren und Finanzen kopieren"}],a=()=>{switch(n){case"season":return e.jsx(Ae,{});case"fifa-versions":return e.jsx(xt,{});case"version-teams":return e.jsx(pt,{});case"data-export":return e.jsx(Ct,{});default:return e.jsx(Ae,{})}};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-blue-700 text-white shadow-xl",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center shadow-lg border border-white/10",children:e.jsx("i",{className:"fas fa-cogs text-2xl text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:"System-Manager"}),e.jsx("p",{className:"text-white/90 text-lg",children:"Zentrale Verwaltung f√ºr Saisons, FIFA Versionen und Teams"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:s.map(r=>e.jsxs("button",{onClick:()=>t(r.id),className:`group relative overflow-hidden rounded-2xl p-6 text-left transition-all duration-300 transform hover:scale-105 ${n===r.id?"bg-white text-indigo-600 shadow-2xl":"bg-white/10 backdrop-blur-sm text-white hover:bg-white/20 border border-white/20"}`,title:r.description,children:[e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center mb-4 ${n===r.id?"bg-indigo-100 text-indigo-600":"bg-white/20 text-white"}`,children:e.jsx("i",{className:`${r.icon} text-lg`})}),e.jsx("div",{className:`font-bold text-lg mb-2 ${n===r.id?"text-indigo-600":"text-white"}`,children:r.label}),e.jsx("div",{className:`text-sm ${n===r.id?"text-indigo-500":"text-white/80"}`,children:r.description})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-white/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),n===r.id&&e.jsx("div",{className:"absolute top-4 right-4 w-3 h-3 bg-emerald-400 rounded-full shadow-lg"})]},r.id))})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50",children:a()})]})};var Et={};class Dt{constructor(){this.baseURL="https://api.ea.com/fc",this.apiKey=Et.REACT_APP_EA_FC_API_KEY||"",this.cache=new Map,this.cacheExpiry=30*60*1e3,this.requestQueue=[],this.isProcessing=!1,this.rateLimitDelay=1e3}async getPlayerData(t,s={}){try{const a=`player_${t.toLowerCase()}`,r=this.getCachedData(a);return r&&!s.forceRefresh?{data:r,source:"cache"}:await this.queueRequest(async()=>{let i=await this.fetchFromEAFC(t);return i||(i=await this.fetchFromSoFIFA(t)),i||(i=this.getMockPlayerData(t)),i&&this.setCachedData(a,i),{data:i,source:i?i.source||"ea_fc":"not_found"}})}catch(a){return console.error("Error fetching player data:",a),{data:null,error:a.message}}}async fetchFromEAFC(t){if(!this.apiKey)return console.warn("EA FC API key not configured"),null;try{const s=`${this.baseURL}/players/search`,a=await fetch(s,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:t,limit:1,exact_match:!1})});if(!a.ok)throw new Error(`EA FC API error: ${a.status}`);const r=await a.json();if(r.players&&r.players.length>0){const i=r.players[0];return this.normalizePlayerData(i,"ea_fc")}return null}catch(s){return console.warn("EA FC API request failed:",s),null}}async fetchFromSoFIFA(t){try{if(window.FIFADataService){const s=await window.FIFADataService.getPlayerData(t);if(s&&s.overall)return this.normalizePlayerData(s,"sofifa")}return null}catch(s){return console.warn("SoFIFA fallback failed:",s),null}}getMockPlayerData(t){const s={mbappe:{name:"Kylian Mbapp√©",overall:91,potential:95,position:"LW",age:25,club:"Paris Saint-Germain",nationality:"France",stats:{pace:97,shooting:89,passing:80,dribbling:92,defending:36,physical:77}},haaland:{name:"Erling Haaland",overall:88,potential:94,position:"ST",age:23,club:"Manchester City",nationality:"Norway",stats:{pace:89,shooting:94,passing:65,dribbling:80,defending:45,physical:88}},ronaldo:{name:"Cristiano Ronaldo",overall:90,potential:90,position:"ST",age:39,club:"Al Nassr",nationality:"Portugal",stats:{pace:81,shooting:92,passing:78,dribbling:85,defending:34,physical:75}}},a=t.toLowerCase().replace(/[^\w]/g,""),r=Object.keys(s).filter(i=>i.includes(a)||a.includes(i));if(r.length>0){const i=s[r[0]];return this.normalizePlayerData(i,"mock")}return this.normalizePlayerData({name:t,overall:Math.floor(Math.random()*30)+60,potential:Math.floor(Math.random()*40)+60,position:["ST","LW","RW","CM","CB"][Math.floor(Math.random()*5)],age:Math.floor(Math.random()*15)+18,club:"Unknown",nationality:"Unknown"},"mock")}normalizePlayerData(t,s){var a;return{name:t.name||t.player_name||"Unknown",overall:t.overall||t.rating||75,potential:t.potential||t.overall||75,position:t.position||((a=t.preferred_positions)==null?void 0:a[0])||"ST",age:t.age||25,club:t.club||t.team||"Unknown",nationality:t.nationality||t.country||"Unknown",value:t.value||t.market_value||0,wage:t.wage||t.salary||0,stats:t.stats||{pace:t.pace||70,shooting:t.shooting||70,passing:t.passing||70,dribbling:t.dribbling||70,defending:t.defending||70,physical:t.physical||70},source:s,lastUpdated:new Date().toISOString(),sofifaUrl:t.sofifaUrl||null}}async queueRequest(t){return new Promise((s,a)=>{this.requestQueue.push({requestFn:t,resolve:s,reject:a}),this.processQueue()})}async processQueue(){if(!(this.isProcessing||this.requestQueue.length===0)){for(this.isProcessing=!0;this.requestQueue.length>0;){const{requestFn:t,resolve:s,reject:a}=this.requestQueue.shift();try{const r=await t();s(r)}catch(r){a(r)}this.requestQueue.length>0&&await new Promise(r=>setTimeout(r,this.rateLimitDelay))}this.isProcessing=!1}}async batchGetPlayerData(t,s={}){const a={};for(const r of t)try{const i=await this.getPlayerData(r,s);a[r]=i}catch(i){a[r]={data:null,error:i.message}}return a}async getPlayersByClub(t){try{return{data:[{name:"Mock Player 1",overall:85,position:"ST"},{name:"Mock Player 2",overall:83,position:"CM"}],source:"mock"}}catch(s){return console.error("Error fetching club players:",s),{data:[],error:s.message}}}getCachedData(t){const s=this.cache.get(t);return s&&Date.now()-s.timestamp<this.cacheExpiry?s.data:null}setCachedData(t,s){this.cache.set(t,{data:s,timestamp:Date.now()})}clearCache(){this.cache.clear()}async testConnectivity(){try{if(!this.apiKey)return{connected:!1,message:"EA FC API key not configured. Using fallback sources.",fallbackAvailable:!0};const t=await fetch(`${this.baseURL}/health`,{headers:{Authorization:`Bearer ${this.apiKey}`}});return{connected:t.ok,message:t.ok?"EA FC API connected":"EA FC API connection failed",fallbackAvailable:!0}}catch(t){return{connected:!1,message:"EA FC API unreachable. Using fallback sources.",fallbackAvailable:!0,error:t.message}}}async getLiveMatchData(t){if(!this.apiKey)return console.warn("EA FC API key not configured for live match data"),this.getMockLiveMatchData(t);try{const s=await fetch(`${this.baseURL}/matches/${t}/live`,{headers:{Authorization:`Bearer ${this.apiKey}`,Accept:"application/json"}});if(!s.ok)throw new Error(`Live match fetch failed: ${s.status}`);const a=await s.json();return this.normalizeLiveMatchData(a)}catch(s){return console.warn("Live match data fetch failed, using mock data:",s),this.getMockLiveMatchData(t)}}async getTransferMarketPrice(t){if(!this.apiKey)return console.warn("EA FC API key not configured for transfer market"),this.getMockMarketPrice(t);try{const s=`market_${t}`,a=this.getCachedData(s);if(a)return a;const r=await fetch(`${this.baseURL}/transfermarket/player/${t}`,{headers:{Authorization:`Bearer ${this.apiKey}`,Accept:"application/json"}});if(!r.ok)throw new Error(`Market price fetch failed: ${r.status}`);const i=await r.json(),c=this.normalizeMarketData(i);return this.setCachedData(s,c),c}catch(s){return console.warn("Market price fetch failed, using mock data:",s),this.getMockMarketPrice(t)}}async getMarketPriceTrend(t,s=7){if(!this.apiKey)return this.getMockPriceTrend(t,s);try{const a=await fetch(`${this.baseURL}/transfermarket/player/${t}/trend?days=${s}`,{headers:{Authorization:`Bearer ${this.apiKey}`,Accept:"application/json"}});if(!a.ok)throw new Error(`Price trend fetch failed: ${a.status}`);const r=await a.json();return this.normalizePriceTrendData(r)}catch(a){return console.warn("Price trend fetch failed, using mock data:",a),this.getMockPriceTrend(t,s)}}async batchUpdatePlayers(t){const s={updated:[],failed:[],unchanged:[]};for(const a of t)try{const r=await this.getPlayerData(a.name,{forceRefresh:!0});r.data?s.updated.push({...a,updatedData:r.data,source:r.source}):s.unchanged.push(a)}catch(r){s.failed.push({...a,error:r.message})}return s}normalizeLiveMatchData(t){return{matchId:t.id||t.match_id,homeTeam:t.home_team||t.homeTeam,awayTeam:t.away_team||t.awayTeam,homeScore:t.home_score||t.homeScore||0,awayScore:t.away_score||t.awayScore||0,minute:t.minute||t.currentMinute||0,status:t.status||"live",events:t.events||[],stats:t.stats||{},lastUpdated:new Date().toISOString()}}normalizeMarketData(t){return{playerId:t.player_id||t.playerId,currentPrice:t.price||t.current_price||0,lowestPrice:t.lowest_price||t.min_price||0,highestPrice:t.highest_price||t.max_price||0,averagePrice:t.average_price||t.avg_price||0,lastUpdated:t.last_updated||new Date().toISOString(),volume:t.volume||t.transactions||0}}normalizePriceTrendData(t){return{playerId:t.player_id||t.playerId,priceHistory:t.price_history||t.prices||[],trend:t.trend||"stable",percentageChange:t.percentage_change||0,period:t.period||"7d"}}getMockLiveMatchData(t){return{matchId:t||"mock-match-1",homeTeam:"AEK Athens",awayTeam:"Real Madrid",homeScore:Math.floor(Math.random()*4),awayScore:Math.floor(Math.random()*4),minute:Math.floor(Math.random()*90),status:"live",events:[{type:"goal",team:"home",minute:23,player:"Max M√ºller"},{type:"goal",team:"away",minute:45,player:"Jan Becker"}],stats:{possession:{home:55,away:45},shots:{home:12,away:8},shotsOnTarget:{home:5,away:3}},lastUpdated:new Date().toISOString()}}getMockMarketPrice(t){const s=Math.floor(Math.random()*1e7)+1e6;return{playerId:t,currentPrice:s,lowestPrice:Math.floor(s*.85),highestPrice:Math.floor(s*1.15),averagePrice:s,lastUpdated:new Date().toISOString(),volume:Math.floor(Math.random()*1e3)+100}}getMockPriceTrend(t,s=7){const a=Math.floor(Math.random()*1e7)+1e6,r=[];let i=a;for(let u=s;u>=0;u--){const o=new Date;o.setDate(o.getDate()-u);const h=(Math.random()-.5)*.1;i=Math.floor(i*(1+h)),r.push({date:o.toISOString().split("T")[0],price:i})}const c=(i-a)/a*100;return{playerId:t,priceHistory:r,trend:c>2?"rising":c<-2?"falling":"stable",percentageChange:c.toFixed(2),period:`${s}d`}}}const W=new Dt;typeof window<"u"&&(window.EAFCAPIService=W);class Tt{constructor(){this.priceCache=new Map,this.trendCache=new Map,this.watchlist=new Set,this.priceAlerts=[],this.cacheTTL=5*60*1e3}async getMarketPrice(t){try{const s=`price_${t}`,a=this.getCachedPrice(s);if(a)return{data:a,source:"cache"};const r=await W.getTransferMarketPrice(t);return this.setCachedPrice(s,r),{data:r,source:"api"}}catch(s){return console.error("Error fetching market price:",s),{data:null,error:s.message}}}async getPriceTrend(t,s=7){try{const a=`trend_${t}_${s}d`,r=this.getCachedTrend(a);if(r)return{data:r,source:"cache"};const i=await W.getMarketPriceTrend(t,s);return this.setCachedTrend(a,i),{data:i,source:"api"}}catch(a){return console.error("Error fetching price trend:",a),{data:null,error:a.message}}}async analyzeMarket(t){const s={players:[],summary:{totalValue:0,averageChange:0,risingPlayers:0,fallingPlayers:0,stablePlayers:0}};for(const a of t)try{const r=await this.getMarketPrice(a),i=await this.getPriceTrend(a,7);if(r.data&&i.data){const c={playerId:a,currentPrice:r.data.currentPrice,trend:i.data.trend,percentageChange:parseFloat(i.data.percentageChange),recommendation:this.getRecommendation(i.data)};s.players.push(c),s.summary.totalValue+=r.data.currentPrice,i.data.trend==="rising"?s.summary.risingPlayers++:i.data.trend==="falling"?s.summary.fallingPlayers++:s.summary.stablePlayers++}}catch(r){console.warn(`Failed to analyze player ${a}:`,r)}if(s.players.length>0){const a=s.players.reduce((r,i)=>r+i.percentageChange,0)/s.players.length;s.summary.averageChange=a.toFixed(2)}return s}addToWatchlist(t,s={}){this.watchlist.add(t),s.priceThreshold&&this.priceAlerts.push({playerId:t,threshold:s.priceThreshold,condition:s.condition||"below",active:!0,createdAt:new Date().toISOString()}),this.saveWatchlist()}removeFromWatchlist(t){this.watchlist.delete(t),this.priceAlerts=this.priceAlerts.filter(s=>s.playerId!==t),this.saveWatchlist()}async checkPriceAlerts(){const t=[];for(const s of this.priceAlerts)if(s.active)try{const a=await this.getMarketPrice(s.playerId);if(a.data){const r=a.data.currentPrice,i=s.threshold;(s.condition==="below"?r<=i:r>=i)&&t.push({playerId:s.playerId,currentPrice:r,threshold:i,condition:s.condition,timestamp:new Date().toISOString()})}}catch(a){console.warn(`Failed to check alert for ${s.playerId}:`,a)}return t}async getMarketInsights(t){try{const[s,a]=await Promise.all([this.getMarketPrice(t),this.getPriceTrend(t,30)]);return!s.data||!a.data?{data:null,error:"Failed to fetch market data"}:{data:{playerId:t,currentMarket:s.data,trend:a.data,recommendation:this.getRecommendation(a.data),volatility:this.calculateVolatility(a.data.priceHistory),bestBuyTime:this.findBestBuyTime(a.data.priceHistory),projectedPrice:this.projectFuturePrice(a.data)},source:"analysis"}}catch(s){return console.error("Error generating market insights:",s),{data:null,error:s.message}}}getRecommendation(t){const s=parseFloat(t.percentageChange);return s>10?{action:"sell",reason:"Price is rising significantly",confidence:"high"}:s>5?{action:"hold",reason:"Price trending upward",confidence:"medium"}:s<-10?{action:"buy",reason:"Price has dropped significantly",confidence:"high"}:s<-5?{action:"buy",reason:"Good buying opportunity",confidence:"medium"}:{action:"hold",reason:"Price is stable",confidence:"low"}}calculateVolatility(t){if(!t||t.length<2)return 0;const s=t.map(c=>c.price),a=s.reduce((c,u)=>c+u,0)/s.length,r=s.reduce((c,u)=>c+Math.pow(u-a,2),0)/s.length;return(Math.sqrt(r)/a*100).toFixed(2)}findBestBuyTime(t){if(!t||t.length===0)return null;const s=t.reduce((a,r)=>r.price<a.price?r:a,t[0]);return{date:s.date,price:s.price,daysAgo:Math.floor((new Date-new Date(s.date))/(1e3*60*60*24))}}projectFuturePrice(t){var u;const s=((u=t.priceHistory[t.priceHistory.length-1])==null?void 0:u.price)||0,a=parseFloat(t.percentageChange),i=a/t.priceHistory.length*7;return{price:Math.floor(s*(1+i/100)),days:7,confidence:Math.abs(a)>5?"low":"medium",method:"linear_projection"}}getCachedPrice(t){const s=this.priceCache.get(t);return s&&Date.now()-s.timestamp<this.cacheTTL?s.data:null}setCachedPrice(t,s){this.priceCache.set(t,{data:s,timestamp:Date.now()})}getCachedTrend(t){const s=this.trendCache.get(t);return s&&Date.now()-s.timestamp<this.cacheTTL?s.data:null}setCachedTrend(t,s){this.trendCache.set(t,{data:s,timestamp:Date.now()})}clearCache(){this.priceCache.clear(),this.trendCache.clear()}saveWatchlist(){try{localStorage.setItem("fifa_transfer_watchlist",JSON.stringify({watchlist:Array.from(this.watchlist),alerts:this.priceAlerts}))}catch(t){console.warn("Failed to save watchlist:",t)}}loadWatchlist(){try{const t=localStorage.getItem("fifa_transfer_watchlist");if(t){const s=JSON.parse(t);this.watchlist=new Set(s.watchlist||[]),this.priceAlerts=s.alerts||[]}}catch(t){console.warn("Failed to load watchlist:",t)}}getWatchlistSummary(){return{totalPlayers:this.watchlist.size,activeAlerts:this.priceAlerts.filter(t=>t.active).length,players:Array.from(this.watchlist)}}}const K=new Tt;typeof window<"u"&&(window.TransferMarketService=K);class Mt{constructor(){this.jobs=new Map,this.jobHistory=[],this.maxHistorySize=100,this.isRunning=!1,this.syncIntervals={player_updates:24*60*60*1e3,market_prices:60*60*1e3,price_alerts:15*60*1e3,data_cleanup:7*24*60*60*1e3}}async initialize(){console.log("üîÑ Initializing Background Job Service..."),this.registerJob("player_updates",this.syncPlayerUpdates.bind(this),this.syncIntervals.player_updates),this.registerJob("market_prices",this.syncMarketPrices.bind(this),this.syncIntervals.market_prices),this.registerJob("price_alerts",this.checkPriceAlerts.bind(this),this.syncIntervals.price_alerts),this.registerJob("data_cleanup",this.cleanupOldData.bind(this),this.syncIntervals.data_cleanup),this.loadJobState(),this.isRunning=!0,console.log(`‚úÖ Background Job Service initialized with ${this.jobs.size} jobs`)}registerJob(t,s,a,r=!1){this.jobs.has(t)&&(console.warn(`Job ${t} already registered, updating...`),this.unregisterJob(t));const i={name:t,function:s,interval:a,lastRun:null,nextRun:null,status:"scheduled",enabled:!0,retryCount:0,maxRetries:3};this.jobs.set(t,i),this.scheduleJob(t),r&&this.runJob(t),console.log(`üìã Registered job: ${t} (interval: ${this.formatInterval(a)})`)}unregisterJob(t){const s=this.jobs.get(t);s&&s.timerId&&clearTimeout(s.timerId),this.jobs.delete(t)}scheduleJob(t){const s=this.jobs.get(t);if(!s||!s.enabled)return;const a=Date.now(),r=s.lastRun?s.lastRun+s.interval:a+1e3;s.nextRun=r,s.timerId&&clearTimeout(s.timerId),s.timerId=setTimeout(()=>{this.runJob(t)},Math.max(0,r-a))}async runJob(t){const s=this.jobs.get(t);if(!s||!s.enabled){console.warn(`Job ${t} not found or disabled`);return}s.status="running";const a=Date.now();try{console.log(`üîÑ Running job: ${t}`),await s.function();const r=Date.now()-a;s.status="completed",s.lastRun=Date.now(),s.retryCount=0,this.addToHistory({jobName:t,status:"success",duration:r,timestamp:new Date().toISOString()}),console.log(`‚úÖ Job completed: ${t} (${r}ms)`)}catch(r){console.error(`‚ùå Job failed: ${t}`,r),s.status="failed",s.retryCount++,this.addToHistory({jobName:t,status:"failed",error:r.message,timestamp:new Date().toISOString()}),s.retryCount<s.maxRetries&&(console.log(`üîÑ Retrying job ${t} (attempt ${s.retryCount+1}/${s.maxRetries})`),setTimeout(()=>this.runJob(t),5e3*s.retryCount))}finally{this.scheduleJob(t),this.saveJobState()}}async syncPlayerUpdates(){console.log("üîÑ Starting player updates sync...");try{const t=this.getMockPlayers(),s=await W.batchUpdatePlayers(t);return console.log(`‚úÖ Player sync completed: ${s.updated.length} updated, ${s.failed.length} failed`),{updated:s.updated.length,failed:s.failed.length,unchanged:s.unchanged.length}}catch(t){throw console.error("Player sync failed:",t),t}}async syncMarketPrices(){console.log("üîÑ Starting market price sync...");try{const t=K.getWatchlistSummary();if(t.totalPlayers===0)return console.log("‚ÑπÔ∏è No players in watchlist, skipping market sync"),{updated:0};let s=0;for(const a of t.players)try{await K.getMarketPrice(a),s++}catch(r){console.warn(`Failed to update price for ${a}:`,r)}return console.log(`‚úÖ Market sync completed: ${s} prices updated`),{updated:s}}catch(t){throw console.error("Market sync failed:",t),t}}async checkPriceAlerts(){console.log("üîÑ Checking price alerts...");try{const t=await K.checkPriceAlerts();return t.length>0&&(console.log(`üîî ${t.length} price alert(s) triggered`),this.sendNotifications(t)),{alerts:t.length}}catch(t){throw console.error("Price alert check failed:",t),t}}async cleanupOldData(){console.log("üîÑ Starting data cleanup...");try{return W.clearCache(),K.clearCache(),this.jobHistory.length>this.maxHistorySize&&(this.jobHistory=this.jobHistory.slice(-this.maxHistorySize)),console.log("‚úÖ Data cleanup completed"),{cleaned:!0}}catch(t){throw console.error("Data cleanup failed:",t),t}}sendNotifications(t){for(const s of t)this.showNotification({title:"üí∞ Price Alert",message:`Player ${s.playerId} is now ${s.condition} ${s.threshold}‚Ç¨ (Current: ${s.currentPrice}‚Ç¨)`,type:"info"})}showNotification({title:t,message:s,type:a="info"}){"Notification"in window&&Notification.permission==="granted"?new Notification(t,{body:s,icon:"/assets/icon-180.png"}):console.log(`üîî ${t}: ${s}`),typeof window<"u"&&window.dispatchEvent(new CustomEvent("backgroundJobNotification",{detail:{title:t,message:s,type:a}}))}addToHistory(t){this.jobHistory.push(t),this.jobHistory.length>this.maxHistorySize&&this.jobHistory.shift()}getJobStatus(t){const s=this.jobs.get(t);return s?{name:s.name,status:s.status,enabled:s.enabled,lastRun:s.lastRun?new Date(s.lastRun).toISOString():null,nextRun:s.nextRun?new Date(s.nextRun).toISOString():null,interval:this.formatInterval(s.interval),retryCount:s.retryCount}:null}getAllJobsStatus(){const t=[];for(const s of this.jobs.keys())t.push(this.getJobStatus(s));return t}getJobHistory(t=null,s=20){let a=[...this.jobHistory];return t&&(a=a.filter(r=>r.jobName===t)),a.slice(-s).reverse()}setJobEnabled(t,s){const a=this.jobs.get(t);return a?(a.enabled=s,s?(this.scheduleJob(t),console.log(`‚úÖ Job ${t} enabled`)):(a.timerId&&clearTimeout(a.timerId),console.log(`‚è∏Ô∏è Job ${t} disabled`)),this.saveJobState(),!0):(console.warn(`Job ${t} not found`),!1)}updateJobInterval(t,s){const a=this.jobs.get(t);return a?(a.interval=s,this.scheduleJob(t),this.saveJobState(),console.log(`‚úÖ Job ${t} interval updated to ${this.formatInterval(s)}`),!0):(console.warn(`Job ${t} not found`),!1)}formatInterval(t){const s=Math.floor(t/1e3),a=Math.floor(s/60),r=Math.floor(a/60),i=Math.floor(r/24);return i>0?`${i} day(s)`:r>0?`${r} hour(s)`:a>0?`${a} minute(s)`:`${s} second(s)`}saveJobState(){try{const t={jobs:Array.from(this.jobs.entries()).map(([s,a])=>({name:s,enabled:a.enabled,lastRun:a.lastRun,interval:a.interval})),lastSaved:new Date().toISOString()};localStorage.setItem("fifa_background_jobs_state",JSON.stringify(t))}catch(t){console.warn("Failed to save job state:",t)}}loadJobState(){try{const t=localStorage.getItem("fifa_background_jobs_state");if(!t)return;const s=JSON.parse(t);for(const a of s.jobs){const r=this.jobs.get(a.name);r&&(r.enabled=a.enabled,r.lastRun=a.lastRun,a.interval&&(r.interval=a.interval))}console.log(`üìã Loaded job state from ${s.lastSaved}`)}catch(t){console.warn("Failed to load job state:",t)}}stop(){console.log("‚èπÔ∏è Stopping all background jobs...");for(const[t,s]of this.jobs.entries())s.timerId&&clearTimeout(s.timerId);this.isRunning=!1,console.log("‚úÖ All background jobs stopped")}getMockPlayers(){return[{id:1,name:"Max M√ºller"},{id:2,name:"Tom Schmidt"},{id:3,name:"Leon Wagner"}]}async requestNotificationPermission(){if("Notification"in window&&Notification.permission==="default"){const t=await Notification.requestPermission();return console.log(`Notification permission: ${t}`),t==="granted"}return Notification.permission==="granted"}}const U=new Mt;typeof window<"u"&&(window.BackgroundJobService=U);class Ft{constructor(){this.eaSportsCache=new Map,this.marketDataCache=new Map,this.liveMatchCache=new Map,this.cacheTTL={playerData:30*60*1e3,marketData:5*60*1e3,liveMatch:60*1e3},this.storageKey="ea_sports_offline_data",this.loadFromLocalStorage()}cachePlayerData(t,s){const a={data:s,timestamp:Date.now(),type:"player"};this.eaSportsCache.set(t,a),this.persistToLocalStorage(),console.log(`üíæ Cached player data for ${t}`)}getCachedPlayerData(t){const s=this.eaSportsCache.get(t);if(!s)return null;const a=Date.now()-s.timestamp;return a>this.cacheTTL.playerData?(this.eaSportsCache.delete(t),this.persistToLocalStorage(),null):(console.log(`üì¶ Retrieved cached player data for ${t} (age: ${Math.floor(a/1e3)}s)`),s.data)}cacheMarketData(t,s){const a={data:s,timestamp:Date.now(),type:"market"};this.marketDataCache.set(t,a),this.persistToLocalStorage(),console.log(`üíæ Cached market data for ${t}`)}getCachedMarketData(t){const s=this.marketDataCache.get(t);if(!s)return null;const a=Date.now()-s.timestamp;return a>this.cacheTTL.marketData?(this.marketDataCache.delete(t),this.persistToLocalStorage(),null):(console.log(`üì¶ Retrieved cached market data for ${t} (age: ${Math.floor(a/1e3)}s)`),s.data)}cacheLiveMatchData(t,s){const a={data:s,timestamp:Date.now(),type:"liveMatch"};this.liveMatchCache.set(t,a),console.log(`üíæ Cached live match data for ${t}`)}getCachedLiveMatchData(t){const s=this.liveMatchCache.get(t);if(!s)return null;const a=Date.now()-s.timestamp;return a>this.cacheTTL.liveMatch?(this.liveMatchCache.delete(t),null):(console.log(`üì¶ Retrieved cached live match data for ${t} (age: ${Math.floor(a/1e3)}s)`),s.data)}persistToLocalStorage(){try{const t={playerData:Array.from(this.eaSportsCache.entries()),marketData:Array.from(this.marketDataCache.entries()),lastUpdated:new Date().toISOString()};localStorage.setItem(this.storageKey,JSON.stringify(t)),console.log("üíæ EA Sports cache persisted to localStorage")}catch(t){console.warn("Failed to persist EA Sports cache:",t)}}loadFromLocalStorage(){try{const t=localStorage.getItem(this.storageKey);if(!t)return;const s=JSON.parse(t);s.playerData&&(this.eaSportsCache=new Map(s.playerData),console.log(`üì¶ Loaded ${this.eaSportsCache.size} cached player entries`)),s.marketData&&(this.marketDataCache=new Map(s.marketData),console.log(`üì¶ Loaded ${this.marketDataCache.size} cached market entries`)),this.cleanupExpiredEntries()}catch(t){console.warn("Failed to load EA Sports cache:",t)}}cleanupExpiredEntries(){let t=0;for(const[s,a]of this.eaSportsCache.entries())Date.now()-a.timestamp>this.cacheTTL.playerData&&(this.eaSportsCache.delete(s),t++);for(const[s,a]of this.marketDataCache.entries())Date.now()-a.timestamp>this.cacheTTL.marketData&&(this.marketDataCache.delete(s),t++);t>0&&(console.log(`üßπ Cleaned up ${t} expired cache entries`),this.persistToLocalStorage())}clearAllCaches(){this.eaSportsCache.clear(),this.marketDataCache.clear(),this.liveMatchCache.clear();try{localStorage.removeItem(this.storageKey)}catch(t){console.warn("Failed to clear localStorage:",t)}console.log("üóëÔ∏è All EA Sports caches cleared")}getCacheStats(){const t=Date.now(),s=(a,r)=>{let i=0,c=0,u=0;for(const o of a.values())t-o.timestamp<=r?i++:c++,u+=JSON.stringify(o.data).length;return{valid:i,expired:c,totalSize:u}};return{playerData:{...s(this.eaSportsCache,this.cacheTTL.playerData),total:this.eaSportsCache.size},marketData:{...s(this.marketDataCache,this.cacheTTL.marketData),total:this.marketDataCache.size},liveMatch:{total:this.liveMatchCache.size,valid:this.liveMatchCache.size,expired:0,totalSize:0}}}async preCachePlayers(t){if(console.log(`üîÑ Pre-caching ${t.length} players...`),typeof window<"u"&&window.EASportsIntegration){const s={cached:0,failed:0};for(const a of t)try{const r=await window.EASportsIntegration.getPlayerData(a);r.data?(this.cachePlayerData(a,r.data),s.cached++):s.failed++}catch(r){console.warn(`Failed to pre-cache ${a}:`,r),s.failed++}return console.log(`‚úÖ Pre-cache completed: ${s.cached} cached, ${s.failed} failed`),s}return console.warn("EASportsIntegration not available for pre-caching"),{cached:0,failed:t.length}}scheduleCleanup(t=5*60*1e3){setInterval(()=>{this.cleanupExpiredEntries()},t),console.log(`‚è∞ Scheduled cache cleanup every ${t/1e3}s`)}getOfflineFallbackData(t){const s=this.getCachedPlayerData(t);return s?{...s,offline:!0,offlineMessage:"Cached data (offline mode)"}:{name:t,overall:75,position:"Unknown",club:"Unknown",offline:!0,offlineMessage:"Generic data (no cache available)",warning:"Unable to fetch current data. Please connect to the internet for updated information."}}isOfflineMode(){return!navigator.onLine}getOfflineStatus(){const t=this.getCacheStats();return{isOffline:this.isOfflineMode(),cacheStats:t,totalCachedEntries:t.playerData.total+t.marketData.total+t.liveMatch.total,hasValidCache:t.playerData.valid>0||t.marketData.valid>0,storageSize:this.getStorageSize()}}getStorageSize(){try{const t=localStorage.getItem(this.storageKey);return t?new Blob([t]).size:0}catch{return 0}}}const Ie=new Ft;typeof window<"u"&&(window.EASportsOfflineManager=Ie);class $t{constructor(){this.initialized=!1,this.apiConnected=!1,this.offlineManager=Ie,this.syncStatus={lastPlayerSync:null,lastMarketSync:null,lastAlertCheck:null},this.stats={totalApiCalls:0,successfulCalls:0,failedCalls:0,cachedCalls:0}}async initialize(t={}){if(this.initialized){console.log("‚ÑπÔ∏è EA Sports Integration already initialized");return}console.log("üöÄ Initializing EA Sports Integration...");try{const s=await W.testConnectivity();return this.apiConnected=s.connected,console.log(`üîå EA Sports API: ${s.message}`),t.enableBackgroundJobs!==!1&&await U.initialize(),K.loadWatchlist(),t.enableNotifications&&await U.requestNotificationPermission(),t.enableOfflineCache!==!1&&(this.offlineManager.scheduleCleanup(),console.log("üíæ Offline cache manager initialized")),this.initialized=!0,console.log("‚úÖ EA Sports Integration initialized successfully"),this.dispatchEvent("eaSportsInitialized",{apiConnected:this.apiConnected,backgroundJobsEnabled:t.enableBackgroundJobs!==!1}),!0}catch(s){throw console.error("‚ùå Failed to initialize EA Sports Integration:",s),s}}async getPlayerData(t,s={}){try{if(this.stats.totalApiCalls++,!navigator.onLine&&!s.forceRefresh){const r=this.offlineManager.getCachedPlayerData(t);if(r)return this.stats.cachedCalls++,{data:r,source:"offline_cache"}}const a=await W.getPlayerData(t,s);return a.source==="cache"?this.stats.cachedCalls++:a.data?(this.stats.successfulCalls++,this.offlineManager.cachePlayerData(t,a.data)):this.stats.failedCalls++,a}catch(a){this.stats.failedCalls++,console.error("Error fetching player data:",a);const r=this.offlineManager.getOfflineFallbackData(t);return r?{data:r,source:"offline_fallback"}:{data:null,error:a.message}}}async batchUpdatePlayers(t,s){console.log(`üîÑ Starting batch update for ${t.length} players...`);const a={updated:[],failed:[],unchanged:[],progress:0};for(let r=0;r<t.length;r++){const i=t[r];try{const c=await this.getPlayerData(i.name,{forceRefresh:!0});c.data?a.updated.push({...i,updatedData:c.data}):a.unchanged.push(i)}catch(c){a.failed.push({...i,error:c.message})}a.progress=Math.floor((r+1)/t.length*100),s&&s(a.progress,a)}return console.log(`‚úÖ Batch update completed: ${a.updated.length} updated, ${a.failed.length} failed`),this.dispatchEvent("batchUpdateComplete",a),a}async getLiveMatchData(t){try{this.stats.totalApiCalls++;const s=await W.getLiveMatchData(t);return this.stats.successfulCalls++,{data:s,source:"live"}}catch(s){return this.stats.failedCalls++,console.error("Error fetching live match data:",s),{data:null,error:s.message}}}async getMarketPrice(t){try{if(this.stats.totalApiCalls++,!navigator.onLine){const a=this.offlineManager.getCachedMarketData(t);if(a)return this.stats.cachedCalls++,{data:a,source:"offline_cache"}}const s=await K.getMarketPrice(t);return s.source==="cache"?this.stats.cachedCalls++:s.data?(this.stats.successfulCalls++,this.offlineManager.cacheMarketData(t,s.data)):this.stats.failedCalls++,s}catch(s){this.stats.failedCalls++,console.error("Error fetching market price:",s);const a=this.offlineManager.getCachedMarketData(t);return a?{data:{...a,offline:!0},source:"offline_fallback"}:{data:null,error:s.message}}}async getMarketInsights(t){try{this.stats.totalApiCalls++;const s=await K.getMarketInsights(t);return this.stats.successfulCalls++,s}catch(s){return this.stats.failedCalls++,console.error("Error getting market insights:",s),{data:null,error:s.message}}}addToWatchlist(t,s){K.addToWatchlist(t,s),this.dispatchEvent("watchlistUpdated",{action:"added",playerId:t,alertConfig:s})}removeFromWatchlist(t){K.removeFromWatchlist(t),this.dispatchEvent("watchlistUpdated",{action:"removed",playerId:t})}getWatchlistSummary(){return K.getWatchlistSummary()}async syncPlayerData(){console.log("üîÑ Manually triggering player data sync...");try{const t=await U.runJob("player_updates");return this.syncStatus.lastPlayerSync=new Date().toISOString(),t}catch(t){throw console.error("Player sync failed:",t),t}}async syncMarketPrices(){console.log("üîÑ Manually triggering market price sync...");try{const t=await U.runJob("market_prices");return this.syncStatus.lastMarketSync=new Date().toISOString(),t}catch(t){throw console.error("Market sync failed:",t),t}}getBackgroundJobsStatus(){return U.getAllJobsStatus()}getJobHistory(t=null,s=20){return U.getJobHistory(t,s)}setJobEnabled(t,s){return U.setJobEnabled(t,s)}updateJobInterval(t,s){return U.updateJobInterval(t,s)}getStats(){return{...this.stats,successRate:this.stats.totalApiCalls>0?(this.stats.successfulCalls/this.stats.totalApiCalls*100).toFixed(2)+"%":"0%",cacheHitRate:this.stats.totalApiCalls>0?(this.stats.cachedCalls/this.stats.totalApiCalls*100).toFixed(2)+"%":"0%",syncStatus:this.syncStatus,initialized:this.initialized,apiConnected:this.apiConnected}}getStatusReport(){return{integration:{initialized:this.initialized,apiConnected:this.apiConnected,version:"1.0.0"},stats:this.getStats(),backgroundJobs:this.getBackgroundJobsStatus(),watchlist:this.getWatchlistSummary(),lastSync:this.syncStatus}}resetStats(){this.stats={totalApiCalls:0,successfulCalls:0,failedCalls:0,cachedCalls:0}}clearAllCaches(){W.clearCache(),K.clearCache(),this.offlineManager.clearAllCaches(),console.log("‚úÖ All caches cleared")}getOfflineStatus(){return this.offlineManager.getOfflineStatus()}async preCachePlayers(t){return await this.offlineManager.preCachePlayers(t)}stop(){U.stop(),this.initialized=!1,console.log("‚èπÔ∏è EA Sports Integration stopped")}dispatchEvent(t,s){typeof window<"u"&&window.dispatchEvent(new CustomEvent(`eaSports_${t}`,{detail:s}))}async runDiagnostics(){console.log("üîç Running EA Sports API diagnostics...");const t={timestamp:new Date().toISOString(),connectivity:null,samplePlayer:null,marketPrice:null,backgroundJobs:null};try{t.connectivity=await W.testConnectivity()}catch(s){t.connectivity={error:s.message}}try{const s=await this.getPlayerData("Mbappe");t.samplePlayer={success:!!s.data,source:s.source}}catch(s){t.samplePlayer={error:s.message}}try{const s=await this.getMarketPrice("test_player");t.marketPrice={success:!!s.data,source:s.source}}catch(s){t.marketPrice={error:s.message}}try{t.backgroundJobs=this.getBackgroundJobsStatus()}catch(s){t.backgroundJobs={error:s.message}}return console.log("‚úÖ Diagnostics completed:",t),t}}const L=new $t;typeof window<"u"&&(window.EASportsIntegration=L);class Pt{constructor(){this.syncInProgress=!1,this.lastSyncResult=null}async syncAllPlayers(t={forceRefresh:!1}){if(this.syncInProgress)return console.warn("‚ö†Ô∏è Sync already in progress"),{error:"Sync already in progress"};this.syncInProgress=!0,console.log("üîÑ Starting comprehensive player data sync...");const s={total:0,updated:0,failed:0,unchanged:0,details:[],startTime:new Date().toISOString(),endTime:null,duration:0};try{const{data:a,error:r}=await H.getAll("players");if(r)throw new Error(`Failed to fetch players: ${r.message}`);if(!a||a.length===0)return console.log("‚ÑπÔ∏è No players found in database"),s;s.total=a.length,console.log(`üìä Found ${s.total} players to sync`);const i=await L.batchUpdatePlayers(a,(c,u)=>{console.log(`Progress: ${c}% (${u.updated.length} updated)`)});for(const c of i.updated)try{const u=this.mergePlayerData(c,c.updatedData),{error:o}=await H.update("players",c.id,u);o?(console.warn(`Failed to update player ${c.name}:`,o),s.failed++):(s.updated++,await this.logPlayerUpdate(c.id,c.name,c.updatedData)),s.details.push({id:c.id,name:c.name,status:o?"failed":"updated",error:o==null?void 0:o.message})}catch(u){console.warn(`Error processing player ${c.name}:`,u),s.failed++,s.details.push({id:c.id,name:c.name,status:"failed",error:u.message})}s.unchanged=i.unchanged.length,s.failed+=i.failed.length;for(const c of i.failed)s.details.push({id:c.id,name:c.name,status:"failed",error:c.error});return s.endTime=new Date().toISOString(),s.duration=new Date(s.endTime)-new Date(s.startTime),console.log(`‚úÖ Sync completed: ${s.updated} updated, ${s.failed} failed, ${s.unchanged} unchanged`),this.lastSyncResult=s,await this.logSyncJob(s),s}catch(a){return console.error("‚ùå Sync failed:",a),s.error=a.message,s}finally{this.syncInProgress=!1}}async syncSinglePlayer(t){try{const{data:s,error:a}=await H.getById("players",t);if(a||!s)throw new Error(`Player not found: ${(a==null?void 0:a.message)||"Unknown error"}`);const r=await L.getPlayerData(s.name,{forceRefresh:!0});if(!r.data)return{success:!1,error:"No data available from EA Sports API"};const i=this.mergePlayerData(s,r.data),{error:c}=await H.update("players",t,i);if(c)throw new Error(`Failed to update player: ${c.message}`);return await this.logPlayerUpdate(t,s.name,r.data),console.log(`‚úÖ Player ${s.name} synced successfully`),{success:!0,player:i}}catch(s){return console.error(`‚ùå Failed to sync player ${t}:`,s),{success:!1,error:s.message}}}mergePlayerData(t,s){return{...t,ea_sports_id:s.id||t.ea_sports_id,overall_rating:s.overall||t.overall_rating,potential:s.potential||t.potential,market_value:s.value||t.market_value,wage:s.wage||t.wage,nationality:s.nationality||t.nationality,age:s.age||t.age,position:s.position||t.position,detailed_stats:s.stats||t.detailed_stats,last_api_sync:new Date().toISOString()}}async logPlayerUpdate(t,s,a){try{const r={player_id:t,player_name:s,update_type:"full_sync",new_value:JSON.stringify({overall:a.overall,potential:a.potential,value:a.value,stats:a.stats}),source:"ea_sports",sync_date:new Date().toISOString()};if(G){const{error:i}=await G.from("player_updates").insert([r]);i&&!i.message.includes("does not exist")&&console.warn("Failed to log player update:",i)}}catch(r){console.warn("Failed to log player update:",r)}}async logSyncJob(t){try{const s={job_name:"player_sync",status:t.failed===0?"success":t.updated>0?"partial":"failed",records_processed:t.total,records_updated:t.updated,records_failed:t.failed,error_message:t.error||null,duration_ms:t.duration,started_at:t.startTime,completed_at:t.endTime};if(G){const{error:a}=await G.from("api_sync_logs").insert([s]);a&&!a.message.includes("does not exist")&&console.warn("Failed to log sync job:",a)}}catch(s){console.warn("Failed to log sync job:",s)}}async archivePlayerData(t,s="weekly_backup"){try{const a={player_id:t.id,player_name:t.name,team:t.team,position:t.position,overall_rating:t.overall_rating,potential:t.potential,value:t.market_value,wage:t.wage,age:t.age,nationality:t.nationality,stats:t.detailed_stats,archive_date:new Date().toISOString().split("T")[0],archive_reason:s};if(G){const{error:r}=await G.from("player_archives").insert([a]);if(r&&!r.message.includes("does not exist"))return console.warn("Failed to archive player data:",r),!1}return console.log(`üì¶ Archived data for ${t.name}`),!0}catch(a){return console.warn("Failed to archive player data:",a),!1}}async archiveAllPlayers(t="weekly_backup"){try{const{data:s,error:a}=await H.getAll("players");if(a||!s)throw new Error(`Failed to fetch players: ${a==null?void 0:a.message}`);console.log(`üì¶ Archiving ${s.length} players...`);let r=0;for(const i of s)await this.archivePlayerData(i,t)&&r++;return console.log(`‚úÖ Archived ${r}/${s.length} players`),{success:!0,archived:r,total:s.length}}catch(s){return console.error("‚ùå Failed to archive players:",s),{success:!1,error:s.message}}}getLastSyncResult(){return this.lastSyncResult}isSyncInProgress(){return this.syncInProgress}async getSyncStatistics(t=7){try{if(!G)return{error:"Database not available"};const s=new Date;s.setDate(s.getDate()-t);const{data:a,error:r}=await G.from("api_sync_logs").select("*").eq("job_name","player_sync").gte("started_at",s.toISOString()).order("started_at",{ascending:!1});if(r)throw r;return{totalRuns:a.length,successfulRuns:a.filter(c=>c.status==="success").length,failedRuns:a.filter(c=>c.status==="failed").length,partialRuns:a.filter(c=>c.status==="partial").length,totalProcessed:a.reduce((c,u)=>c+(u.records_processed||0),0),totalUpdated:a.reduce((c,u)=>c+(u.records_updated||0),0),avgDuration:a.length>0?a.reduce((c,u)=>c+(u.duration_ms||0),0)/a.length:0,lastRun:a.length>0?a[0]:null}}catch(s){return console.warn("Failed to get sync statistics:",s),{error:s.message}}}async getPlayerUpdateHistory(t,s=10){try{if(!G)return{error:"Database not available"};const{data:a,error:r}=await G.from("player_updates").select("*").eq("player_id",t).order("sync_date",{ascending:!1}).limit(s);if(r)throw r;return{data:a,error:null}}catch(a){return console.warn("Failed to get player update history:",a),{data:null,error:a.message}}}}const ze=new Pt;typeof window<"u"&&(window.EASportsDataSync=ze);const ge=()=>{const[n,t]=y.useState(!1),[s,a]=y.useState(!0),[r,i]=y.useState(null),[c,u]=y.useState(null);y.useEffect(()=>((async()=>{try{a(!0),await L.initialize({enableBackgroundJobs:!0,enableNotifications:!1,enableOfflineCache:!0}),t(!0),u(L.getStats()),i(null),console.log("‚úÖ EA Sports Integration initialized in React")}catch(l){console.error("‚ùå Failed to initialize EA Sports Integration:",l),i(l.message)}finally{a(!1)}})(),()=>{n&&L.stop()}),[]);const o=y.useCallback(async(w,l={})=>n?await L.getPlayerData(w,l):{data:null,error:"EA Sports integration not initialized"},[n]),h=y.useCallback(async w=>n?await L.getMarketPrice(w):{data:null,error:"EA Sports integration not initialized"},[n]),d=y.useCallback(async w=>n?await L.getMarketInsights(w):{data:null,error:"EA Sports integration not initialized"},[n]),m=y.useCallback((w,l)=>n?(L.addToWatchlist(w,l),!0):!1,[n]),S=y.useCallback(w=>n?(L.removeFromWatchlist(w),!0):!1,[n]),f=y.useCallback(()=>n?L.getWatchlistSummary():{totalPlayers:0,activeAlerts:0,players:[]},[n]),g=y.useCallback(async()=>{if(!n)return{error:"Not initialized"};try{return await L.syncPlayerData()}catch(w){return{error:w.message}}},[n]),k=y.useCallback(async()=>{if(!n)return{error:"Not initialized"};try{return await L.syncMarketPrices()}catch(w){return{error:w.message}}},[n]),b=y.useCallback(()=>n?L.getStatusReport():null,[n]),A=y.useCallback(()=>n?L.getBackgroundJobsStatus():[],[n]),C=y.useCallback(async()=>n?await L.runDiagnostics():null,[n]),p=y.useCallback(()=>{n&&u(L.getStats())},[n]);return{initialized:n,loading:s,error:r,stats:c,getPlayerData:o,getMarketPrice:h,getMarketInsights:d,addToWatchlist:m,removeFromWatchlist:S,getWatchlistSummary:f,syncPlayerData:g,syncMarketPrices:k,getStatusReport:b,getBackgroundJobsStatus:A,runDiagnostics:C,refreshStats:p,integration:L,dataSync:ze,marketService:K}},It=()=>{const{initialized:n,loading:t,stats:s}=ge();return t?e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-full text-xs",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-gray-600",children:"EA Sports l√§dt..."})]}):n?e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 rounded-full text-xs",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-green-700",children:"EA Sports aktiv"}),s&&e.jsxs("span",{className:"text-gray-500",children:["(",s.cacheHitRate," Cache)"]})]}):e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-red-100 rounded-full text-xs",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-red-700",children:"EA Sports offline"})]})},zt=()=>{const{initialized:n,loading:t,error:s,stats:a,getStatusReport:r,getBackgroundJobsStatus:i,syncPlayerData:c,syncMarketPrices:u,refreshStats:o}=ge(),[h,d]=y.useState(null),[m,S]=y.useState([]),[f,g]=y.useState(!1);y.useEffect(()=>{n&&(d(r()),S(i()))},[n,r,i]);const k=async()=>{g(!0);try{await c(),o(),d(r())}catch(A){console.error("Sync failed:",A)}finally{g(!1)}},b=async()=>{g(!0);try{await u(),o(),d(r())}catch(A){console.error("Sync failed:",A)}finally{g(!1)}};return t?e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})}):s?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-red-600",children:"‚ö†Ô∏è"}),e.jsx("h3",{className:"font-semibold text-red-800",children:"EA Sports Integration Fehler"})]}),e.jsx("p",{className:"text-red-600 text-sm",children:s})]}):n?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"EA Sports Integration"}),e.jsx(It,{})]}),a&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-3 text-sm",children:[e.jsxs("div",{className:"bg-blue-50 rounded p-2",children:[e.jsx("div",{className:"text-blue-600 font-medium",children:"API Calls"}),e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:a.totalApiCalls})]}),e.jsxs("div",{className:"bg-green-50 rounded p-2",children:[e.jsx("div",{className:"text-green-600 font-medium",children:"Success Rate"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:a.successRate})]}),e.jsxs("div",{className:"bg-purple-50 rounded p-2",children:[e.jsx("div",{className:"text-purple-600 font-medium",children:"Cache Hits"}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:a.cachedCalls})]}),e.jsxs("div",{className:"bg-orange-50 rounded p-2",children:[e.jsx("div",{className:"text-orange-600 font-medium",children:"Cache Rate"}),e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:a.cacheHitRate})]})]})]}),m&&m.length>0&&e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Background Jobs"}),e.jsx("div",{className:"space-y-2",children:m.map((A,C)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-700",children:A.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${A.status==="completed"?"bg-green-100 text-green-700":A.status==="running"?"bg-blue-100 text-blue-700":A.status==="failed"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:A.status}),e.jsx("span",{className:"text-gray-500 text-xs",children:A.interval})]})]},C))})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:k,disabled:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 transition-colors text-sm font-medium",children:f?"‚è≥ Syncing...":"üîÑ Sync Players"}),e.jsx("button",{onClick:b,disabled:f,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400 transition-colors text-sm font-medium",children:f?"‚è≥ Syncing...":"üí∞ Sync Market"})]})})]}):e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsx("p",{className:"text-gray-600 text-sm",children:"EA Sports Integration nicht verf√ºgbar"})})},Rt=({playerName:n,onClose:t})=>{const{getMarketPrice:s,getMarketInsights:a}=ge(),[r,i]=y.useState(!0),[c,u]=y.useState(null),[o,h]=y.useState(null),[d,m]=y.useState(null);if(y.useEffect(()=>{(async()=>{i(!0),m(null);try{const[b,A]=await Promise.all([s(n),a(n)]);b.data&&u(b.data),A.data&&h(A.data),!b.data&&!A.data&&m("Keine Marktdaten verf√ºgbar")}catch(b){console.error("Error fetching market data:",b),m(b.message)}finally{i(!1)}})()},[n,s,a]),r)return e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-2/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})});if(d)return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:n}),t&&e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:"‚úï"})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-4",children:e.jsx("p",{className:"text-red-600 text-sm",children:d})})]});const S=k=>k?new Intl.NumberFormat("de-DE").format(k)+" Coins":"N/A",f=k=>{switch(k){case"buy":return"text-green-600 bg-green-50";case"sell":return"text-red-600 bg-red-50";case"hold":return"text-blue-600 bg-blue-50";default:return"text-gray-600 bg-gray-50"}},g=k=>{switch(k){case"rising":return"üìà";case"falling":return"üìâ";case"stable":return"‚û°Ô∏è";default:return"‚ùì"}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold",children:n}),e.jsx("p",{className:"text-blue-100 text-sm mt-1",children:"Marktanalyse"})]}),t&&e.jsx("button",{onClick:t,className:"text-white hover:text-gray-200",children:"‚úï"})]})}),c&&e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"üí∞ Marktpreise"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-blue-600 text-sm mb-1",children:"Aktueller Preis"}),e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:S(c.currentPrice)})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-green-600 text-sm mb-1",children:"Niedrigster Preis"}),e.jsx("div",{className:"text-xl font-bold text-green-700",children:S(c.lowestPrice)})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-orange-600 text-sm mb-1",children:"H√∂chster Preis"}),e.jsx("div",{className:"text-xl font-bold text-orange-700",children:S(c.highestPrice)})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-purple-600 text-sm mb-1",children:"Durchschnitt"}),e.jsx("div",{className:"text-xl font-bold text-purple-700",children:S(c.averagePrice)})]})]}),c.volume!==void 0&&e.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Handelsvolumen:"})," ",c.volume," Transaktionen"]})]}),o&&e.jsxs("div",{className:"p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"üìä Marktanalyse"}),o.trend&&e.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:g(o.trend.trend)}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:["Trend: ",o.trend.trend==="rising"?"Steigend":o.trend.trend==="falling"?"Fallend":"Stabil"]}),e.jsxs("div",{className:`text-sm ${parseFloat(o.trend.percentageChange)>0?"text-green-600":"text-red-600"}`,children:[o.trend.percentageChange,"% Ver√§nderung"]})]})]})}),o.recommendation&&e.jsxs("div",{className:`p-4 rounded-lg mb-4 ${f(o.recommendation.action)}`,children:[e.jsxs("div",{className:"font-semibold text-lg mb-1",children:["Empfehlung: ",o.recommendation.action.toUpperCase()]}),e.jsx("p",{className:"text-sm",children:o.recommendation.reason}),e.jsxs("div",{className:"text-xs mt-2 opacity-75",children:["Konfidenz: ",o.recommendation.confidence]})]}),o.volatility!==void 0&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsxs("div",{className:"text-sm font-medium text-yellow-800",children:["üìä Volatilit√§t: ",o.volatility,"%"]}),e.jsx("div",{className:"text-xs text-yellow-700 mt-1",children:parseFloat(o.volatility)>10?"Hohe Preisschwankungen - risikoreicher Handel":"Stabile Preisentwicklung - niedrigeres Risiko"})]}),o.bestBuyTime&&e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200 mb-4",children:[e.jsx("div",{className:"text-sm font-medium text-green-800",children:"üí° Bester Kaufzeitpunkt"}),e.jsxs("div",{className:"text-xs text-green-700 mt-1",children:[o.bestBuyTime.date," - ",S(o.bestBuyTime.price),o.bestBuyTime.daysAgo!==void 0&&` (vor ${o.bestBuyTime.daysAgo} Tagen)`]})]}),o.projectedPrice&&e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-sm font-medium text-purple-800",children:"üîÆ Preisprognose (7 Tage)"}),e.jsx("div",{className:"text-xl font-bold text-purple-900 mt-1",children:S(o.projectedPrice.price)}),e.jsxs("div",{className:"text-xs text-purple-700 mt-1",children:["Konfidenz: ",o.projectedPrice.confidence]})]})]}),e.jsx("div",{className:"px-6 pb-4",children:e.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Daten von EA Sports API ‚Ä¢ Aktualisiert vor wenigen Minuten"})})]})};function Bt(){var b,A,C,p,w,l,x,v,E;const{initialized:n,loading:t,error:s,stats:a,runDiagnostics:r,refreshStats:i}=ge(),[c,u]=y.useState(""),[o,h]=y.useState(!1),[d,m]=y.useState(null),[S,f]=y.useState(!1),g=async()=>{f(!0);try{const j=await r();m(j),i()}catch(j){console.error("Diagnostics failed:",j)}finally{f(!1)}},k=()=>{c.trim()&&h(!0)};return t?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"üéÆ EA Sports API Integration"}),e.jsx("p",{className:"text-gray-600",children:"Verwalte die EA Sports API Integration und √ºberwache Live-Daten, Spieler-Updates und Transfermarkt."})]}),e.jsx(zt,{}),e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"‚ö° Schnellaktionen"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"üí∞ Transfermarkt Analyse"}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Suche einen Spieler und zeige Marktpreise und Insights an"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:c,onChange:j=>u(j.target.value),placeholder:"Spielername eingeben (z.B. Mbapp√©, Haaland)",className:"flex-1 px-4 py-2 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:j=>j.key==="Enter"&&k()}),e.jsx("button",{onClick:k,disabled:!c.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 transition-colors font-medium",children:"Analysieren"})]})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"font-medium text-purple-900 mb-2",children:"üîç System Diagnostics"}),e.jsx("p",{className:"text-sm text-purple-700 mb-3",children:"F√ºhre eine vollst√§ndige Diagnose des EA Sports Systems durch"}),e.jsx("button",{onClick:g,disabled:S||!n,className:"px-6 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:bg-gray-400 transition-colors font-medium",children:S?"‚è≥ L√§uft...":"üîç Diagnostics ausf√ºhren"})]})]})]}),o&&c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(Rt,{playerName:c,onClose:()=>h(!1)})})}),d&&e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üìä Diagnostics Ergebnisse"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`p-4 rounded-lg ${(b=d.connectivity)!=null&&b.connected?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:(A=d.connectivity)!=null&&A.connected?"‚úÖ":"‚ùå"}),e.jsx("h4",{className:"font-semibold",children:"API Verbindung"})]}),e.jsx("p",{className:"text-sm",children:((C=d.connectivity)==null?void 0:C.message)||"Keine Informationen verf√ºgbar"})]}),e.jsxs("div",{className:`p-4 rounded-lg ${(p=d.samplePlayer)!=null&&p.success?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:(w=d.samplePlayer)!=null&&w.success?"‚úÖ":"‚ö†Ô∏è"}),e.jsx("h4",{className:"font-semibold",children:"Player Data Test"})]}),e.jsx("p",{className:"text-sm",children:(l=d.samplePlayer)!=null&&l.success?`Datenquelle: ${d.samplePlayer.source}`:"Test fehlgeschlagen oder begrenzt"})]}),e.jsxs("div",{className:`p-4 rounded-lg ${(x=d.marketPrice)!=null&&x.success?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:(v=d.marketPrice)!=null&&v.success?"‚úÖ":"‚ö†Ô∏è"}),e.jsx("h4",{className:"font-semibold",children:"Market Price Test"})]}),e.jsx("p",{className:"text-sm",children:(E=d.marketPrice)!=null&&E.success?`Datenquelle: ${d.marketPrice.source}`:"Test fehlgeschlagen oder begrenzt"})]}),d.backgroundJobs&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"üîÑ"}),e.jsx("h4",{className:"font-semibold",children:"Background Jobs"})]}),e.jsxs("p",{className:"text-sm",children:[d.backgroundJobs.length," Jobs konfiguriert und aktiv"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center pt-2 border-t border-gray-200",children:["Diagnostics ausgef√ºhrt am: ",new Date(d.timestamp).toLocaleString("de-DE")]})]})]}),a&&n&&e.jsxs("div",{className:"modern-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"üìà Statistiken"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg",children:[e.jsx("div",{className:"text-blue-600 text-sm mb-1",children:"Total API Calls"}),e.jsx("div",{className:"text-3xl font-bold text-blue-700",children:a.totalApiCalls})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg",children:[e.jsx("div",{className:"text-green-600 text-sm mb-1",children:"Success Rate"}),e.jsx("div",{className:"text-3xl font-bold text-green-700",children:a.successRate})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg",children:[e.jsx("div",{className:"text-purple-600 text-sm mb-1",children:"Cache Hit Rate"}),e.jsx("div",{className:"text-3xl font-bold text-purple-700",children:a.cacheHitRate})]})]})]}),s&&e.jsxs("div",{className:"modern-card border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-red-600",children:"‚ö†Ô∏è"}),e.jsx("h3",{className:"font-semibold text-red-800",children:"Fehler"})]}),e.jsx("p",{className:"text-red-600 text-sm",children:s})]}),e.jsxs("div",{className:"modern-card bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"‚ÑπÔ∏è Information"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"EA Sports API Integration"})," erm√∂glicht Live-Daten, automatische Spieler-Updates und Transfermarkt-Funktionalit√§t."]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Automatische t√§gliche Spieler-Synchronisation"}),e.jsx("li",{children:"St√ºndliche Marktpreis-Updates"}),e.jsx("li",{children:"15-min√ºtige Preis-Alert √úberpr√ºfungen"}),e.jsx("li",{children:"W√∂chentliche Daten-Bereinigung"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Version 1.0.0 ‚Ä¢ Weitere Informationen in der Dokumentation (EA_SPORTS_API_INTEGRATION.md)"})]})]})]})}function Ot({onLogout:n,onNavigate:t,showHints:s=!1,user:a}){const[r,i]=y.useState("search"),[c,u]=y.useState({}),[o,h]=y.useState(!1);if(!a||a.email!=="philip-melchert@live.de")return e.jsx("div",{className:"flex items-center justify-center min-h-[50vh] p-4",children:e.jsxs("div",{className:"modern-card p-8 text-center max-w-md",children:[e.jsx("div",{className:"text-6xl mb-4","aria-hidden":"true",children:"üîí"}),e.jsx("h3",{className:"text-xl font-bold mb-2 text-text-primary",children:"Zugriff verweigert"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"Sie haben keine Berechtigung, auf den Admin-Bereich zuzugreifen."}),e.jsx("button",{onClick:()=>t("matches"),className:"btn-primary","aria-label":"Zur √úbersicht zur√ºckkehren",children:"Zur √úbersicht"})]})});const d=[{id:"search",label:"Suche",icon:"fas fa-search",category:"quick",description:"Globale Suche durch alle Daten"},{id:"matches",label:"Spiele",icon:"fas fa-futbol",category:"data",description:"Neue Spiele hinzuf√ºgen und verwalten"},{id:"players",label:"Spieler",icon:"fas fa-users",category:"data",description:"Spieler hinzuf√ºgen und bearbeiten"},{id:"transactions",label:"Finanzen",icon:"fas fa-euro-sign",category:"data",description:"Transaktionen und Finanzen verwalten"},{id:"bans",label:"Sperren",icon:"fas fa-ban",category:"data",description:"Spielersperren hinzuf√ºgen und verwalten"},{id:"settings",label:"Teams",icon:"fas fa-cog",category:"config",description:"Team-Einstellungen und Konfiguration"},{id:"events",label:"Events",icon:"fas fa-bell",category:"config",description:"Events & Benachrichtigungen verwalten"},{id:"ea-sports",label:"EA Sports",icon:"fas fa-gamepad",category:"system",description:"EA Sports API Integration verwalten"},{id:"manager",label:"System",icon:"fas fa-tools",category:"system",description:"System-Manager f√ºr Saisons und Versionen"},{id:"delete",label:"Daten l√∂schen",icon:"fas fa-trash",category:"system",description:"Daten l√∂schen und bereinigen"}],m=()=>Object.entries({quick:{name:"Schnellzugriff",icon:"‚ö°",color:"blue"},data:{name:"Datenmanagement",icon:"üìä",color:"green"},config:{name:"Konfiguration",icon:"‚öôÔ∏è",color:"purple"},system:{name:"System",icon:"üîß",color:"red"}}).map(([k,b])=>({category:k,...b,tabs:d.filter(A=>A.category===k)})),S=()=>{switch(r){case"search":return e.jsx(Ce,{onNavigate:t});case"matches":return e.jsx(st,{});case"bans":return e.jsx(at,{});case"players":return e.jsx(rt,{});case"transactions":return e.jsx(nt,{});case"settings":return e.jsx(ht,{});case"events":return e.jsx(ut,{});case"ea-sports":return e.jsx(Bt,{});case"delete":return e.jsx(it,{});case"manager":return e.jsx(At,{});default:return e.jsx(Ce,{onNavigate:t})}},f=m();return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"bg-gradient-to-r from-gray-900 to-blue-900 text-white shadow-lg",children:e.jsxs("div",{className:"p-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx("i",{className:"fas fa-cogs text-xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-1",children:"Verwaltung"}),e.jsx("p",{className:"text-white/80 text-sm",children:"Zentrale Administration und Datenmanagement"})]})]}),e.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-all duration-200 hover:shadow-lg transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-50","aria-label":"Abmelden",children:[e.jsx("i",{className:"fas fa-sign-out-alt"}),e.jsx("span",{className:"text-sm font-medium",children:"Logout"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b border-border-light",children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:f.map(g=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"text-lg",children:g.icon}),e.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:g.name})]}),e.jsx("div",{className:"space-y-2",children:g.tabs.map(k=>e.jsxs("button",{onClick:()=>i(k.id),className:`w-full group relative overflow-hidden rounded-xl p-4 text-left transition-all duration-300 ${r===k.id?`bg-gradient-to-r from-${g.color}-500 to-${g.color}-600 text-white shadow-lg transform scale-105`:"bg-white hover:bg-gray-50 border border-gray-200 hover:border-gray-300 hover:shadow-md"}`,title:k.description,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center ${r===k.id?"bg-white/20":`bg-${g.color}-50`}`,children:e.jsx("i",{className:`${k.icon} ${r===k.id?"text-white":`text-${g.color}-600`}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`font-medium ${r===k.id?"text-white":"text-gray-900"}`,children:k.label}),e.jsx("div",{className:`text-xs mt-1 ${r===k.id?"text-white/80":"text-gray-500"}`,children:k.description})]})]}),r===k.id&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 to-white/5 pointer-events-none"})]},k.id))})]},g.category))})})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:S()})]})}export{Ot as default};
