import{g as U,b as xe,S as Q,s as D,u as O,r as T,j as e,z as R,t as P,a as te,L as ge,c as ve,d as Ne,e as we,f as Se,h as ke}from"./main-VFnul4GP.js";import{B as Z}from"./banTypes-DuNOJEIt.js";import{d as q}from"./dataManager-C8rOmH55.js";const Ee="alcoholCalculatorValues",ae="2.0",J=(n=null)=>{const a=n||U();return{aekPlayer:"",realPlayer:"",aekGoals:0,realGoals:0,mode:"manual",gameDay:new Date().toISOString().split("T")[0],beerCount:{aek:0,real:0},alexanderShots:{cl40:0,cl20:0},philipShots:{cl40:0,cl20:0},cumulativeShots:{aek:0,real:0,total:0,lastMatchId:null,lastUpdated:null},lastUpdated:new Date().toISOString(),drinkingStartTime:null,version:ae,season:a}},oe=(n=null)=>{try{const a=n||U(),r=xe("alcoholCalculator",a);let t=localStorage.getItem(r);if(!t&&a===Q.LEGACY&&(t=localStorage.getItem(Ee),t&&(console.log("Migrating legacy alcohol calculator data to season-based storage"),localStorage.setItem(r,t))),!t)return J(a);const l=JSON.parse(t);if(!l.version||l.version!==ae&&l.version!=="1.0")return console.log("Alcohol calculator: Version mismatch, using defaults"),J(a);const x=J(a);return{...x,...l,season:a,beerCount:{...x.beerCount,...l.beerCount||{}},alexanderShots:{...x.alexanderShots,...l.alexanderShots||{}},philipShots:{...x.philipShots,...l.philipShots||{}},cumulativeShots:{...x.cumulativeShots,...l.cumulativeShots||{}}}}catch(a){return console.error("Error loading alcohol calculator values:",a),J(n)}},Ae=(n,a=null)=>{try{const r=a||U(),t={...n,lastUpdated:new Date().toISOString(),version:ae,season:r},l=xe("alcoholCalculator",r);return localStorage.setItem(l,JSON.stringify(t)),typeof window<"u"&&window.dispatchEvent(new CustomEvent("alcoholCalculatorValuesChanged",{detail:{...t,season:r}})),!0}catch(r){return console.error("Error saving alcohol calculator values:",r),!1}},Ce=(n,a,r=null)=>{const t=r||U(),l={...a,...n,lastUpdated:new Date().toISOString(),season:t};return n.beerCount&&(l.beerCount={...a.beerCount,...n.beerCount}),n.cumulativeShots&&(l.cumulativeShots={...a.cumulativeShots,...n.cumulativeShots}),Ae(l,t),l},be=(n,a=null,r=null)=>{try{const t=r||U(),l=a||oe(t);if(!n||typeof n!="object")return console.warn("Invalid match object provided to addShotsFromNewMatch"),l;const x=n.goalsa||0,y=n.goalsb||0,f=Math.floor(y/2)*2,d=Math.floor(x/2)*2;return Ce({cumulativeShots:{aek:l.cumulativeShots.aek+f,real:l.cumulativeShots.real+d,total:l.cumulativeShots.total+f+d,lastMatchId:n.id,lastUpdated:new Date().toISOString()}},l,t)}catch(t){return console.error("Error adding shots from new match:",t),a||oe(r)}};typeof window<"u"&&(window.updateAlcoholCalculatorFromMatch=n=>{try{be(n)}catch(a){console.warn("Failed to update alcohol calculator from match:",a)}});async function se(n){var a,r;try{if(console.log(`Starting deletion of match ${n}`),n==null)throw new Error("No match ID provided for deletion");console.log(`Processing match ID for deletion: ${n} (type: ${typeof n})`);let t;if(typeof n=="string"){if(n.trim()==="")throw new Error("Empty string provided as match ID");if(t=parseInt(n,10),isNaN(t))throw new Error(`Invalid match ID string: "${n}" cannot be converted to number`)}else if(typeof n=="bigint"){const m=Number(n);BigInt(m)===n?t=m:t=n}else if(typeof n=="number")t=n;else throw new Error(`Unsupported match ID type: ${typeof n}. Expected string, number, or bigint.`);const l=typeof t=="number"&&Number.isInteger(t)&&t>0,x=typeof t=="bigint"&&t>0n;if(!l&&!x)throw new Error(`Invalid match ID after conversion: ${t} (type: ${typeof t}). Must be a positive integer.`);console.log(`Converted match ID: ${t} (type: ${typeof t})`);const{data:y,error:f}=await D.select("matches","date,prizeaek,prizereal,goalslista,goalslistb,manofthematch,yellowa,reda,yellowb,redb",{id:t});if(f)throw console.error("Error fetching match:",f),f;if(!y||y.length===0){const m=`Match with ID ${t} not found in database`;throw console.error(m),new Error(m)}const d=y[0];d.date||console.warn(`Match ${t} has no date - this may cause issues with transaction cleanup`),console.log("Deleting match data:",d),console.log(`Fetching transactions for match ${t} before deletion`);const{data:u,error:i}=await D.select("transactions","team,amount,type",{match_id:t});if(i)throw console.error("Error fetching transactions:",i),i;const c=u||[];if(console.log(`Found ${c.length} transactions to reverse:`,c.map(m=>`${m.type}: ${m.amount} (${m.team})`)),console.log(`Reversing financial changes for ${(c==null?void 0:c.length)||0} transactions`),c&&c.length>0)for(const m of c)if(m.type==="Echtgeld-Ausgleich"){const{data:A,error:s}=await D.select("finances","debt",{team:m.team});if(s){console.error(`Error fetching finances for team ${m.team}:`,s);continue}const o=A&&A.length>0?A[0]:null;let v=((o==null?void 0:o.debt)||0)-m.amount;v<0&&(v=0),await D.update("finances",{debt:v},{team:m.team})}else{const{data:A,error:s}=await D.select("finances","balance",{team:m.team});if(s){console.error(`Error fetching finances for team ${m.team}:`,s);continue}const o=A&&A.length>0?A[0]:null;let v=((o==null?void 0:o.balance)||0)-m.amount;v<0&&(v=0),await D.update("finances",{balance:v},{team:m.team})}if(typeof d.prizeaek=="number"&&d.prizeaek!==0){const{data:m,error:A}=await D.select("finances","balance",{team:"AEK"});if(A)console.error("Error fetching AEK finances:",A);else if(m&&m.length>0){const s=m[0];let o=((s==null?void 0:s.balance)||0)-d.prizeaek;o<0&&(o=0),await D.update("finances",{balance:o},{team:"AEK"})}}if(typeof d.prizereal=="number"&&d.prizereal!==0){const{data:m,error:A}=await D.select("finances","balance",{team:"Real"});if(A)console.error("Error fetching Real finances:",A);else if(m&&m.length>0){const s=m[0];let o=((s==null?void 0:s.balance)||0)-d.prizereal;o<0&&(o=0),await D.update("finances",{balance:o},{team:"Real"})}}console.log(`Deleting ${(c==null?void 0:c.length)||0} transactions for match ${t}`);const{error:j}=await D.delete("transactions",{match_id:t});if(j)throw console.error("Error deleting transactions:",j),j;const{data:p,error:h}=await D.select("transactions","id",{match_id:t});if(h)console.warn("Could not verify transaction deletion:",h);else{if(p&&p.length>0)throw console.error(`‚ùå Failed to delete ${p.length} transactions for match ${t}`),new Error(`Transaction deletion incomplete: ${p.length} transactions still exist`);console.log(`‚úÖ Successfully deleted all transactions for match ${t}`)}const E=async(m,A)=>{if(!m||!Array.isArray(m))return;const s={};if(m.length>0&&typeof m[0]=="object"&&m[0].player!==void 0)m.forEach(o=>{o.player&&(s[o.player]=(s[o.player]||0)+(o.count||1))});else for(const o of m)o&&(s[o]=(s[o]||0)+1);for(const[o,b]of Object.entries(s)){const{data:v,error:C}=await D.select("players","goals",{name:o,team:A});if(C){console.error(`Error fetching player ${o} for goal removal:`,C);continue}if(!v||v.length===0){console.warn(`Player ${o} not found in team ${A} for goal removal`);continue}const z=v[0];let L=((z==null?void 0:z.goals)||0)-b;L<0&&(L=0);const{error:G}=await D.update("players",{goals:L},{name:o,team:A});G?console.error(`Error updating goals for player ${o}:`,G):console.log(`‚úÖ Updated goals for ${o} (${A}): ${z.goals} ‚Üí ${L}`)}};if(await E(d.goalslista,"AEK"),await E(d.goalslistb,"Real"),d.manofthematch){let m=null;const A=(s,o)=>!s||!s.length?!1:typeof s[0]=="object"&&s[0].player!==void 0?s.some(b=>b.player===o):s.includes(o);if(A(d.goalslista,d.manofthematch))m="AEK";else if(A(d.goalslistb,d.manofthematch))m="Real";else{const{data:s,error:o}=await D.select("players","team",{name:d.manofthematch});o?console.error(`Error fetching player ${d.manofthematch} for team lookup:`,o):s&&s.length>0?m=s[0].team:console.warn(`Player ${d.manofthematch} not found for SdS team determination`)}if(m){const{data:s,error:o}=await D.select("spieler_des_spiels","count",{name:d.manofthematch,team:m});if(o)console.error(`Error fetching SdS entry for ${d.manofthematch}:`,o);else if(s&&s.length>0){const b=s[0],v=Math.max(0,b.count-1),{error:C}=await D.update("spieler_des_spiels",{count:v},{name:d.manofthematch,team:m});C?console.error(`Error updating SdS count for ${d.manofthematch}:`,C):console.log(`‚úÖ Updated SdS count for ${d.manofthematch} (${m}): ${b.count} ‚Üí ${v}`)}else console.warn(`SdS entry for ${d.manofthematch} in team ${m} not found`)}}(d.yellowa>0||d.reda>0||d.yellowb>0||d.redb>0)&&console.log(`Match had cards: AEK(${d.yellowa}Y,${d.reda}R) Real(${d.yellowb}Y,${d.redb}R)`),console.log(`Deleting match ${t} from matches table`);const{error:$}=await D.delete("matches",{id:t});if($)throw console.error("Error deleting match:",$),$;const{data:F,error:w}=await D.select("matches","id",{id:t});if(w)console.warn("Could not verify match deletion:",w);else{if(F&&F.length>0)throw console.error(`‚ùå Failed to delete match ${t}`),new Error(`Match deletion failed: match ${t} still exists`);console.log(`‚úÖ Successfully deleted match ${t}`)}console.log(`‚úÖ Successfully deleted match ${t} and all related data`),console.log(`üìã Deletion Summary for Match ${t}:`),console.log("   - Match record: deleted"),console.log(`   - Transactions: ${c.length} deleted`),console.log(`   - Player goals: updated for ${((a=d.goalslista)==null?void 0:a.length)||0} AEK + ${((r=d.goalslistb)==null?void 0:r.length)||0} Real goals`),console.log(`   - Player of the match: ${d.manofthematch?"updated":"none"}`),console.log(`   - Prize money: AEK ${d.prizeaek||0}, Real ${d.prizereal||0} (reversed)`),console.log(`   - Match date: ${d.date}`)}catch(t){throw console.error(`Failed to delete match ${typeof matchId<"u"?matchId:n||"unknown"}:`,t),console.error("Error details:",{matchId:typeof matchId<"u"?matchId:"undefined",matchIdType:typeof matchId,originalId:n,originalIdType:typeof n,errorMessage:t.message,errorStack:t.stack}),t}}class ce{static async submitMatch(a){var F;const{date:r,teama:t="AEK",teamb:l="Real",goalsa:x,goalsb:y,goalslista:f=[],goalslistb:d=[],ownGoalsA:u=0,ownGoalsB:i=0,yellowa:c=0,reda:j=0,yellowb:p=0,redb:h=0,manofthematch:E,editId:$=null}=a;try{const{prizeaek:w,prizereal:m,winner:A,loser:s}=this.calculatePrizeMoney(x,y,c,j,p,h);$&&await this.deleteMatchTransactions($);const o=[...f],b=[...d];u>0&&b.push({count:u,player:"Eigentore_AEK"}),i>0&&o.push({count:i,player:"Eigentore_Real"});const v={date:r,teama:t,teamb:l,goalsa:parseInt(x)||0,goalsb:parseInt(y)||0,goalslista:f,goalslistb:d,yellowa:parseInt(c)||0,reda:parseInt(j)||0,yellowb:parseInt(p)||0,redb:parseInt(h)||0,manofthematch:E||null,prizeaek:w,prizereal:m},C=await D.insert("matches",v);if(C.error)throw new Error(`Match insert failed: ${C.error.message}`);const z=(F=C.data)==null?void 0:F.id,L=new Date().toISOString().slice(0,10);if(o.length>0){const G=o.filter(I=>typeof I=="object"&&I.player?!I.player.startsWith("Eigentore_"):!I.startsWith("Eigentore_"));await this.updatePlayersGoals(G,"AEK")}if(b.length>0){const G=b.filter(I=>typeof I=="object"&&I.player?!I.player.startsWith("Eigentore_"):!I.startsWith("Eigentore_"));await this.updatePlayersGoals(G,"Real")}E&&await this.updatePlayerOfTheMatchStats(E),await this.processFinancialTransactions({matchId:z,date:L,prizeaek:w,prizereal:m,manofthematch:E,winner:A,loser:s}),await this.decrementBansAfterMatch();try{be({id:z,goalsa:parseInt(x)||0,goalsb:parseInt(y)||0,date:r})}catch(G){console.warn("Failed to update alcohol calculator:",G)}return{success:!0,matchId:z,message:`Match ${t} vs ${l} (${x}:${y}) erfolgreich hinzugef√ºgt`}}catch(w){throw console.error("Error in submitMatch:",w),new Error(`Fehler beim Speichern des Matches: ${w.message}`)}}static calculatePrizeMoney(a,r,t,l,x,y){let f=0,d=0,u=null,i=null;return a>r?(u="AEK",i="Real"):a<r&&(u="Real",i="AEK"),u&&i&&(u==="AEK"?(f=1e6-r*5e4-t*2e4-l*5e4,d=-(5e5+a*5e4+x*2e4+y*5e4)):(d=1e6-a*5e4-x*2e4-y*5e4,f=-(5e5+r*5e4+t*2e4+l*5e4))),{prizeaek:f,prizereal:d,winner:u,loser:i}}static async updatePlayersGoals(a,r){const t={};if(a.length>0&&typeof a[0]=="object"&&a[0].player!==void 0)a.forEach(l=>{l.player&&!l.player.startsWith("Eigentore_")&&(t[l.player]=(t[l.player]||0)+(l.count||1))});else for(const l of a)!l||!l.trim()||l.startsWith("Eigentore_")||(t[l]=(t[l]||0)+1);for(const[l,x]of Object.entries(t))try{const y=await D.select("players","id, goals",{eq:{name:l,team:r}});if(y.data&&y.data.length>0){const f=y.data[0],d=(f.goals||0)+x;await D.update("players",{goals:d},f.id)}}catch(y){console.warn(`Failed to update goals for player ${l}:`,y)}}static async updatePlayerOfTheMatchStats(a){try{const r=await D.select("players","team",{eq:{name:a}});if(!r.data||r.data.length===0){console.warn(`Player ${a} not found for SdS stats`);return}const t=r.data[0].team,l=await D.select("spieler_des_spiels","*",{eq:{name:a,team:t}});if(l.data&&l.data.length>0){const x=l.data[0];await D.update("spieler_des_spiels",{count:x.count+1},x.id)}else await D.insert("spieler_des_spiels",{name:a,team:t,count:1})}catch(r){console.warn(`Failed to update SdS stats for ${a}:`,r)}}static async processFinancialTransactions({matchId:a,date:r,prizeaek:t,prizereal:l,manofthematch:x,winner:y,loser:f}){const d=await this.getTeamFinance("AEK"),u=await this.getTeamFinance("Real");let i=d.balance||0,c=u.balance||0;const j=x?await this.getSdSBonus(x,"AEK"):0,p=x?await this.getSdSBonus(x,"Real"):0;j>0&&(i+=j,await this.insertTransaction({date:r,type:"SdS Bonus",team:"AEK",amount:j,match_id:a,info:"SdS Bonus"}),await this.updateTeamBalance("AEK",i)),p>0&&(c+=p,await this.insertTransaction({date:r,type:"SdS Bonus",team:"Real",amount:p,match_id:a,info:"SdS Bonus"}),await this.updateTeamBalance("Real",c)),t!==0&&(i+=t,i<0&&(i=0),await this.insertTransaction({date:r,type:"Preisgeld",team:"AEK",amount:t,match_id:a,info:"Preisgeld"}),await this.updateTeamBalance("AEK",i)),l!==0&&(c+=l,c<0&&(c=0),await this.insertTransaction({date:r,type:"Preisgeld",team:"Real",amount:l,match_id:a,info:"Preisgeld"}),await this.updateTeamBalance("Real",c)),y&&f&&await this.processEchtgeldAusgleich({date:r,matchId:a,winner:y,loser:f,aekBalance:i,realBalance:c,prizeaek:t,prizereal:l,sdsBonusAek:j>0?1:0,sdsBonusReal:p>0?1:0,manofthematch:x})}static async getTeamFinance(a){const r=await D.select("finances","*",{eq:{team:a}});return r.data&&r.data.length>0?r.data[0]:{balance:0,debt:0}}static async getSdSBonus(a,r){const t=await D.select("players","team",{eq:{name:a}});return t.data&&t.data.length>0&&t.data[0].team===r?1e5:0}static async insertTransaction(a){return await D.insert("transactions",a)}static async updateTeamBalance(a,r){const t=await D.select("finances","id",{eq:{team:a}});return t.data&&t.data.length>0?await D.update("finances",{balance:r},t.data[0].id):await D.insert("finances",{team:a,balance:r,debt:0})}static async processEchtgeldAusgleich({date:a,matchId:r,winner:t,loser:l,aekBalance:x,realBalance:y,prizeaek:f,prizereal:d,sdsBonusAek:u,sdsBonusReal:i,manofthematch:c}){const j=await this.getTeamFinance("AEK"),p=await this.getTeamFinance("Real"),h={AEK:j.debt||0,Real:p.debt||0},E=(z,L,G)=>{let I=z;G&&(I+=1e5);let V=(Math.abs(L)-I)/1e5;return V<0&&(V=0),5+Math.round(V)},$=E(x,f,u),F=E(y,d,i),w=l==="AEK"?$:F,m=h[t],A=h[l],s=Math.min(m,w*1),o=Math.max(0,m-s),b=w*1-s,v=A+Math.max(0,b),C=await D.select("finances","id",{eq:{team:t}});if(C.data&&C.data.length>0&&await D.update("finances",{debt:o},C.data[0].id),b>0){await this.insertTransaction({date:a,type:"Echtgeld-Ausgleich",team:l,amount:Math.max(0,b),match_id:r,info:"Echtgeld-Ausgleich"});const z=await D.select("finances","id",{eq:{team:l}});z.data&&z.data.length>0&&await D.update("finances",{debt:v},z.data[0].id)}s>0&&await this.insertTransaction({date:a,type:"Echtgeld-Ausgleich (getilgt)",team:t,amount:-s,match_id:r,info:"Echtgeld-Ausgleich (getilgt)"})}static async deleteMatchTransactions(a){try{await se(a)}catch(r){throw console.error(`Failed to delete match ${a} comprehensively:`,r),r}}static async decrementBansAfterMatch(){try{const a=await D.select("bans","*");if(!a.data)return;for(const r of a.data)if(r.matchesserved<r.totalgames){const t=r.matchesserved+1;await D.update("bans",{matchesserved:t},r.id)}}catch(a){console.warn("Failed to decrement bans:",a)}}}function Te(){const{data:n}=O("players","*"),[a,r]=T.useState(!1),[t,l]=T.useState({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),[x,y]=T.useState(!1),f=(s,o,b)=>s.reduce((C,z)=>C+z.count,0)+b,d=s=>{l(o=>{const b={...o,...s};b.goalsa=f(b.goalslista,b.ownGoalsA,b.ownGoalsB),b.goalsb=f(b.goalslistb,b.ownGoalsB,b.ownGoalsA);const{prizeaek:v,prizereal:C}=ce.calculatePrizeMoney(b.goalsa,b.goalsb,b.yellowa,b.reda,b.yellowb,b.redb);return b.prizeaek=v,b.prizereal=C,b})},u=(s,o)=>{d({[s]:o})},i=async s=>{s.preventDefault(),y(!0);try{const o=await ce.submitMatch({date:t.date,teama:t.teama.trim(),teamb:t.teamb.trim(),goalsa:t.goalsa,goalsb:t.goalsb,goalslista:t.goalslista,goalslistb:t.goalslistb,ownGoalsA:t.ownGoalsA,ownGoalsB:t.ownGoalsB,yellowa:parseInt(t.yellowa)||0,reda:parseInt(t.reda)||0,yellowb:parseInt(t.yellowb)||0,redb:parseInt(t.redb)||0,manofthematch:t.manofthematch||null});l({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),r(!1),R.success(o.message),P("match-created",{matchId:o.matchId||"latest",date:t.date,teama:t.teama,teamb:t.teamb,goalsa:t.goalsa,goalsb:t.goalsb,manofthematch:t.manofthematch})}catch(o){console.error("Match submission error:",o),R.error(o.message||"Fehler beim Hinzuf√ºgen des Spiels")}finally{y(!1)}},c=()=>{if(!t.date||t.goalsa===t.goalsb||t.goalsa===0&&t.goalsb===0||!t.manofthematch||t.manofthematch.trim()==="")return!1;if(t.goalsa>0){const s=t.goalslista.reduce((b,v)=>b+v.count,0),o=t.ownGoalsB||0;if(s+o<t.goalsa)return!1}if(t.goalsb>0){const s=t.goalslistb.reduce((b,v)=>b+v.count,0),o=t.ownGoalsA||0;if(s+o<t.goalsb)return!1}return!0},j=()=>{const s=[];if(t.date||s.push("Datum fehlt"),t.goalsa===0&&t.goalsb===0&&s.push("Mindestens ein Tor erforderlich"),t.goalsa===t.goalsb&&(t.goalsa>0||t.goalsb>0)&&s.push("Unentschieden nicht erlaubt"),(!t.manofthematch||t.manofthematch.trim()==="")&&s.push("Spieler des Spiels fehlt"),t.goalsa>0){const o=t.goalslista.reduce((v,C)=>v+C.count,0),b=t.ownGoalsB||0;o+b<t.goalsa&&s.push(`AEK Torsch√ºtzen fehlen (${o+b}/${t.goalsa})`)}if(t.goalsb>0){const o=t.goalslistb.reduce((v,C)=>v+C.count,0),b=t.ownGoalsA||0;o+b<t.goalsb&&s.push(`Real Torsch√ºtzen fehlen (${o+b}/${t.goalsb})`)}return{isValid:s.length===0,issues:s}},p=(s,o)=>{const b=Math.max(0,(t[s]||0)+o);d({[s]:b})},h=s=>n?n.filter(o=>o.team===s):[],E=()=>n?t.motmTeamFilter==="all"?n:n.filter(s=>s.team===t.motmTeamFilter):[],$=(s,o)=>{const b=s==="AEK"?"goalslista":"goalslistb";d({[b]:t[b].map(v=>v.player===o?{...v,count:v.count+1}:v).concat(t[b].find(v=>v.player===o)?[]:[{player:o,count:1}])})},F=(s,o)=>{const b=s==="AEK"?"goalslista":"goalslistb";d({[b]:t[b].map(v=>v.player===o?{...v,count:Math.max(0,v.count-1)}:v).filter(v=>v.count>0)})},w=(s,o)=>{const b=s==="AEK"?"ownGoalsA":"ownGoalsB",v=Math.max(0,t[b]+o);d({[b]:v})},m=(s,o)=>{if(!o)return;const b=s==="AEK"?"goalslista":"goalslistb",v=t[b].find(C=>C.player===o);d(v?{[b]:t[b].map(C=>C.player===o?{...C,count:C.count+1}:C)}:{[b]:[...t[b],{player:o,count:1}]})},A=(s,o)=>{const b=s==="AEK"?"goalslista":"goalslistb";d({[b]:t[b].filter(v=>v.player!==o)})};return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neues Spiel hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"F√ºgen Sie ein neues Spiel zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"‚öΩ"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Spiel hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um ein neues Spiel zu erfassen."}),e.jsxs("button",{onClick:()=>r(!0),className:"btn-primary inline-flex items-center px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neues Spiel erfassen"]})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center z-[60] p-2 sm:p-4 overflow-y-auto",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg w-full max-w-lg modal-content match-modal-content modal-mobile-safe my-4 sm:my-8",style:{maxHeight:"calc(100vh - 2rem)"},children:e.jsxs("div",{className:"p-4 sm:p-6 overflow-y-auto mobile-safe-bottom",style:{maxHeight:"calc(100vh - 4rem)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 sticky top-0 bg-bg-secondary z-10 pb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neues Spiel"}),e.jsx("button",{onClick:()=>r(!1),className:"text-text-secondary hover:text-text-primary text-2xl font-bold bg-bg-tertiary hover:bg-bg-hover rounded-full w-8 h-8 flex items-center justify-center transition-colors",disabled:x,children:"√ó"})]}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"‚öΩ Spielpaarung"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("div",{className:"bg-blue-100 text-blue-800 px-4 py-2 rounded-lg font-medium",children:"AEK Athen"}),e.jsx("div",{className:"text-gray-500 font-bold text-xl",children:"vs"}),e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded-lg font-medium",children:"Real Madrid"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:t.date,onChange:s=>u("date",s.target.value),className:"form-input",required:!0,disabled:x})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"‚öΩ Live Torwertung"}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-red-50 rounded-xl p-6 mb-4 text-center border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"text-4xl font-bold text-gray-800 mb-2",children:[e.jsx("span",{className:"text-blue-600",children:t.goalsa}),e.jsx("span",{className:"mx-4 text-gray-400",children:":"}),e.jsx("span",{className:"text-red-600",children:t.goalsb})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:[e.jsx("span",{className:"font-medium text-blue-700",children:"AEK Athen"}),e.jsx("span",{className:"mx-2",children:"vs"}),e.jsx("span",{className:"font-medium text-red-700",children:"Real Madrid"})]}),(t.goalsa>0||t.goalsb>0)&&e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:t.goalsa>t.goalsb?"üèÜ AEK f√ºhrt":t.goalsb>t.goalsa?"üèÜ Real f√ºhrt":"‚öñÔ∏è Unentschieden"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-blue-600 mb-3",children:"‚öΩ AEK Athen Torsch√ºtzen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslista.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.count," Tor",s.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>F("AEK",s.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:s.count}),e.jsx("button",{type:"button",onClick:()=>$("AEK",s.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"}),e.jsx("button",{type:"button",onClick:()=>A("AEK",s.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:x,title:"Torsch√ºtze entfernen",children:"‚úï"})]})]},`aek-${s.player}-${o}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:s=>{s.target.value&&(m("AEK",s.target.value),s.target.value="")},className:"w-full form-input bg-blue-100 border-blue-300 text-blue-800",disabled:x,children:[e.jsx("option",{value:"",children:"+ Torsch√ºtze hinzuf√ºgen"}),h("AEK").map(s=>e.jsxs("option",{value:s.name,children:[s.name," (",s.position,")"]},s.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Z√§hlen f√ºr Real Madrid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>w("AEK",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.ownGoalsA===0,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsA}),e.jsx("button",{type:"button",onClick:()=>w("AEK",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-red-600 mb-3",children:"‚öΩ Real Madrid Torsch√ºtzen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslistb.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between bg-red-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.count," Tor",s.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>F("Real",s.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:s.count}),e.jsx("button",{type:"button",onClick:()=>$("Real",s.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"}),e.jsx("button",{type:"button",onClick:()=>A("Real",s.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:x,title:"Torsch√ºtze entfernen",children:"‚úï"})]})]},`real-${s.player}-${o}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:s=>{s.target.value&&(m("Real",s.target.value),s.target.value="")},className:"w-full form-input bg-red-100 border-red-300 text-red-800",disabled:x,children:[e.jsx("option",{value:"",children:"+ Torsch√ºtze hinzuf√ºgen"}),h("Real").map(s=>e.jsxs("option",{value:s.name,children:[s.name," (",s.position,")"]},s.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Z√§hlen f√ºr AEK Athen"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>w("Real",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.ownGoalsB===0,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsB}),e.jsx("button",{type:"button",onClick:()=>w("Real",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"üü®üü• Karten"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"AEK Athen"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü® Gelbe Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-yellow-50 border border-yellow-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>p("yellowa",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.yellowa<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:t.yellowa}),e.jsx("button",{type:"button",onClick:()=>p("yellowa",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü• Rote Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-red-50 border border-red-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>p("reda",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.reda<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:t.reda}),e.jsx("button",{type:"button",onClick:()=>p("reda",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Real Madrid"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü® Gelbe Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-yellow-50 border border-yellow-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>p("yellowb",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.yellowb<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:t.yellowb}),e.jsx("button",{type:"button",onClick:()=>p("yellowb",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü• Rote Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-red-50 border border-red-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>p("redb",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.redb<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:t.redb}),e.jsx("button",{type:"button",onClick:()=>p("redb",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"‚≠ê Spieler des Spiels"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-text-muted mb-2",children:"Team Filter:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>u("motmTeamFilter","all"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="all"?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:x,children:"Alle"}),e.jsx("button",{type:"button",onClick:()=>u("motmTeamFilter","AEK"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="AEK"?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:x,children:"AEK"}),e.jsx("button",{type:"button",onClick:()=>u("motmTeamFilter","Real"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="Real"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,disabled:x,children:"Real"})]})]}),e.jsxs("select",{value:t.manofthematch,onChange:s=>u("manofthematch",s.target.value),className:"form-input",disabled:x,children:[e.jsx("option",{value:"",children:"Keinen Spieler ausw√§hlen"}),E().map(s=>e.jsxs("option",{value:s.name,children:[s.name," (",s.team," - ",s.position,")"]},s.id))]}),!n||n.length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler verf√ºgbar. Bitte f√ºgen Sie erst Spieler hinzu."})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"üí∞ Preisgelder (automatisch berechnet)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld AEK (‚Ç¨)"}),e.jsx("input",{type:"number",value:t.prizeaek,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld Real (‚Ç¨)"}),e.jsx("input",{type:"number",value:t.prizereal,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]})]}),e.jsx("p",{className:"text-xs text-text-muted mt-2",children:"Basierend auf Ergebnis und Karten: Gewinner 1M‚Ç¨ - (Verlierer-Tore √ó 50k‚Ç¨) - (Karten √ó 20k‚Ç¨/50k‚Ç¨)"})]}),t.goalsa===t.goalsb&&(t.goalsa>0||t.goalsb>0)&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 mr-2",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-red-800",children:"Unentschieden nicht erlaubt"}),e.jsx("p",{className:"text-sm text-red-700",children:"Ein Team muss gewinnen. Unentschieden sind in dieser App nicht m√∂glich."})]})]})}),!t.manofthematch&&(t.goalsa>0||t.goalsb>0)&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-yellow-600 mr-2",children:"‚≠ê"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-yellow-800",children:"Spieler des Spiels erforderlich"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Bitte w√§hlen Sie einen Spieler des Spiels aus, bevor Sie das Match speichern."})]})]})}),c()&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-green-800 mb-3 flex items-center",children:[e.jsx("i",{className:"fas fa-check-circle mr-2"}),"Spiel-Zusammenfassung"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Datum:"}),e.jsx("span",{className:"font-medium text-green-800",children:new Date(t.date).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Ergebnis:"}),e.jsxs("span",{className:"font-medium text-green-800",children:["AEK ",t.goalsa," : ",t.goalsb," Real"]})]}),t.manofthematch&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Spieler des Spiels:"}),e.jsx("span",{className:"font-medium text-green-800",children:t.manofthematch})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Preisgelder:"}),e.jsxs("span",{className:"font-medium text-green-800",children:["AEK ",t.prizeaek.toLocaleString(),"‚Ç¨, Real ",t.prizereal.toLocaleString(),"‚Ç¨"]})]})]})]}),!c()&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-2 mt-1",children:"‚ö†Ô∏è"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-red-800 mb-1",children:"Formular unvollst√§ndig"}),e.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:j().issues.map((s,o)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:"‚Ä¢"}),e.jsx("span",{children:s})]},o))})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4 pb-20 sm:pb-4",children:[e.jsx("button",{type:"button",onClick:()=>r(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:x,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:x||!c(),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${c()?"bg-green-600 hover:bg-green-700 text-white":"bg-red-500 text-white cursor-not-allowed opacity-75"} ${x?"opacity-50 cursor-not-allowed":""}`,children:x?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):c()?"‚úÖ Spiel speichern":`‚ùå ${j().issues[0]||"Eingaben unvollst√§ndig"}`})]})]})]})})})]})}const _=[{value:"AEK",label:"AEK Athen",color:"blue",icon:"aek"},{value:"Real",label:"Real Madrid",color:"red",icon:"real"},{value:"Ehemalige",label:"Ehemalige",color:"gray",icon:"‚ö´"}],W=n=>{const a=_.find(r=>r.value===n);return a?a.label:n};function De(){const{data:n}=O("players","*"),[a,r]=T.useState(!1),[t,l]=T.useState(""),[x,y]=T.useState({player_id:"",type:"",reason:"",customDuration:1}),[f,d]=T.useState(!1),u=(h,E)=>{y($=>({...$,[h]:E})),h==="team"&&y($=>({...$,player_id:""}))},i=()=>!n||!t?[]:n.filter(h=>h.team===t),c=async h=>{var E;h.preventDefault(),d(!0);try{const $=n==null?void 0:n.find(o=>o.id===parseInt(x.player_id)),F=Z.find(o=>o.value===x.type);if(!$)throw new Error("Spieler nicht gefunden");if(!F)throw new Error("Sperrart nicht gefunden");const m=(E=(await D.select("bans","*",{eq:{player_id:$.id}})).data)==null?void 0:E.find(o=>(o.matchesserved||0)<(o.totalgames||0));if(m)throw new Error(`Spieler "${$.name}" ist bereits gesperrt (${m.totalgames-m.matchesserved} Spiele verbleibend)`);const A=F.fixedDuration?F.duration:x.customDuration,s=await D.insert("bans",{player_id:$.id,team:$.team,type:F.value,totalgames:A,matchesserved:0,reason:x.reason||F.value});if(s.error)throw new Error(`Ban insert failed: ${s.error.message}`);y({player_id:"",type:"",reason:"",customDuration:1}),l(""),r(!1),R.success(`Sperre f√ºr "${$.name}" erfolgreich hinzugef√ºgt!`)}catch($){console.error("Ban submission error:",$),R.error($.message||"Fehler beim Hinzuf√ºgen der Sperre")}finally{d(!1)}},j=t&&x.player_id&&x.type,p=Z.find(h=>h.value===x.type);return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Sperre hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erstellen Sie eine neue Spielersperre in der Datenbank."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üö´"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Sperre hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Spielersperre zu erfassen."}),e.jsxs("button",{onClick:()=>r(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre erfassen"]})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Sperre"}),e.jsx("button",{onClick:()=>r(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:f,children:"√ó"})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:t,onChange:h=>{l(h.target.value),y(E=>({...E,player_id:""}))},className:"form-input",required:!0,disabled:f,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),_.filter(h=>h.value!=="Ehemalige").map(h=>e.jsx("option",{value:h.value,children:W(h.value)},h.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spieler *"}),e.jsxs("select",{value:x.player_id,onChange:h=>u("player_id",h.target.value),className:"form-input",required:!0,disabled:f||!t,children:[e.jsx("option",{value:"",children:t?"Spieler w√§hlen":"Bitte zuerst Team w√§hlen"}),i().map(h=>e.jsxs("option",{value:h.id,children:[h.name," (",h.position,")"]},h.id))]}),t&&i().length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler im gew√§hlten Team verf√ºgbar."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Sperrart *"}),e.jsxs("select",{value:x.type,onChange:h=>u("type",h.target.value),className:"form-input",required:!0,disabled:f,children:[e.jsx("option",{value:"",children:"Sperrart w√§hlen"}),Z.map(h=>e.jsxs("option",{value:h.value,children:[h.icon," ",h.label,h.fixedDuration?` (${h.duration} Spiel${h.duration!==1?"e":""})`:` (1-${h.maxDuration} Spiele)`]},h.value))]})]}),p&&!p.fixedDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Spiele *"}),e.jsx("select",{value:x.customDuration,onChange:h=>u("customDuration",parseInt(h.target.value)),className:"form-input",required:!0,disabled:f,children:Array.from({length:p.maxDuration},(h,E)=>E+1).map(h=>e.jsxs("option",{value:h,children:[h," Spiel",h!==1?"e":""]},h))}),e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["W√§hlen Sie zwischen ",p.minDuration," und ",p.maxDuration," Spielen"]})]}),p&&p.fixedDuration&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Gelb-Rote Karten haben immer eine feste Sperre von 1 Spiel."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zus√§tzlicher Grund (optional)"}),e.jsx("input",{type:"text",value:x.reason,onChange:h=>u("reason",h.target.value),className:"form-input",placeholder:"Weitere Details zur Sperre...",disabled:f})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>r(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:f,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!j||f||!n||n.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Sperrarten"}),e.jsx("div",{className:"space-y-2",children:Z.map(h=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:h.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:h.label})]}),e.jsx("span",{className:"text-sm text-text-muted",children:h.fixedDuration?`${h.duration} Spiel${h.duration!==1?"e":""} (fest)`:`1-${h.maxDuration} Spiele (variabel)`})]},h.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-yellow-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie die Sperre in der Sperren-√úbersicht einsehen und verwalten."})]})]})})]})}const de=[{value:"TH",label:"Torwart (TH)"},{value:"IV",label:"Innenverteidiger (IV)"},{value:"AV",label:"Au√üenverteidiger (AV)"},{value:"ZM",label:"Zentrales Mittelfeld (ZM)"},{value:"OM",label:"Offensives Mittelfeld (OM)"},{value:"ST",label:"St√ºrmer (ST)"}];function $e(){const[n,a]=T.useState(!1),[r,t]=T.useState({name:"",team:"",position:"",goals:0,value:0}),[l,x]=T.useState(!1),y=(u,i)=>{t(c=>({...c,[u]:i}))},f=async u=>{u.preventDefault(),x(!0);try{const i=await D.select("players","*",{eq:{name:r.name.trim(),team:r.team.trim()}});if(i.data&&i.data.length>0)throw new Error(`Spieler "${r.name}" existiert bereits im Team "${r.team}"`);const c=await D.insert("players",{name:r.name.trim(),team:r.team.trim(),position:r.position.trim().toUpperCase(),goals:parseInt(r.goals)||0,value:parseFloat(r.value)||0});if(c.error)throw new Error(`Player insert failed: ${c.error.message}`);t({name:"",team:"",position:"",goals:0,value:0}),a(!1),R.success(`Spieler "${r.name}" erfolgreich hinzugef√ºgt!`)}catch(i){console.error("Player submission error:",i),R.error(i.message||"Fehler beim Hinzuf√ºgen des Spielers")}finally{x(!1)}},d=r.name&&r.team&&r.position&&r.value!=="";return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neuen Spieler hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"F√ºgen Sie einen neuen Spieler zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üë§"}),e.jsxs("h4",{className:"text-lg font-medium text-text-primary mb-2",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Spieler hinzuf√ºgen"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um einen neuen Spieler zu erfassen."}),e.jsxs("button",{onClick:()=>a(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neuen Spieler erfassen"]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neuer Spieler"}),e.jsx("button",{onClick:()=>a(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:l,children:"√ó"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spielername *"}),e.jsx("input",{type:"text",value:r.name,onChange:u=>y("name",u.target.value),className:"form-input",placeholder:"z.B. Max Mustermann",required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:r.team,onChange:u=>y("team",u.target.value),className:"form-input",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),_.map(u=>e.jsx("option",{value:u.value,children:W(u.value)},u.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position *"}),e.jsxs("select",{value:r.position,onChange:u=>y("position",u.target.value),className:"form-input",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Position w√§hlen"}),de.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Marktwert (Millionen ‚Ç¨) *"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:r.value,onChange:u=>y("value",u.target.value),onFocus:u=>u.target.select(),className:"form-input",placeholder:"0.0",disabled:l}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Marktwert in Millionen Euro (z.B. 1.5 f√ºr 1.5M ‚Ç¨)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Tore"}),e.jsx("input",{type:"number",min:"0",value:r.goals,onChange:u=>y("goals",u.target.value),onFocus:u=>u.target.select(),className:"form-input",placeholder:"0",disabled:l})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:l,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!d||l,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Teams"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:_.map(u=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${u.color==="blue"?"text-blue-600":u.color==="red"?"text-red-600":"text-gray-600"}`,children:W(u.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",u.value,")"]})]},u.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Positionen"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:de.map(u=>e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:e.jsx("span",{className:"font-medium text-text-primary text-sm",children:u.label})},u.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-green-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie den Spieler in der Kader-√úbersicht einsehen und verwalten."})]})]})})]})}const me=[{value:"Preisgeld",label:"Preisgeld",icon:"üèÜ"},{value:"Strafe",label:"Strafe",icon:"üìâ"},{value:"Spielerkauf",label:"Spielerkauf",icon:"üë§"},{value:"Spielerverkauf",label:"Spielerverkauf",icon:"üí∞"},{value:"Echtgeld-Ausgleich",label:"Echtgeld-Ausgleich",icon:"üí≥"},{value:"SdS Bonus",label:"Spieler des Spiels Bonus",icon:"‚≠ê"},{value:"Sonstiges",label:"Sonstiges",icon:"üìà"}];function Be(){const[n,a]=T.useState(!1),[r,t]=T.useState({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),[l,x]=T.useState(!1),y=(i,c)=>{t(j=>({...j,[i]:c}))},f=async i=>{i.preventDefault(),x(!0);try{const c=parseFloat(r.amount),j=await D.insert("transactions",{date:r.date,type:r.type.trim(),team:r.team.trim(),amount:c,info:r.info.trim(),match_id:null});if(j.error)throw new Error(`Transaction insert failed: ${j.error.message}`);await d(r.team.trim(),r.type.trim(),c),t({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),a(!1),R.success("Transaktion erfolgreich hinzugef√ºgt!")}catch(c){console.error("Transaction submission error:",c),R.error(c.message||"Fehler beim Hinzuf√ºgen der Transaktion")}finally{x(!1)}},d=async(i,c,j)=>{try{const p=await D.select("finances","*",{eq:{team:i}});let h=p.data&&p.data.length>0?p.data[0]:{team:i,balance:0,debt:0},E={};if(c==="Echtgeld-Ausgleich")E.debt=(h.debt||0)+j;else{let $=(h.balance||0)+j;$<0&&($=0),E.balance=$}h.id?await D.update("finances",E,h.id):await D.insert("finances",{team:i,balance:E.balance||0,debt:E.debt||0})}catch(p){console.warn("Failed to update finances:",p)}},u=r.team&&r.type&&r.amount&&r.date;return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Transaktion hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erfassen Sie eine neue finanzielle Transaktion."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üí∞"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Transaktion hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Transaktion zu erfassen."}),e.jsxs("button",{onClick:()=>a(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Transaktion erfassen"]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Transaktion"}),e.jsx("button",{onClick:()=>a(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:l,children:"√ó"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:r.team,onChange:i=>y("team",i.target.value),className:"form-input",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),_.filter(i=>i.value!=="Ehemalige").map(i=>e.jsx("option",{value:i.value,children:W(i.value)},i.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Transaktionsart *"}),e.jsxs("select",{value:r.type,onChange:i=>y("type",i.target.value),className:"form-input",required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Typ w√§hlen"}),me.map(i=>e.jsxs("option",{value:i.value,children:[i.icon," ",i.label]},i.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Betrag (‚Ç¨) *"}),e.jsx("input",{type:"number",step:"0.01",value:r.amount,onChange:i=>y("amount",i.target.value),onFocus:i=>i.target.select(),className:"form-input",placeholder:"0.00",required:!0,disabled:l}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Negative Werte f√ºr Ausgaben, positive f√ºr Einnahmen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Beschreibung"}),e.jsx("input",{type:"text",value:r.info,onChange:i=>y("info",i.target.value),className:"form-input",placeholder:"Zus√§tzliche Informationen...",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:r.date,onChange:i=>y("date",i.target.value),className:"form-input",required:!0,disabled:l})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:l,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!u||l,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Transaktionsarten"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:me.map(i=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:i.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:i.label})]},i.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Teams"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:_.filter(i=>i.value!=="Ehemalige").map(i=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${i.color==="blue"?"text-blue-600":"text-red-600"}`,children:W(i.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",i.value,")"]})]},i.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie die Transaktion in der Finanzen-√úbersicht einsehen."})]})]})})]})}function Me(){var ie;const[n,a]=T.useState("players"),[r,t]=T.useState(!1),[l,x]=T.useState(""),[y,f]=T.useState(new Set),{data:d,refetch:u}=O("players","*",{order:{column:"id",ascending:!1}}),{data:i,refetch:c}=O("matches","*",{order:{column:"date",ascending:!1}}),{data:j,refetch:p}=O("bans","*",{order:{column:"id",ascending:!1}}),{data:h,refetch:E}=O("transactions","*",{order:{column:"date",ascending:!1}}),{remove:$}=te("players"),{remove:F}=te("bans"),{remove:w}=te("transactions"),m=[{id:"players",label:"Spieler l√∂schen",icon:"fas fa-users"},{id:"matches",label:"Spiele l√∂schen (Einzel & Bulk)",icon:"fas fa-futbol"},{id:"bans",label:"Sperren l√∂schen",icon:"fas fa-ban"},{id:"transactions",label:"Transaktionen l√∂schen",icon:"fas fa-euro-sign"}],A=g=>{a(g),x(""),f(new Set)},s=(g,S)=>{const k=new Set(y);S?k.add(g):k.delete(g),f(k)},o=g=>{const S=X(g);y.size===S.length?f(new Set):f(new Set(S.map(k=>k.id)))},b=async()=>{if(y.size===0){R.error("Keine Spiele ausgew√§hlt");return}const S=((i==null?void 0:i.filter(M=>y.has(M.id)))||[]).reduce((M,H)=>M+((h==null?void 0:h.filter(ee=>ee.match_id===H.id).length)||0),0);let k=`Sind Sie sicher, dass Sie ${y.size} ausgew√§hlte Spiele l√∂schen m√∂chten?`;if(S>0&&(k+=`

Achtung: ${S} zugeh√∂rige Transaktion(en) werden ebenfalls gel√∂scht.`),k+=`

Dieser Vorgang kann nicht r√ºckg√§ngig gemacht werden!`,!confirm(k))return;t(!0);let N=0,B=0;try{for(const M of y)try{console.log(`Deleting match ${M}`),await se(M),N++}catch(H){console.error(`Failed to delete match ${M}:`,H),B++}f(new Set),N>0&&B===0?R.success(`Alle ${N} Spiele erfolgreich gel√∂scht`):N>0&&B>0?R.success(`${N} Spiele gel√∂scht, ${B} fehlgeschlagen`):R.error(`Alle ${B} L√∂schvorg√§nge fehlgeschlagen`),c(),E(),setTimeout(()=>{c(),E()},1e3)}catch(M){console.error("Bulk delete error:",M),R.error("Fehler beim Bulk-L√∂schen: "+M.message),f(new Set)}finally{t(!1)}},v=()=>{switch(n){case"players":return{total:(d==null?void 0:d.length)||0,filtered:V(d).length};case"matches":return{total:(i==null?void 0:i.length)||0,filtered:X(i).length};case"bans":return{total:(j==null?void 0:j.length)||0,filtered:re(j).length};case"transactions":return{total:(h==null?void 0:h.length)||0,filtered:ne(h).length};default:return{total:0,filtered:0}}},C=async g=>{const S=(j==null?void 0:j.filter(N=>N.player_id===g.id||N.player_name===g.name))||[];let k=`Sind Sie sicher, dass Sie ${g.name} (${g.team}) l√∂schen m√∂chten?`;if(S.length>0&&(k+=`

Achtung: ${S.length} zugeh√∂rige Sperre(n) werden ebenfalls gel√∂scht.`),g.goals&&g.goals>0&&(k+=`
Der Spieler hat ${g.goals} Tor(e) erzielt.`),!!confirm(k)){t(!0);try{await $(g.id),R.success(`Spieler ${g.name} erfolgreich gel√∂scht`),u(),S.length>0&&p()}catch(N){R.error("Fehler beim L√∂schen des Spielers: "+N.message)}finally{t(!1)}}},z=async g=>{const S=(h==null?void 0:h.filter(B=>B.match_id===g.id))||[],k=`AEK ${g.goalsa||0} - ${g.goalsb||0} Real`;let N=`Sind Sie sicher, dass Sie das Spiel vom ${new Date(g.date).toLocaleDateString("de-DE")} (${k}) l√∂schen m√∂chten?`;if(S.length>0&&(N+=`

Achtung: ${S.length} zugeh√∂rige Transaktion(en) werden ebenfalls gel√∂scht.`),g.manofthematch&&(N+=`
Spieler des Spiels: ${g.manofthematch}`),!!confirm(N)){t(!0);try{console.log(`Attempting to delete match ${g.id}`),await se(g.id),console.log(`Successfully deleted match ${g.id}`),R.success("Spiel erfolgreich gel√∂scht"),c(),E(),setTimeout(()=>{c(),E()},1e3)}catch(B){console.error("Error deleting match:",B);let M="Fehler beim L√∂schen des Spiels: ";B.message.includes("not found")?M+=`Spiel mit ID ${g.id} wurde nicht in der Datenbank gefunden. M√∂glicherweise wurde es bereits gel√∂scht.`:B.message.includes("Invalid match ID")?M+=`Ung√ºltige Spiel-ID: ${g.id}`:B.message.includes("fetch failed")||B.message.includes("network")?M+="Netzwerkfehler. Bitte √ºberpr√ºfen Sie Ihre Internetverbindung.":M+=B.message,R.error(M)}finally{t(!1)}}},L=async g=>{var B;const S=g.player_name||(g.player_id&&d?(B=d.find(M=>M.id===g.player_id))==null?void 0:B.name:"Unbekannter Spieler"),k=Math.max(0,(g.totalgames||0)-(g.matchesserved||0));let N=`Sind Sie sicher, dass Sie die Sperre f√ºr ${S} l√∂schen m√∂chten?`;if(N+=`
Sperrtyp: ${g.type}`,k>0?N+=`
Noch ${k} Spiel(e) verbleibend`:N+=`
Sperre bereits abgesessen`,g.reason&&(N+=`
Grund: ${g.reason}`),!!confirm(N)){t(!0);try{await F(g.id),R.success(`Sperre f√ºr ${S} erfolgreich gel√∂scht`),p()}catch(M){R.error("Fehler beim L√∂schen der Sperre: "+M.message)}finally{t(!1)}}},G=async g=>{const S=g.match_id&&i?i.find(N=>N.id===g.match_id):null;let k=`Sind Sie sicher, dass Sie die Transaktion "${g.type}" l√∂schen m√∂chten?`;if(k+=`
Betrag: ${g.amount>0?"+":""}${g.amount}M ‚Ç¨ (${g.team})`,g.date&&(k+=`
Datum: ${new Date(g.date).toLocaleDateString("de-DE")}`),g.info&&(k+=`
Info: ${g.info}`),S&&(k+=`
Zugeh√∂riges Spiel: ${new Date(S.date).toLocaleDateString("de-DE")} (AEK ${S.goalsa||0} - ${S.goalsb||0} Real)`),!!confirm(k)){t(!0);try{await w(g.id),R.success("Transaktion erfolgreich gel√∂scht"),E()}catch(N){R.error("Fehler beim L√∂schen der Transaktion: "+N.message)}finally{t(!1)}}},I=g=>{const S=_.find(k=>k.value===g);return S?S.icon:"‚ö´"},V=g=>l?(g||[]).filter(S=>{var k,N,B;return((k=S.name)==null?void 0:k.toLowerCase().includes(l.toLowerCase()))||((N=S.team)==null?void 0:N.toLowerCase().includes(l.toLowerCase()))||((B=S.position)==null?void 0:B.toLowerCase().includes(l.toLowerCase()))}):g||[],X=g=>l?(g||[]).filter(S=>{var k;return new Date(S.date).toLocaleDateString("de-DE").includes(l)||((k=S.manofthematch)==null?void 0:k.toLowerCase().includes(l.toLowerCase()))}):g||[],re=g=>l?(g||[]).filter(S=>{var N,B,M,H;const k=S.player_name||(S.player_id&&d?(N=d.find(ee=>ee.id===S.player_id))==null?void 0:N.name:"");return(k==null?void 0:k.toLowerCase().includes(l.toLowerCase()))||((B=S.type)==null?void 0:B.toLowerCase().includes(l.toLowerCase()))||((M=S.team)==null?void 0:M.toLowerCase().includes(l.toLowerCase()))||((H=S.reason)==null?void 0:H.toLowerCase().includes(l.toLowerCase()))}):g||[],ne=g=>l?(g||[]).filter(S=>{var k,N,B,M;return((k=S.type)==null?void 0:k.toLowerCase().includes(l.toLowerCase()))||((N=S.team)==null?void 0:N.toLowerCase().includes(l.toLowerCase()))||((B=S.info)==null?void 0:B.toLowerCase().includes(l.toLowerCase()))||((M=S.amount)==null?void 0:M.toString().includes(l))}):g||[],le=()=>{const g=V(d);return!g||g.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:l?"Keine Spieler gefunden":"Keine Spieler vorhanden"}):e.jsx("div",{className:"space-y-2",children:g.map(S=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:I(S.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:S.name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[S.team," ‚Ä¢ ",S.position,S.goals!==void 0&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ ",S.goals," Tore"]})]})]})]}),e.jsxs("button",{onClick:()=>C(S),disabled:r,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},S.id))})},fe=()=>{const g=X(i);if(!g||g.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:l?"Keine Spiele gefunden":"Keine Spiele vorhanden"});const S=g.length>0&&g.every(N=>y.has(N.id)),k=y.size>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-secondary rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:()=>o(i),className:"w-4 h-4 text-accent-primary focus:ring-accent-primary border-gray-300 rounded"}),e.jsxs("span",{className:"text-sm text-text-primary",children:[S?"Alle abw√§hlen":"Alle ausw√§hlen"," (",g.length,")"]})]}),y.size>0&&e.jsxs("span",{className:"text-sm text-accent-primary font-medium",children:[y.size," ausgew√§hlt"]})]}),k&&e.jsxs("button",{onClick:b,disabled:r,className:"btn-primary btn-sm bg-red-600 hover:bg-red-700 text-white disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),y.size," Spiele l√∂schen"]})]}),e.jsx("div",{className:"space-y-2",children:g.map(N=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("label",{className:"flex items-center cursor-pointer",children:e.jsx("input",{type:"checkbox",checked:y.has(N.id),onChange:B=>s(N.id,B.target.checked),className:"w-4 h-4 text-accent-primary focus:ring-accent-primary border-gray-300 rounded"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-text-primary",children:["ID ",N.id," ‚Ä¢ ",new Date(N.date).toLocaleDateString("de-DE")]}),e.jsxs("p",{className:"text-sm text-text-muted",children:["AEK ",N.goalsa||0," - ",N.goalsb||0," Real"]}),N.manofthematch&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:[e.jsx("i",{className:"fas fa-star mr-1"}),"SdS: ",N.manofthematch]})]}),e.jsxs("button",{onClick:()=>z(N),disabled:r,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Einzeln l√∂schen"]})]})})]},N.id))})]})},pe=()=>{const g=re(j);if(!g||g.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:l?"Keine Sperren gefunden":"Keine Sperren vorhanden"});const S=N=>{if(N.player_name)return N.player_name;if(N.player_id&&d){const B=d.find(M=>M.id===N.player_id);return B?B.name:"Unbekannter Spieler"}return"Unbekannter Spieler"},k=N=>{const B=(N.totalgames||0)-(N.matchesserved||0);return Math.max(0,B)};return e.jsx("div",{className:"space-y-2",children:g.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:I(N.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:S(N)}),e.jsxs("p",{className:"text-sm text-text-muted",children:[N.type," ‚Ä¢ ",N.totalgames||0," Spiele",k(N)>0?` (${k(N)} verbleibend)`:" (abgesessen)"]}),N.reason&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Grund: ",N.reason]})]})]}),e.jsxs("button",{onClick:()=>L(N),disabled:r,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},N.id))})},ye=()=>{const g=ne(h);if(!g||g.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:l?"Keine Transaktionen gefunden":"Keine Transaktionen vorhanden"});const S=k=>{if(!k.match_id||!i)return null;const N=i.find(B=>B.id===k.match_id);return N?`Match: ${new Date(N.date).toLocaleDateString("de-DE")} (AEK ${N.goalsa||0} - ${N.goalsb||0} Real)`:null};return e.jsx("div",{className:"space-y-2",children:g.map(k=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:I(k.team)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:k.type}),e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsxs("span",{className:k.amount>0?"text-green-600":"text-red-600",children:[k.amount>0?"+":"",k.amount,"M ‚Ç¨"]}),k.date&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ ",new Date(k.date).toLocaleDateString("de-DE")]})]}),k.info&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:k.info}),S(k)&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[e.jsx("i",{className:"fas fa-futbol mr-1"}),S(k)]})]})]}),e.jsxs("button",{onClick:()=>G(k),disabled:r,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},k.id))})},je=()=>{switch(n){case"players":return le();case"matches":return fe();case"bans":return pe();case"transactions":return ye();default:return le()}};return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Daten l√∂schen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Verwalten Sie die L√∂schung von Spielern, Spielen, Sperren und Transaktionen."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-6",children:m.map(g=>e.jsxs("button",{onClick:()=>A(g.id),className:`p-3 rounded-lg text-sm font-medium transition-colors ${n===g.id?"bg-accent-red text-white":"bg-bg-tertiary text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${g.icon} mr-2`}),g.label]},g.id))}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:`${(ie=m.find(g=>g.id===n))==null?void 0:ie.label.replace(" l√∂schen","")} durchsuchen...`,value:l,onChange:g=>x(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent-red focus:border-transparent text-text-primary bg-bg-secondary"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"fas fa-search text-text-muted"})}),l&&e.jsx("button",{onClick:()=>x(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-text-muted hover:text-text-primary",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[l&&e.jsxs("p",{className:"text-xs text-text-muted",children:[e.jsx("i",{className:"fas fa-filter mr-1"}),"Gefiltert nach: ‚Äú",l,"‚Äù"]}),e.jsx("p",{className:"text-xs text-text-muted ml-auto",children:(()=>{const g=v();return l?`${g.filtered} von ${g.total} Eintr√§gen`:`${g.total} Eintr√§ge`})()})]})]}),e.jsxs("div",{className:"modern-card",children:[r&&e.jsx(ge,{message:"L√∂sche..."}),!r&&je()]}),e.jsx("div",{className:"mt-6 modern-card bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-3",children:e.jsx("i",{className:"fas fa-exclamation-triangle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Achtung"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Das L√∂schen von Daten ist permanent und kann nicht r√ºckg√§ngig gemacht werden. Bitte √ºberpr√ºfen Sie Ihre Auswahl sorgf√§ltig, bevor Sie fortfahren."})]})]})})]})}function Fe({data:n=[],searchFields:a=[],filterOptions:r=[],onResults:t,placeholder:l="Suchen...",showCount:x=!0,searchExtractor:y}){const[f,d]=T.useState(""),[u,i]=T.useState({}),[c,j]=T.useState(""),[p,h]=T.useState("asc"),E=T.useRef(null),$=T.useMemo(()=>{let s=[...n];if(f.trim()){const o=f.toLowerCase().trim();s=s.filter(b=>{if(y){const v=y(b);return v&&v.toLowerCase().includes(o)}return a.some(v=>{const C=Y(b,v);return C&&C.toString().toLowerCase().includes(o)})})}return Object.entries(u).forEach(([o,b])=>{if(b&&b!=="all"){const v=r.find(C=>C.key===o);v&&v.filterFn?s=s.filter(C=>v.filterFn(C,b)):s=s.filter(C=>Y(C,o)===b)}}),c&&s.sort((o,b)=>{const v=Y(o,c),C=Y(b,c);let z=0;return typeof v=="number"&&typeof C=="number"?z=v-C:v instanceof Date&&C instanceof Date?z=v.getTime()-C.getTime():z=String(v).localeCompare(String(C)),p==="desc"?-z:z}),s},[n,f,u,c,p,a,r,y]);T.useEffect(()=>{t&&JSON.stringify($)!==E.current&&(E.current=JSON.stringify($),t($))},[$,t]);const F=(s,o)=>{i(b=>({...b,[s]:o}))},w=s=>{c===s?h(p==="asc"?"desc":"asc"):(j(s),h("asc"))},m=()=>{d(""),i({}),j(""),h("asc")},A=f||Object.values(u).some(s=>s&&s!=="all")||c;return e.jsxs("div",{className:"bg-bg-primary border border-border-light rounded-lg shadow-sm mb-4",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center",children:e.jsx("span",{className:"text-text-secondary","aria-hidden":"true",children:"üîç"})}),e.jsx("input",{type:"text",value:f,onChange:s=>d(s.target.value),placeholder:`${l} (Strg+K f√ºr globale Suche)`,className:"w-full pl-10 pr-20 py-2 bg-bg-secondary border border-border-light rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:ring-2 focus:ring-primary-green focus:border-transparent"}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center gap-1 pr-3",children:[e.jsx("button",{onClick:()=>{const s=new CustomEvent("global-search-toggle");window.dispatchEvent(s)},className:"text-text-secondary hover:text-primary-green transition-colors p-1 rounded",title:"Globale Suche √∂ffnen (Strg+K)",children:e.jsx("span",{"aria-hidden":"true",children:"üåê"})}),f&&e.jsx("button",{onClick:()=>d(""),className:"text-text-secondary hover:text-text-primary transition-colors p-1 rounded",title:"Suchfeld leeren",children:e.jsx("span",{"aria-hidden":"true",children:"‚úï"})})]})]})}),(r.length>0||c)&&e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[r.map(s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-sm font-medium text-text-primary",children:[s.label,":"]}),e.jsxs("select",{value:u[s.key]||"",onChange:o=>F(s.key,o.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Alle"}),s.options.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]})]},s.key)),a.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sortieren:"}),e.jsxs("select",{value:c,onChange:s=>j(s.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Standard"}),a.map(s=>e.jsx("option",{value:s,children:ue(s)},s))]}),c&&e.jsx("button",{onClick:()=>w(c),className:"px-2 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary hover:bg-bg-tertiary transition-colors duration-200",title:`Sortierung: ${p==="asc"?"Aufsteigend":"Absteigend"}`,children:p==="asc"?"‚Üë":"‚Üì"})]}),A&&e.jsx("button",{onClick:m,className:"px-3 py-1 bg-red-100 text-red-800 border border-red-200 rounded text-sm hover:bg-red-200 transition-colors duration-200",children:"Filter zur√ºcksetzen"})]})}),x&&e.jsx("div",{className:"px-4 py-2 bg-bg-secondary border-b border-border-light",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:$.length===n.length?`${n.length} Eintr√§ge`:`${$.length} von ${n.length} Eintr√§gen`}),A&&e.jsxs("div",{className:"flex items-center gap-2",children:[f&&e.jsxs("span",{className:"bg-primary-green bg-opacity-10 text-primary-green px-2 py-1 rounded text-xs",children:['üîç "',f,'"']}),Object.entries(u).filter(([,s])=>s&&s!=="all").map(([s,o])=>{const b=r.find(C=>C.key===s),v=b==null?void 0:b.options.find(C=>C.value===o);return e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:[b==null?void 0:b.label,": ",(v==null?void 0:v.label)||o]},s)}),c&&e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs",children:["üìä ",ue(c)," ",p==="asc"?"‚Üë":"‚Üì"]})]})]})})]})}function Y(n,a){return!n||!a?"":a.split(".").reduce((r,t)=>r&&r[t]!==void 0?r[t]:"",n)}function ue(n){return{name:"Name",team:"Team",position:"Position",value:"Wert",date:"Datum",goalsa:"AEK Tore",goalsb:"Real Tore",type:"Typ",amount:"Betrag",description:"Beschreibung",totalgames:"Gesamt Spiele",matchesserved:"Gespielte Spiele"}[n]||n.charAt(0).toUpperCase()+n.slice(1)}function he({onNavigate:n}){const[a,r]=T.useState("players"),[t,l]=T.useState([]),{data:x,loading:y}=O("players","*"),{data:f,loading:d}=O("matches","*",{order:{column:"date",ascending:!1}}),{data:u,loading:i}=O("transactions","*",{order:{column:"date",ascending:!1}}),{data:c,loading:j}=O("bans","*",{order:{column:"id",ascending:!1}}),p=y||d||i||j,h=[{id:"players",label:"Spieler",icon:"fas fa-users",data:x||[],searchFields:["name","position","team","value"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"},{value:"Ehemalige",label:"Ehemalige"}]},{key:"position",label:"Position",options:[{value:"TH",label:"Torwart"},{value:"IV",label:"Innenverteidiger"},{value:"LV",label:"Linksverteidiger"},{value:"RV",label:"Rechtsverteidiger"},{value:"ZDM",label:"Defensives Mittelfeld"},{value:"ZM",label:"Zentrales Mittelfeld"},{value:"ZOM",label:"Offensives Mittelfeld"},{value:"LM",label:"Linkes Mittelfeld"},{value:"RM",label:"Rechtes Mittelfeld"},{value:"LF",label:"Linker Fl√ºgel"},{value:"RF",label:"Rechter Fl√ºgel"},{value:"ST",label:"St√ºrmer"}]}]},{id:"matches",label:"Spiele",icon:"fas fa-futbol",data:f||[],searchFields:["date","goalsa","goalsb","goalscorers","manofthematch","teama","teamb"],filterOptions:[],searchExtractor:w=>{const m=[];if(w.date&&m.push(new Date(w.date).toLocaleDateString("de-DE")),w.teama&&m.push(w.teama),w.teamb&&m.push(w.teamb),w.goalsa!==void 0&&m.push(w.goalsa.toString()),w.goalsb!==void 0&&m.push(w.goalsb.toString()),w.goalslista)try{const A=typeof w.goalslista=="string"?JSON.parse(w.goalslista):w.goalslista;Array.isArray(A)&&A.forEach(s=>{typeof s=="string"?m.push(s):s&&s.player&&m.push(s.player)})}catch{}if(w.goalslistb)try{const A=typeof w.goalslistb=="string"?JSON.parse(w.goalslistb):w.goalslistb;Array.isArray(A)&&A.forEach(s=>{typeof s=="string"?m.push(s):s&&s.player&&m.push(s.player)})}catch{}return w.manofthematch&&(m.push(w.manofthematch),m.push("Spieler des Spiels"),m.push("SdS")),m.join(" ").toLowerCase()}},{id:"transactions",label:"Transaktionen",icon:"fas fa-euro-sign",data:u||[],searchFields:["type","description","amount","date"],filterOptions:[{key:"type",label:"Typ",options:[{value:"transfer",label:"Transfer"},{value:"preis",label:"Preisgeld"},{value:"strafe",label:"Strafe"},{value:"sonstige",label:"Sonstige"}],filterFn:(w,m)=>{var o,b;const A=((o=w.type)==null?void 0:o.toLowerCase())||"",s=((b=w.description)==null?void 0:b.toLowerCase())||"";switch(m){case"transfer":return A.includes("transfer")||s.includes("transfer");case"preis":return A.includes("preis")||s.includes("preis")||w.amount>0;case"strafe":return A.includes("strafe")||s.includes("strafe");case"sonstige":return!A.includes("transfer")&&!A.includes("preis")&&!A.includes("strafe");default:return!0}}}]},{id:"bans",label:"Sperren",icon:"fas fa-ban",data:c||[],searchFields:["player_name","team","type","reason"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"}]},{key:"type",label:"Typ",options:[{value:"Gelbe Karte",label:"Gelbe Karte"},{value:"Gelb-Rote Karte",label:"Gelb-Rote Karte"},{value:"Rote Karte",label:"Rote Karte"},{value:"Verletzung",label:"Verletzung"}]}]}],E=h.find(w=>w.id===a),$=(w,m)=>{switch(m){case"players":n==null||n("squad");break;case"matches":n==null||n("matches");break;case"transactions":n==null||n("finances");break;case"bans":n==null||n("bans");break}},F=()=>{const w=t.length>0?t:E.data;return w.length===0?e.jsxs("div",{className:"p-6 text-center text-text-secondary",children:[e.jsx("i",{className:`${E.icon} text-4xl mb-2`}),e.jsxs("p",{children:["Keine ",E.label.toLowerCase()," gefunden"]})]}):e.jsx("div",{className:"divide-y divide-border-light",children:w.map(m=>e.jsxs("button",{onClick:()=>$(m,a),className:"w-full p-4 hover:bg-bg-secondary transition-colors text-left focus:outline-none focus:ring-2 focus:ring-primary-green focus:ring-inset",children:[a==="players"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:m.name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[m.position," ‚Ä¢ ",m.team," ‚Ä¢ ",m.value||0,"M ‚Ç¨"]}),(m.goals||0)>0&&e.jsxs("p",{className:"text-xs text-primary-green",children:["‚öΩ ",m.goals||0," Tore"]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[m.value||0,"M ‚Ç¨"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zum Spieler ‚Üí"})]})]}),a==="matches"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:new Date(m.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[m.teama||"AEK"," ",m.goalsa||0," - ",m.goalsb||0," ",m.teamb||"Real"]}),(()=>{const A=[];try{if(m.goalslista){const s=typeof m.goalslista=="string"?JSON.parse(m.goalslista):m.goalslista;Array.isArray(s)&&s.forEach(o=>{const b=typeof o=="string"?o:o==null?void 0:o.player;b&&A.push(`${b} (AEK)`)})}if(m.goalslistb){const s=typeof m.goalslistb=="string"?JSON.parse(m.goalslistb):m.goalslistb;Array.isArray(s)&&s.forEach(o=>{const b=typeof o=="string"?o:o==null?void 0:o.player;b&&A.push(`${b} (Real)`)})}}catch{}return A.length>0?e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["‚öΩ ",A.slice(0,3).join(", "),A.length>3?"...":""]}):null})(),m.manofthematch&&e.jsxs("p",{className:"text-xs text-yellow-600 mt-1",children:["‚≠ê SdS: ",m.manofthematch]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[(m.goalsa||0)+(m.goalsb||0)," Tore"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zum Spiel ‚Üí"})]})]}),a==="transactions"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:m.type||"Transaktion"}),e.jsx("p",{className:"text-sm text-text-secondary",children:m.description||"Keine Beschreibung"}),e.jsx("p",{className:"text-xs text-text-secondary",children:new Date(m.date).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:`text-lg font-bold ${(m.amount||0)>=0?"text-green-600":"text-red-600"}`,children:[(m.amount||0)>0?"+":"",m.amount||0,"‚Ç¨"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zu Finanzen ‚Üí"})]})]}),a==="bans"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:m.player_name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[m.team," ‚Ä¢ ",m.type]}),m.reason&&e.jsx("p",{className:"text-xs text-text-secondary",children:m.reason})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-sm text-accent-red",children:[m.duration||1," Spiel",(m.duration||1)!==1?"e":""]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zu Sperren ‚Üí"})]})]})]},m.id))})};return p?e.jsx(ge,{message:"Lade Daten..."}):e.jsxs("div",{className:"p-4 pb-20 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:"üîç Globale Suche"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Durchsuche alle Daten zentral an einem Ort"})]}),e.jsx("div",{className:"icon-only-nav flex overflow-x-auto space-x-2 pb-2",children:h.map(w=>e.jsxs("button",{onClick:()=>{r(w.id),l([])},className:`search-nav-button flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${a===w.id?"bg-primary-green text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary"}`,title:w.label,"aria-label":w.label,children:[e.jsx("i",{className:w.icon}),e.jsx("span",{className:"font-medium hidden sm:inline",children:w.label}),e.jsxs("span",{className:"text-xs opacity-75",children:["(",w.data.length,")"]})]},w.id))}),e.jsx(Fe,{data:E.data,searchFields:E.searchFields,filterOptions:E.filterOptions,searchExtractor:E.searchExtractor,onResults:l,placeholder:`${E.label} durchsuchen...`}),e.jsxs("div",{className:"modern-card",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("h4",{className:"font-medium text-text-primary",children:[t.length>0?"Suchergebnisse":`Alle ${E.label}`,e.jsxs("span",{className:"text-text-secondary ml-2",children:["(",t.length>0?t.length:E.data.length,")"]})]})}),F()]})]})}function ze(){const{theme:n,autoMode:a,toggleTheme:r,setAutoTheme:t,setManualTheme:l}=ve();return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üé®"}),"Design & Darstellung"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Darstellungsmodus"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>t(!0),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${a?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"üåó"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Automatisch"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Folgt den Systemeinstellungen"})]}),e.jsxs("button",{onClick:()=>l("light"),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${!a&&n==="light"?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"‚òÄÔ∏è"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Hell"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Helle Darstellung"})]}),e.jsxs("button",{onClick:()=>l("dark"),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${!a&&n==="dark"?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"üåô"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Dunkel"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Dunkle Darstellung"})]})]})]}),e.jsx("div",{className:"bg-bg-tertiary rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Aktueller Modus"}),e.jsx("div",{className:"text-xs text-text-muted",children:a?`Automatisch (${n==="dark"?"Dunkel":"Hell"} - basierend auf Systemeinstellung)`:`Manuell (${n==="dark"?"Dunkel":"Hell"})`})]}),e.jsx("div",{className:"text-2xl",children:n==="dark"?"üåô":"‚òÄÔ∏è"})]})}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Schnellwechsel"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Wechselt zwischen Hell und Dunkel"})]}),e.jsxs("button",{onClick:r,className:"bg-primary-green hover:bg-primary-green-dark text-white px-4 py-2 rounded-lg transition-all duration-300 flex items-center space-x-2",children:[e.jsx("span",{children:n==="dark"?"‚òÄÔ∏è":"üåô"}),e.jsxs("span",{className:"text-sm font-medium",children:["Zu ",n==="dark"?"Hell":"Dunkel"]})]})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üí°"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Darstellungshinweise"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Automatisch:"})," Wechselt automatisch basierend auf Ihren Systemeinstellungen"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Hell:"})," Optimiert f√ºr helle Umgebungen und bessere Akkulaufzeit"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Dunkel:"})," Reduziert Augenbelastung bei schwachem Licht"]}),e.jsx("p",{children:"‚Ä¢ Alle Karten, Modals und UI-Elemente passen sich automatisch an"})]})]})]})})]})})}function Re(){const[n,a]=T.useState({primaryGreen:"#10B981",primaryGreenDark:"#059669",primaryGreenLight:"#34D399",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#3B82F6"}),[r]=T.useState([{name:"Standard",colors:{primaryGreen:"#10B981",primaryGreenDark:"#059669",primaryGreenLight:"#34D399",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#3B82F6"}},{name:"AEK Blau",colors:{primaryGreen:"#1E40AF",primaryGreenDark:"#1E3A8A",primaryGreenLight:"#3B82F6",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#60A5FA"}},{name:"Real Rot",colors:{primaryGreen:"#DC2626",primaryGreenDark:"#B91C1C",primaryGreenLight:"#EF4444",accentOrange:"#F59E0B",accentRed:"#F87171",accentBlue:"#3B82F6"}},{name:"Dunkles Gold",colors:{primaryGreen:"#D97706",primaryGreenDark:"#B45309",primaryGreenLight:"#F59E0B",accentOrange:"#FBBF24",accentRed:"#EF4444",accentBlue:"#3B82F6"}}]),[t,l]=T.useState(!1),[x,y]=T.useState("Standard");T.useEffect(()=>{const p=localStorage.getItem("fifa-tracker-custom-colors");if(p)try{const h=JSON.parse(p);a(h),f(h)}catch(h){console.error("Error loading custom colors:",h)}},[]);const f=p=>{const h=document.documentElement;h.style.setProperty("--primary-green",p.primaryGreen),h.style.setProperty("--primary-green-dark",p.primaryGreenDark),h.style.setProperty("--primary-green-light",p.primaryGreenLight),h.style.setProperty("--accent-orange",p.accentOrange),h.style.setProperty("--accent-red",p.accentRed),h.style.setProperty("--accent-blue",p.accentBlue)},d=(p,h)=>{const E={...n,[p]:h};a(E),l(!0),y("Benutzerdefiniert"),f(E)},u=p=>{a(p.colors),y(p.name),l(!0),f(p.colors)},i=()=>{localStorage.setItem("fifa-tracker-custom-colors",JSON.stringify(n)),l(!1);const p=new CustomEvent("show-toast",{detail:{message:"Farbschema gespeichert!",type:"success"}});window.dispatchEvent(p)},c=()=>{const p=r[0].colors;a(p),y("Standard"),l(!0),f(p)},j=({label:p,colorKey:h,value:E,description:$})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:p}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"color",value:E,onChange:F=>d(h,F.target.value),className:"w-12 h-12 rounded-lg border-2 border-border-medium cursor-pointer appearance-none",style:{background:E}}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 rounded-lg border-2 border-white pointer-events-none shadow-sm"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"text",value:E,onChange:F=>d(h,F.target.value),className:"w-full px-3 py-2 text-sm border border-border-medium rounded-lg bg-bg-secondary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green/50",placeholder:"#000000"}),$&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:$})]})]})]});return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üé®"}),"Farbkonfiguration"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-3",children:"Vorgefertigte Farbschemata"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:r.map(p=>e.jsxs("button",{onClick:()=>u(p),className:`p-3 rounded-lg border-2 transition-all duration-300 ${x===p.name?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:p.colors.primaryGreen}}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:p.colors.accentRed}}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:p.colors.accentBlue}})]}),e.jsx("div",{className:"text-xs font-medium text-text-primary",children:p.name})]},p.name))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-text-primary",children:"Individuelle Farbanpassung"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Prim√§rfarbe",colorKey:"primaryGreen",value:n.primaryGreen,description:"Hauptfarbe f√ºr Buttons und Akzente"}),e.jsx(j,{label:"Prim√§rfarbe (Dunkel)",colorKey:"primaryGreenDark",value:n.primaryGreenDark,description:"Dunklere Variante f√ºr Hover-Effekte"}),e.jsx(j,{label:"Prim√§rfarbe (Hell)",colorKey:"primaryGreenLight",value:n.primaryGreenLight,description:"Hellere Variante f√ºr Highlights"}),e.jsx(j,{label:"Akzentfarbe Orange",colorKey:"accentOrange",value:n.accentOrange,description:"Orange Akzente und Warnungen"}),e.jsx(j,{label:"Akzentfarbe Rot",colorKey:"accentRed",value:n.accentRed,description:"Rote Akzente und Fehler"}),e.jsx(j,{label:"Akzentfarbe Blau",colorKey:"accentBlue",value:n.accentBlue,description:"Blaue Akzente und Informationen"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-border-light",children:[e.jsx("button",{onClick:i,disabled:!t,className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-300 ${t?"bg-primary-green hover:bg-primary-green-dark text-white":"bg-border-medium text-text-muted cursor-not-allowed"}`,children:t?"Farben speichern":"Keine √Ñnderungen"}),e.jsx("button",{onClick:c,className:"py-3 px-4 bg-bg-tertiary hover:bg-border-light text-text-primary border border-border-medium rounded-lg font-medium transition-all duration-300",children:"Zur√ºcksetzen"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-bg-tertiary rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-text-primary mb-3",children:"Vorschau"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"btn-primary text-sm py-2 px-4",style:{backgroundColor:n.primaryGreen,borderColor:n.primaryGreen},children:"Prim√§r Button"}),e.jsx("div",{className:"px-3 py-2 rounded text-white text-sm",style:{backgroundColor:n.accentRed},children:"Rot Akzent"}),e.jsx("div",{className:"px-3 py-2 rounded text-white text-sm",style:{backgroundColor:n.accentBlue},children:"Blau Akzent"}),e.jsx("div",{className:"px-3 py-2 rounded text-white text-sm",style:{backgroundColor:n.accentOrange},children:"Orange Akzent"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üí°"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Farbhinweise"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsx("p",{children:"‚Ä¢ √Ñnderungen werden sofort in der Vorschau angezeigt"}),e.jsx("p",{children:"‚Ä¢ Gespeicherte Farben werden automatisch bei der n√§chsten Anmeldung geladen"}),e.jsx("p",{children:"‚Ä¢ Verwenden Sie Hex-Codes (#RRGGBB) f√ºr pr√§zise Farben"}),e.jsx("p",{children:"‚Ä¢ Team-spezifische Presets helfen bei der schnellen Anpassung"})]})]})]})})]})})}class Ie{constructor(){this.isSupported="serviceWorker"in navigator&&"PushManager"in window,this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent),this.permission=Notification.permission,this.subscription=null,this.settings=this.loadSettings()}async initialize(){if(!this.isSupported)return console.warn("Push notifications not supported"),!1;try{if("serviceWorker"in navigator){const a=await navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered:",a)}return this.permission=Notification.permission,!0}catch(a){return console.error("Failed to initialize notifications:",a),!1}}async requestPermission(){if(!this.isSupported)throw new Error("Notifications not supported");if(this.permission==="granted")return!0;try{if(this.isIOS){const a=await Notification.requestPermission();return this.permission=a,a==="granted"}else{const a=await Notification.requestPermission();return this.permission=a,a==="granted"}}catch(a){return console.error("Permission request failed:",a),!1}}async subscribe(){if(!this.isSupported||this.permission!=="granted")throw new Error("Cannot subscribe: permission not granted");try{const a=await navigator.serviceWorker.ready,r=await a.pushManager.getSubscription();if(r)return this.subscription=r,r;const t=await a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.getVAPIDKey()});return this.subscription=t,await this.sendSubscriptionToServer(t),t}catch(a){throw console.error("Subscription failed:",a),a}}async unsubscribe(){if(!this.subscription)return!0;try{return await this.subscription.unsubscribe(),await this.removeSubscriptionFromServer(this.subscription),this.subscription=null,!0}catch(a){return console.error("Unsubscribe failed:",a),!1}}async scheduleMatchReminder(a,r=30){if(!this.settings.matchReminders)return;const t=new Date(a.date),l=new Date(t.getTime()-r*60*1e3),x=new Date;if(l<=x)return;const y=l.getTime()-x.getTime();setTimeout(()=>{this.showNotification({title:"‚öΩ FIFA Match Reminder",body:`Match starting in ${r} minutes: AEK vs Real Madrid`,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`match-reminder-${a.id}`,data:{type:"match_reminder",matchId:a.id,url:"/matches"},actions:[{action:"view",title:"View Match",icon:"/assets/icon-180.png"},{action:"dismiss",title:"Dismiss"}]})},y)}async notifyAchievement(a){this.settings.achievements&&await this.showNotification({title:"üèÜ Achievement Unlocked!",body:a.title,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`achievement-${a.id}`,data:{type:"achievement",achievementId:a.id,url:"/stats"}})}async notifyGoal(a,r,t){this.settings.goals&&await this.showNotification({title:"‚öΩ GOAL!",body:`${t} scored for ${r}!`,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`goal-${a.id}-${Date.now()}`,data:{type:"goal",matchId:a.id,url:"/matches"}})}async notifyEvent(a){this.settings.events&&await this.showNotification({title:`üéâ ${a.name}`,body:a.description,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`event-${a.id}`,data:{type:"event",eventId:a.id,url:"/events"}})}async showNotification(a){if(this.permission!=="granted"){console.warn("Cannot show notification: permission not granted");return}try{"serviceWorker"in navigator?await(await navigator.serviceWorker.ready).showNotification(a.title,{body:a.body,icon:a.icon,badge:a.badge,tag:a.tag,data:a.data,actions:a.actions||[],vibrate:this.isIOS?void 0:[200,100,200],requireInteraction:!1,silent:!1}):new Notification(a.title,{body:a.body,icon:a.icon,tag:a.tag,data:a.data})}catch(r){console.error("Failed to show notification:",r)}}updateSettings(a){this.settings={...this.settings,...a},localStorage.setItem("fifa-tracker-notification-settings",JSON.stringify(this.settings))}loadSettings(){const a=localStorage.getItem("fifa-tracker-notification-settings"),r={matchReminders:!0,goals:!0,achievements:!0,events:!0,reminderTime:30};return a?{...r,...JSON.parse(a)}:r}getVAPIDKey(){return"BEl62iUYgUivxIkv69yViEuiBIa40HI0DLLuxazjqak_7kYDjLE2cI5GkJM-5z9z9LzsQI7JClZgZmKjgKrRxfQ"}async sendSubscriptionToServer(a){try{console.log("Would send subscription to server:",a)}catch(r){console.error("Failed to send subscription to server:",r)}}async removeSubscriptionFromServer(a){try{console.log("Would remove subscription from server:",a)}catch(r){console.error("Failed to remove subscription from server:",r)}}async testNotification(){await this.showNotification({title:"üß™ Test Notification",body:"FUSTA notifications are working!",icon:"/assets/icon-180.png",tag:"test-notification"})}getStatus(){return{supported:this.isSupported,permission:this.permission,subscribed:!!this.subscription,isIOS:this.isIOS,settings:this.settings}}}const K=new Ie;typeof window<"u"&&(window.NotificationService=K,K.initialize());function Ke(){const[n,a]=T.useState(K.getStatus()),[r,t]=T.useState(K.settings),[l,x]=T.useState(!1);T.useEffect(()=>{a(K.getStatus()),t(K.settings)},[]);const y=async()=>{x(!0);try{await K.requestPermission()&&await K.subscribe(),a(K.getStatus())}catch(i){console.error("Permission request failed:",i);const c=new CustomEvent("show-toast",{detail:{message:"Benachrichtigungen konnten nicht aktiviert werden.",type:"error"}});window.dispatchEvent(c)}finally{x(!1)}},f=async()=>{x(!0);try{await K.unsubscribe(),a(K.getStatus())}catch(i){console.error("Unsubscribe failed:",i)}finally{x(!1)}},d=(i,c)=>{const j={...r,[i]:c};t(j),K.updateSettings(j)},u=async()=>{try{await K.testNotification();const i=new CustomEvent("show-toast",{detail:{message:"Test-Benachrichtigung gesendet!",type:"success"}});window.dispatchEvent(i)}catch(i){console.error("Test notification failed:",i)}};return n.supported?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üì±"}),"Push-Benachrichtigungen"]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Status"}),e.jsxs("div",{className:"text-xs text-text-muted",children:[n.permission==="granted"?"Benachrichtigungen aktiviert":n.permission==="denied"?"Benachrichtigungen blockiert":"Berechtigung ausstehend",n.isIOS&&" (iOS)"]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${n.permission==="granted"?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":n.permission==="denied"?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300"}`,children:n.permission==="granted"?"Aktiv":n.permission==="denied"?"Blockiert":"Ausstehend"})]})}),n.permission!=="granted"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:y,disabled:l||n.permission==="denied",className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-300 ${n.permission==="denied"?"bg-border-medium text-text-muted cursor-not-allowed":"bg-primary-green hover:bg-primary-green-dark text-white"}`,children:l?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Aktiviere..."]}):n.permission==="denied"?"In Browsereinstellungen aktivieren":"Benachrichtigungen aktivieren"}),n.permission==="denied"&&e.jsx("p",{className:"text-xs text-text-muted mt-2 text-center",children:"√ñffnen Sie die Browsereinstellungen und erlauben Sie Benachrichtigungen f√ºr diese Seite."})]}),n.permission==="granted"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-text-primary",children:"Benachrichtigungseinstellungen"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"‚öΩ Spiel-Erinnerungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Erinnerungen vor Spielbeginn"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.matchReminders,onChange:i=>d("matchReminders",i.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),r.matchReminders&&e.jsxs("div",{className:"ml-4 p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Erinnerungszeit (Minuten vor Spielbeginn)"}),e.jsxs("select",{value:r.reminderTime,onChange:i=>d("reminderTime",parseInt(i.target.value)),className:"w-full px-3 py-2 text-sm border border-border-medium rounded-lg bg-bg-secondary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green/50",children:[e.jsx("option",{value:5,children:"5 Minuten"}),e.jsx("option",{value:15,children:"15 Minuten"}),e.jsx("option",{value:30,children:"30 Minuten"}),e.jsx("option",{value:60,children:"1 Stunde"}),e.jsx("option",{value:120,children:"2 Stunden"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"‚öΩ Tor-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei Toren w√§hrend Live-Matches"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.goals,onChange:i=>d("goals",i.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"üèÜ Achievement-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei freigeschalteten Erfolgen"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.achievements,onChange:i=>d("achievements",i.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"üéâ Event-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei neuen Events und Turnieren"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.events,onChange:i=>d("events",i.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-border-light",children:[e.jsx("button",{onClick:u,className:"flex-1 py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all duration-300",children:"Test-Benachrichtigung"}),e.jsx("button",{onClick:f,disabled:l,className:"py-2 px-4 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-all duration-300 disabled:opacity-50",children:l?"Deaktiviere...":"Deaktivieren"})]})]}),n.isIOS&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üì±"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"iOS-Hinweis"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsx("p",{children:'‚Ä¢ Installieren Sie die App √ºber "Zum Home-Bildschirm hinzuf√ºgen" f√ºr beste Benachrichtigungen'}),e.jsx("p",{children:"‚Ä¢ Benachrichtigungen funktionieren nur bei aktiver App oder im Hintergrund"}),e.jsx("p",{children:"‚Ä¢ √úberpr√ºfen Sie die iOS-Einstellungen f√ºr App-Benachrichtigungen"})]})]})]})})]})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üì±"}),"Push-Benachrichtigungen"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-yellow-500 text-xl flex-shrink-0",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200 mb-1",children:"Nicht unterst√ºtzt"}),e.jsx("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:"Ihr Browser unterst√ºtzt keine Push-Benachrichtigungen. Verwenden Sie einen modernen Browser oder installieren Sie die App f√ºr Benachrichtigungen."})]})]})})]})})}function Ge(){const[n,a]=T.useState({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}}),[r,t]=T.useState(!1),[l,x]=T.useState(!0);T.useEffect(()=>{y()},[]);const y=async()=>{try{x(!0),console.log("üîÑ [AdminTab] Loading managers from database...");const c=await q.getManagers();if(console.log("üìä [AdminTab] Manager data result:",c),c&&c.data&&Array.isArray(c.data)&&c.data.length>=2){console.log("‚úÖ [AdminTab] Manager data loaded successfully:",c.data);const j=c.data.find(h=>h.id===1)||{name:"Alexander",gewicht:110},p=c.data.find(h=>h.id===2)||{name:"Philip",gewicht:105};console.log("üë§ [AdminTab] AEK Manager:",j),console.log("üë§ [AdminTab] Real Manager:",p),a({aek:{name:j.name,age:30,weight:j.gewicht},real:{name:p.name,age:30,weight:p.gewicht}})}else console.warn("‚ö†Ô∏è [AdminTab] No manager data found, using defaults. Result:",c),await f()}catch(c){console.error("‚ùå [AdminTab] Error loading manager settings from database:",c),await f()}finally{x(!1)}},f=async()=>{try{console.log("üîß [AdminTab] Initializing default managers...");const c={name:"Alexander",gewicht:110},j=await q.insert("managers",c);console.log("‚úÖ [AdminTab] AEK manager created:",j);const p={name:"Philip",gewicht:105},h=await q.insert("managers",p);console.log("‚úÖ [AdminTab] Real manager created:",h),a({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}})}catch(c){console.error("‚ùå [AdminTab] Error initializing managers:",c),a({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}})}},d=(c,j,p)=>{a(h=>({...h,[c]:{...h[c],[j]:j==="name"?p:parseInt(p)||0}})),t(!0)},u=async()=>{try{x(!0),console.log("üíæ [TeamSettings] Saving manager settings:",n);const c={name:n.aek.name,gewicht:n.aek.weight},j={name:n.real.name,gewicht:n.real.weight};console.log("üíæ [TeamSettings] AEK Data:",c),console.log("üíæ [TeamSettings] Real Data:",j);const p=await q.update("managers",c,1);console.log("üíæ [TeamSettings] AEK Update Result:",p);const h=await q.update("managers",j,2);console.log("üíæ [TeamSettings] Real Update Result:",h),t(!1),window.dispatchEvent(new CustomEvent("managerSettingsChanged"));const E=document.createElement("div");E.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",E.textContent="Manager-Einstellungen gespeichert!",document.body.appendChild(E),setTimeout(()=>{document.body.contains(E)&&document.body.removeChild(E)},3e3)}catch(c){console.error("Error saving manager settings:",c);const j=document.createElement("div");j.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",j.textContent="Fehler beim Speichern!",document.body.appendChild(j),setTimeout(()=>{document.body.contains(j)&&document.body.removeChild(j)},3e3)}finally{x(!1)}},i=()=>{a({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}}),t(!0)};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx(ze,{}),e.jsx(Re,{}),e.jsx(Ke,{}),l?e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-green"}),e.jsx("span",{className:"ml-2 text-text-muted",children:"Lade Manager-Einstellungen..."})]})}):e.jsxs("div",{className:"modern-card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"üèÜ Team-Manager Einstellungen"}),r&&e.jsx("span",{className:"text-sm text-orange-600 font-medium",children:"Ungespeicherte √Ñnderungen"})]}),e.jsx("div",{className:"text-sm text-text-muted mb-6",children:"Hier k√∂nnen Sie die Daten der Team-Manager f√ºr die BAK-Berechnung anpassen."}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4 p-4 border border-blue-200 rounded-lg bg-blue-50",children:[e.jsxs("h4",{className:"font-medium text-blue-800 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded mr-2"}),"AEK Manager"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.aek.name,onChange:c=>d("aek","name",c.target.value),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Manager Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Alter"}),e.jsx("input",{type:"number",min:"18",max:"80",value:n.aek.age,onChange:c=>d("aek","age",c.target.value),onFocus:c=>c.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gewicht (kg)"}),e.jsx("input",{type:"number",min:"40",max:"200",value:n.aek.weight,onChange:c=>d("aek","weight",c.target.value),onFocus:c=>c.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 border border-red-200 rounded-lg bg-red-50",children:[e.jsxs("h4",{className:"font-medium text-red-800 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-red-600 rounded mr-2"}),"Real Manager"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.real.name,onChange:c=>d("real","name",c.target.value),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Manager Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Alter"}),e.jsx("input",{type:"number",min:"18",max:"80",value:n.real.age,onChange:c=>d("real","age",c.target.value),onFocus:c=>c.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gewicht (kg)"}),e.jsx("input",{type:"number",min:"40",max:"200",value:n.real.weight,onChange:c=>d("real","weight",c.target.value),onFocus:c=>c.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-border-light",children:[e.jsx("button",{onClick:i,className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-200 transition-colors",children:"Standardwerte wiederherstellen"}),e.jsx("button",{onClick:u,disabled:!r||l,className:`px-4 py-2 text-sm rounded-lg transition-colors ${r&&!l?"bg-primary-green text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:l?"Speichern...":"Einstellungen speichern"})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Hinweis:"})," Diese Einstellungen werden f√ºr die BAK-Berechnung in der Statistik verwendet. Die Werte werden in der Datenbank gespeichert."]})})]})]})}function Le(){const[n,a]=T.useState(()=>{const u=localStorage.getItem("eventsTabEnabled");return u!==null?JSON.parse(u):!1}),[r,t]=T.useState({title:"",message:"",type:"general"}),[l,x]=T.useState(()=>{const u=localStorage.getItem("customEvents");return u?JSON.parse(u):[]}),y=u=>{a(u),localStorage.setItem("eventsTabEnabled",JSON.stringify(u)),setTimeout(()=>{window.location.reload()},500)},f=()=>{if(!r.title||!r.message){alert("Bitte Titel und Nachricht eingeben");return}P(r.type,{title:r.title,message:r.message,timestamp:new Date().toISOString(),custom:!0});const i=[{id:Date.now(),...r,timestamp:new Date().toISOString()},...l.slice(0,9)];x(i),localStorage.setItem("customEvents",JSON.stringify(i)),t({title:"",message:"",type:"general"}),alert("Benachrichtigung gesendet!")},d=[{value:"general",label:"üì¢ Allgemein",color:"bg-gray-500"},{value:"match-created",label:"‚öΩ Spiel erstellt",color:"bg-green-500"},{value:"player-ban",label:"üö´ Spieler gesperrt",color:"bg-red-500"},{value:"financial-milestone",label:"üí∞ Finanzmeilenstein",color:"bg-yellow-500"},{value:"achievement-unlocked",label:"üèÖ Achievement",color:"bg-purple-500"},{value:"system-update",label:"üîÑ System Update",color:"bg-blue-500"}];return e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üéâ"}),"Events Tab Konfiguration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-secondary rounded-lg border border-border-light",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:"Events Tab anzeigen"}),e.jsx("div",{className:"text-sm text-text-muted",children:"Zeigt den Events Tab in der Navigation an oder blendet ihn aus"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:u=>y(u.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Hinweis:"})," Der Events Tab ist standardm√§√üig ausgeblendet. Nach dem Aktivieren wird die Seite neu geladen um die Navigation zu aktualisieren."]})})]})]}),e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üöÄ"}),"Schnell-Tests f√ºr Push-Benachrichtigungen"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>P("match-result",{goalsa:3,goalsb:1,manofthematch:"Max M√ºller",date:new Date().toISOString()}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"‚öΩ"}),"Spielergebnis-Test"]}),e.jsxs("button",{onClick:()=>P("player-ban",{playerName:"Tom Schmidt",games:3}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üö´"}),"Spieler-Sperre"]}),e.jsxs("button",{onClick:()=>P("financial-milestone",{team:"AEK Athen",amount:250}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üí∞"}),"Finanzmeilenstein"]}),e.jsxs("button",{onClick:()=>P("achievement-unlocked",{name:"Torj√§ger",description:"10 Tore in einer Saison"}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üèÖ"}),"Achievement"]}),e.jsxs("button",{onClick:()=>P("system-update",{message:"Neue Funktionen verf√ºgbar!"}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üîÑ"}),"System-Update"]}),e.jsxs("button",{onClick:()=>{setTimeout(()=>P("match-created",{date:new Date().toISOString()}),0),setTimeout(()=>P("player-ban",{playerName:"Test Player",games:1}),300),setTimeout(()=>P("financial-milestone",{team:"Real Madrid",amount:100}),600)},className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üìö"}),"Mehrere Tests"]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Tipp:"})," Diese Buttons testen die neuen Push-Up Benachrichtigungen mit realistischen Daten und Animationen."]})})]}),e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üì¢"}),"Individuelle Push-Benachrichtigungen"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Nachrichtentyp"}),e.jsx("select",{value:r.type,onChange:u=>t(i=>({...i,type:u.target.value})),className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors",children:d.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Titel"}),e.jsx("input",{type:"text",value:r.title,onChange:u=>t(i=>({...i,title:u.target.value})),placeholder:"z.B. Neues Tournament startet",className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Nachricht"}),e.jsx("textarea",{value:r.message,onChange:u=>t(i=>({...i,message:u.target.value})),placeholder:"z.B. Das Weihnachts-Tournament beginnt morgen um 19:00 Uhr!",rows:3,className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors resize-none"})]}),e.jsxs("button",{onClick:f,disabled:!r.title||!r.message,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("i",{className:"fas fa-paper-plane mr-2"}),"Benachrichtigung senden"]})]})]}),l.length>0&&e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üìã"}),"Gesendete Benachrichtigungen"]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:l.map(u=>{var i;return e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg border border-border-light",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-text-primary text-sm flex items-center",children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${((i=d.find(c=>c.value===u.type))==null?void 0:i.color)||"bg-gray-500"}`}),u.title]}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:u.message}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:new Date(u.timestamp).toLocaleString("de-DE")})]})})},u.id)})}),l.length>=10&&e.jsx("div",{className:"text-xs text-text-muted mt-2 text-center",children:"Nur die letzten 10 Benachrichtigungen werden angezeigt"})]})]})}const Pe=()=>{const[n,a]=T.useState(U());return T.useEffect(()=>{const r=t=>{a(t.detail.newSeason)};return window.addEventListener("seasonChanged",r),()=>window.removeEventListener("seasonChanged",r)},[]),{currentSeason:n,isLegacy:n===Q.LEGACY,isFC26:n===Q.FC26}},Oe=()=>{const[n,a]=T.useState([]),[r,t]=T.useState(!1),{currentSeason:l}=Pe();T.useEffect(()=>{const f=()=>{a(Se())};f();const d=()=>{setTimeout(f,100)};return window.addEventListener("seasonChanged",d),window.addEventListener("legacyDataMigrated",d),window.addEventListener("fc26EnvironmentInitialized",d),()=>{window.removeEventListener("seasonChanged",d),window.removeEventListener("legacyDataMigrated",d),window.removeEventListener("fc26EnvironmentInitialized",d)}},[]);const x=async f=>{try{t(!0);const d=ke(f);if(d){const u=new Blob([JSON.stringify(d,null,2)],{type:"application/json"}),i=URL.createObjectURL(u),c=document.createElement("a");c.href=i,c.download=`fifa-tracker-${f}-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(i),console.log(`Exported ${f} data successfully`)}else console.error("Failed to export season data")}catch(d){console.error("Error exporting season data:",d)}finally{t(!1)}},y=f=>{const d=["matches","players","bans","transactions","alcoholCalculator"],u={};return d.forEach(i=>{try{const c=`fifa_season_${f}_${i}`,j=localStorage.getItem(c);if(j){const p=JSON.parse(j);Array.isArray(p)?u[i]=p.length:typeof p=="object"&&(u[i]=1)}else u[i]=0}catch{u[i]=0}}),u};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl \r
                        flex items-center justify-center text-white text-xl font-bold`,children:"üìÖ"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Saison-Manager"}),e.jsx("p",{className:"text-gray-600",children:"Verwalten Sie Legacy- und FC26-Daten"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Aktuelle Saison"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:Ne[l]}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Alle Aktionen werden in dieser Saison gespeichert"})]}),e.jsx("div",{className:"text-4xl",children:l===Q.FC26?"‚ö°":"üìö"})]})}),e.jsx(we,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Daten√ºbersicht pro Saison"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:n.map(f=>{const d=y(f.id),u=Object.values(d).reduce((i,c)=>i+c,0);return e.jsxs("div",{className:`p-6 rounded-xl border-2 ${f.isActive?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-xl",style:{backgroundColor:f.color+"20",color:f.color},children:f.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:f.name}),e.jsx("p",{className:"text-sm text-gray-600",children:f.description})]})]}),f.isActive&&e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:"Aktiv"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Gesamt Eintr√§ge:"}),e.jsx("span",{className:"font-medium text-gray-800",children:u})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"‚öΩ Spiele:"}),e.jsx("span",{className:"font-medium",children:d.matches||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üë• Spieler:"}),e.jsx("span",{className:"font-medium",children:d.players||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üö´ Sperren:"}),e.jsx("span",{className:"font-medium",children:d.bans||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"üí∞ Transaktionen:"}),e.jsx("span",{className:"font-medium",children:d.transactions||0})]})]}),d.alcoholCalculator>0&&e.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t border-gray-200",children:[e.jsx("span",{className:"text-gray-600",children:"üç∫ Alkohol-Tracker:"}),e.jsx("span",{className:"font-medium text-green-600",children:"Konfiguriert"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(f.id),disabled:!f.hasData||r,className:`flex-1 px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 \r
                                 rounded-lg text-sm transition-colors disabled:opacity-50 \r
                                 disabled:cursor-not-allowed`,children:r?"Exportiert...":"üì• Export"}),f.hasData&&e.jsx("div",{className:"flex-1 px-3 py-2 text-center text-sm",children:e.jsx("span",{className:"text-green-600 font-medium",children:"‚úì Daten vorhanden"})})]})})]},f.id)})})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-amber-600 text-2xl",children:"üí°"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-amber-800 mb-2",children:"FC26 Saison-System"}),e.jsxs("div",{className:"space-y-2 text-sm text-amber-700",children:[e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Legacy:"})," Alle bisherigen FIFA-Daten bleiben erhalten und zug√§nglich"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"FC26:"})," Neue Saison mit frischen Daten f√ºr FIFA Club 26"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Isolation:"})," Jede Saison hat separate Speicherbereiche"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Wechsel:"})," Beliebig zwischen Saisons wechseln m√∂glich"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Export:"})," Backup-Funktion f√ºr alle Saisondaten"]})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-3",children:"Technische Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Speicher-System:"}),e.jsx("br",{}),"‚Ä¢ Lokaler Browser-Speicher",e.jsx("br",{}),"‚Ä¢ Automatische Datenmigration",e.jsx("br",{}),"‚Ä¢ Versionsverwaltung"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Datentypen:"}),e.jsx("br",{}),"‚Ä¢ Spiele und Ergebnisse",e.jsx("br",{}),"‚Ä¢ Spieler und Teams",e.jsx("br",{}),"‚Ä¢ Finanzen und Statistiken"]})]})]})]})};function Ue({onLogout:n,onNavigate:a,showHints:r=!1}){const[t,l]=T.useState("search"),x=[{id:"search",label:"Globale Suche",icon:"fas fa-search"},{id:"season",label:"Saison-Manager",icon:"fas fa-calendar-alt"},{id:"matches",label:"Spiele hinzuf√ºgen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren hinzuf√ºgen",icon:"fas fa-ban"},{id:"players",label:"Spieler hinzuf√ºgen",icon:"fas fa-users"},{id:"transactions",label:"Transaktionen hinzuf√ºgen",icon:"fas fa-euro-sign"},{id:"settings",label:"Team-Einstellungen",icon:"fas fa-cog"},{id:"events",label:"Events & Benachrichtigungen",icon:"fas fa-bell"},{id:"delete",label:"Daten l√∂schen",icon:"fas fa-trash"}],y=()=>{switch(t){case"search":return e.jsx(he,{onNavigate:a});case"season":return e.jsx(Oe,{});case"matches":return e.jsx(Te,{});case"bans":return e.jsx(De,{});case"players":return e.jsx($e,{});case"transactions":return e.jsx(Be,{});case"settings":return e.jsx(Ge,{});case"events":return e.jsx(Le,{});case"delete":return e.jsx(Me,{});default:return e.jsx(he,{onNavigate:a})}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-4 bg-bg-secondary border-b border-border-light flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-1",children:"Verwaltung"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Hinzuf√ºgen und verwalten von Daten"})]}),e.jsxs("button",{onClick:n,className:"flex items-center px-3 py-2 bg-accent-red text-white rounded-lg hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50","aria-label":"Abmelden",children:[e.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),e.jsx("span",{className:"text-sm",children:"Logout"})]})]}),e.jsx("div",{className:"bg-bg-secondary border-b border-border-light",children:e.jsx("div",{className:"flex overflow-x-auto",children:x.map(f=>e.jsxs("button",{onClick:()=>l(f.id),className:`flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap ${t===f.id?"text-primary-green border-b-2 border-primary-green bg-bg-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${f.icon} mr-2`}),f.label]},f.id))})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:y()})]})}export{Ue as default};
