class r{constructor(){this.loadingStates=new Set,this.loadingIndicators=new Map}show(n,t=null,e="Lädt..."){if(this.loadingStates.add(n),t){const s=this.createLoadingIndicator(e);this.loadingIndicators.set(n,{element:t,indicator:s,originalContent:t.innerHTML}),t.innerHTML="",t.appendChild(s)}this.updateGlobalLoadingState()}hide(n){if(this.loadingStates.delete(n),this.loadingIndicators.has(n)){const{element:t,originalContent:e}=this.loadingIndicators.get(n);t.innerHTML=e,this.loadingIndicators.delete(n)}this.updateGlobalLoadingState()}createLoadingIndicator(n){const t=document.createElement("div");return t.className="flex items-center justify-center py-4",t.innerHTML=`
            <div class="flex items-center space-x-2">
                <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"></div>
                <span class="text-sm text-gray-600">${n}</span>
            </div>
        `,t}updateGlobalLoadingState(){const n=this.loadingStates.size>0;document.body.classList.toggle("loading",n)}isLoading(n=null){return n?this.loadingStates.has(n):this.loadingStates.size>0}}class o{static showUserError(n,t="error"){console.error("User Error:",n);let e=document.getElementById("error-notification");e||(e=document.createElement("div"),e.id="error-notification",e.className="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 w-full mx-4",document.body.appendChild(e));const s={error:"bg-red-500 text-white",warning:"bg-yellow-500 text-white",info:"bg-blue-500 text-white",success:"bg-green-500 text-white"};e.innerHTML=`
            <div class="rounded-lg p-4 shadow-lg ${s[t]||s.error}">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <i class="fas fa-${t==="error"?"exclamation-triangle":t==="success"?"check-circle":"info-circle"} mr-2"></i>
                        <span>${n}</span>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        `,setTimeout(()=>{e&&e.parentElement&&e.remove()},t==="success"?3e3:5e3)}static showSuccessMessage(n){this.showUserError(n,"success")}static handleDatabaseError(n,t="Database operation"){console.error(`${t} failed:`,n);let e="Ein unerwarteter Fehler ist aufgetreten.",s="error";if(n.message){const i=n.message.toLowerCase();n.message.includes("nicht verfügbar")?(e=n.message,s="warning"):i.includes("auth")||i.includes("unauthorized")||i.includes("forbidden")?e="Authentifizierungsfehler. Bitte melden Sie sich erneut an.":i.includes("network")||i.includes("fetch")||i.includes("timeout")?e="Netzwerkfehler. Bitte überprüfen Sie Ihre Internetverbindung.":i.includes("constraint")||i.includes("duplicate")||i.includes("unique")?e="Diese Daten existieren bereits oder verletzen Datenbankregeln.":i.includes("validierung")||n.message.includes("Validierungsfehler")?(e=n.message,s="warning"):i.includes("cdn")||i.includes("blocked")?(e="CDN blockiert - Anwendung läuft im Demo-Modus.",s="info"):i.includes("session")||i.includes("token")?e="Session abgelaufen. Bitte melden Sie sich erneut an.":i.includes("permission")||i.includes("denied")?e="Keine Berechtigung für diese Aktion.":i.includes("not found")||i.includes("404")?(e="Die angeforderten Daten wurden nicht gefunden.",s="warning"):i.includes("server")||i.includes("500")||i.includes("503")?e="Server temporär nicht verfügbar. Bitte versuchen Sie es später erneut.":i.includes("offline")&&(e="Keine Internetverbindung. Funktionen sind eingeschränkt.",s="warning")}if(typeof window<"u"&&window.connectionMonitor){const i=window.connectionMonitor.getStatus();i.connected||(i.connectionType==="fallback"?(e+=" (Demo-Modus aktiv)",s="info"):i.connectionType==="offline"&&(e+=" (Offline)"))}return this.showUserError(e,s),e}static async withErrorHandling(n,t="Operation fehlgeschlagen"){try{return await n()}catch(e){throw this.handleDatabaseError(e,t),e}}}const l=new r;export{o as E,l};
