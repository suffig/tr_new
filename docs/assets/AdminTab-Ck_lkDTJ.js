import{s as T,u as O,r as $,j as e,z as R,t as L,a as X,L as ue,b as ye}from"./main-qd8gn2hu.js";import{B as W}from"./banTypes-DuNOJEIt.js";import{d as q}from"./dataManager-C8rOmH55.js";const he="alcoholCalculatorValues",te="1.0",Z=()=>({aekPlayer:"",realPlayer:"",aekGoals:0,realGoals:0,mode:"manual",gameDay:new Date().toISOString().split("T")[0],beerCount:{aek:0,real:0},alexanderShots:{cl40:0,cl20:0},philipShots:{cl40:0,cl20:0},cumulativeShots:{aek:0,real:0,total:0,lastMatchId:null,lastUpdated:null},lastUpdated:new Date().toISOString(),drinkingStartTime:null,version:te}),le=()=>{try{const n=localStorage.getItem(he);if(!n)return Z();const a=JSON.parse(n);if(!a.version||a.version!==te)return console.log("Alcohol calculator: Version mismatch, using defaults"),Z();const r=Z();return{...r,...a,beerCount:{...r.beerCount,...a.beerCount||{}},alexanderShots:{...r.alexanderShots,...a.alexanderShots||{}},philipShots:{...r.philipShots,...a.philipShots||{}},cumulativeShots:{...r.cumulativeShots,...a.cumulativeShots||{}}}}catch(n){return console.error("Error loading alcohol calculator values:",n),Z()}},je=n=>{try{const a={...n,lastUpdated:new Date().toISOString(),version:te};return localStorage.setItem(he,JSON.stringify(a)),typeof window<"u"&&window.dispatchEvent(new CustomEvent("alcoholCalculatorValuesChanged",{detail:a})),!0}catch(a){return console.error("Error saving alcohol calculator values:",a),!1}},ve=(n,a)=>{const r={...a,...n,lastUpdated:new Date().toISOString()};return n.beerCount&&(r.beerCount={...a.beerCount,...n.beerCount}),n.cumulativeShots&&(r.cumulativeShots={...a.cumulativeShots,...n.cumulativeShots}),je(r),r},xe=(n,a=null)=>{try{const r=a||le();if(!n||typeof n!="object")return console.warn("Invalid match object provided to addShotsFromNewMatch"),r;const t=n.goalsa||0,o=n.goalsb||0,x=Math.floor(o/2)*2,p=Math.floor(t/2)*2;return ve({cumulativeShots:{aek:r.cumulativeShots.aek+x,real:r.cumulativeShots.real+p,total:r.cumulativeShots.total+x+p,lastMatchId:n.id,lastUpdated:new Date().toISOString()}},r)}catch(r){return console.error("Error adding shots from new match:",r),a||le()}};typeof window<"u"&&(window.updateAlcoholCalculatorFromMatch=n=>{try{xe(n)}catch(a){console.warn("Failed to update alcohol calculator from match:",a)}});async function ee(n){var a,r;try{if(console.log(`Starting deletion of match ${n}`),n==null)throw new Error("No match ID provided for deletion");console.log(`Processing match ID for deletion: ${n} (type: ${typeof n})`);let t;if(typeof n=="string"){if(n.trim()==="")throw new Error("Empty string provided as match ID");if(t=parseInt(n,10),isNaN(t))throw new Error(`Invalid match ID string: "${n}" cannot be converted to number`)}else if(typeof n=="bigint"){const c=Number(n);BigInt(c)===n?t=c:t=n}else if(typeof n=="number")t=n;else throw new Error(`Unsupported match ID type: ${typeof n}. Expected string, number, or bigint.`);const o=typeof t=="number"&&Number.isInteger(t)&&t>0,x=typeof t=="bigint"&&t>0n;if(!o&&!x)throw new Error(`Invalid match ID after conversion: ${t} (type: ${typeof t}). Must be a positive integer.`);console.log(`Converted match ID: ${t} (type: ${typeof t})`);const{data:p,error:y}=await T.select("matches","date,prizeaek,prizereal,goalslista,goalslistb,manofthematch,yellowa,reda,yellowb,redb",{id:t});if(y)throw console.error("Error fetching match:",y),y;if(!p||p.length===0){const c=`Match with ID ${t} not found in database`;throw console.error(c),new Error(c)}const h=p[0];h.date||console.warn(`Match ${t} has no date - this may cause issues with transaction cleanup`),console.log("Deleting match data:",h),console.log(`Fetching transactions for match ${t} before deletion`);const{data:u,error:i}=await T.select("transactions","team,amount,type",{match_id:t});if(i)throw console.error("Error fetching transactions:",i),i;const d=u||[];if(console.log(`Found ${d.length} transactions to reverse:`,d.map(c=>`${c.type}: ${c.amount} (${c.team})`)),console.log(`Reversing financial changes for ${(d==null?void 0:d.length)||0} transactions`),d&&d.length>0)for(const c of d)if(c.type==="Echtgeld-Ausgleich"){const{data:A,error:s}=await T.select("finances","debt",{team:c.team});if(s){console.error(`Error fetching finances for team ${c.team}:`,s);continue}const l=A&&A.length>0?A[0]:null;let j=((l==null?void 0:l.debt)||0)-c.amount;j<0&&(j=0),await T.update("finances",{debt:j},{team:c.team})}else{const{data:A,error:s}=await T.select("finances","balance",{team:c.team});if(s){console.error(`Error fetching finances for team ${c.team}:`,s);continue}const l=A&&A.length>0?A[0]:null;let j=((l==null?void 0:l.balance)||0)-c.amount;j<0&&(j=0),await T.update("finances",{balance:j},{team:c.team})}if(typeof h.prizeaek=="number"&&h.prizeaek!==0){const{data:c,error:A}=await T.select("finances","balance",{team:"AEK"});if(A)console.error("Error fetching AEK finances:",A);else if(c&&c.length>0){const s=c[0];let l=((s==null?void 0:s.balance)||0)-h.prizeaek;l<0&&(l=0),await T.update("finances",{balance:l},{team:"AEK"})}}if(typeof h.prizereal=="number"&&h.prizereal!==0){const{data:c,error:A}=await T.select("finances","balance",{team:"Real"});if(A)console.error("Error fetching Real finances:",A);else if(c&&c.length>0){const s=c[0];let l=((s==null?void 0:s.balance)||0)-h.prizereal;l<0&&(l=0),await T.update("finances",{balance:l},{team:"Real"})}}console.log(`Deleting ${(d==null?void 0:d.length)||0} transactions for match ${t}`);const{error:N}=await T.delete("transactions",{match_id:t});if(N)throw console.error("Error deleting transactions:",N),N;const{data:f,error:m}=await T.select("transactions","id",{match_id:t});if(m)console.warn("Could not verify transaction deletion:",m);else{if(f&&f.length>0)throw console.error(`‚ùå Failed to delete ${f.length} transactions for match ${t}`),new Error(`Transaction deletion incomplete: ${f.length} transactions still exist`);console.log(`‚úÖ Successfully deleted all transactions for match ${t}`)}const E=async(c,A)=>{if(!c||!Array.isArray(c))return;const s={};if(c.length>0&&typeof c[0]=="object"&&c[0].player!==void 0)c.forEach(l=>{l.player&&(s[l.player]=(s[l.player]||0)+(l.count||1))});else for(const l of c)l&&(s[l]=(s[l]||0)+1);for(const[l,b]of Object.entries(s)){const{data:j,error:C}=await T.select("players","goals",{name:l,team:A});if(C){console.error(`Error fetching player ${l} for goal removal:`,C);continue}if(!j||j.length===0){console.warn(`Player ${l} not found in team ${A} for goal removal`);continue}const F=j[0];let P=((F==null?void 0:F.goals)||0)-b;P<0&&(P=0);const{error:G}=await T.update("players",{goals:P},{name:l,team:A});G?console.error(`Error updating goals for player ${l}:`,G):console.log(`‚úÖ Updated goals for ${l} (${A}): ${F.goals} ‚Üí ${P}`)}};if(await E(h.goalslista,"AEK"),await E(h.goalslistb,"Real"),h.manofthematch){let c=null;const A=(s,l)=>!s||!s.length?!1:typeof s[0]=="object"&&s[0].player!==void 0?s.some(b=>b.player===l):s.includes(l);if(A(h.goalslista,h.manofthematch))c="AEK";else if(A(h.goalslistb,h.manofthematch))c="Real";else{const{data:s,error:l}=await T.select("players","team",{name:h.manofthematch});l?console.error(`Error fetching player ${h.manofthematch} for team lookup:`,l):s&&s.length>0?c=s[0].team:console.warn(`Player ${h.manofthematch} not found for SdS team determination`)}if(c){const{data:s,error:l}=await T.select("spieler_des_spiels","count",{name:h.manofthematch,team:c});if(l)console.error(`Error fetching SdS entry for ${h.manofthematch}:`,l);else if(s&&s.length>0){const b=s[0],j=Math.max(0,b.count-1),{error:C}=await T.update("spieler_des_spiels",{count:j},{name:h.manofthematch,team:c});C?console.error(`Error updating SdS count for ${h.manofthematch}:`,C):console.log(`‚úÖ Updated SdS count for ${h.manofthematch} (${c}): ${b.count} ‚Üí ${j}`)}else console.warn(`SdS entry for ${h.manofthematch} in team ${c} not found`)}}(h.yellowa>0||h.reda>0||h.yellowb>0||h.redb>0)&&console.log(`Match had cards: AEK(${h.yellowa}Y,${h.reda}R) Real(${h.yellowb}Y,${h.redb}R)`),console.log(`Deleting match ${t} from matches table`);const{error:D}=await T.delete("matches",{id:t});if(D)throw console.error("Error deleting match:",D),D;const{data:z,error:w}=await T.select("matches","id",{id:t});if(w)console.warn("Could not verify match deletion:",w);else{if(z&&z.length>0)throw console.error(`‚ùå Failed to delete match ${t}`),new Error(`Match deletion failed: match ${t} still exists`);console.log(`‚úÖ Successfully deleted match ${t}`)}console.log(`‚úÖ Successfully deleted match ${t} and all related data`),console.log(`üìã Deletion Summary for Match ${t}:`),console.log("   - Match record: deleted"),console.log(`   - Transactions: ${d.length} deleted`),console.log(`   - Player goals: updated for ${((a=h.goalslista)==null?void 0:a.length)||0} AEK + ${((r=h.goalslistb)==null?void 0:r.length)||0} Real goals`),console.log(`   - Player of the match: ${h.manofthematch?"updated":"none"}`),console.log(`   - Prize money: AEK ${h.prizeaek||0}, Real ${h.prizereal||0} (reversed)`),console.log(`   - Match date: ${h.date}`)}catch(t){throw console.error(`Failed to delete match ${typeof matchId<"u"?matchId:n||"unknown"}:`,t),console.error("Error details:",{matchId:typeof matchId<"u"?matchId:"undefined",matchIdType:typeof matchId,originalId:n,originalIdType:typeof n,errorMessage:t.message,errorStack:t.stack}),t}}class ie{static async submitMatch(a){var z;const{date:r,teama:t="AEK",teamb:o="Real",goalsa:x,goalsb:p,goalslista:y=[],goalslistb:h=[],ownGoalsA:u=0,ownGoalsB:i=0,yellowa:d=0,reda:N=0,yellowb:f=0,redb:m=0,manofthematch:E,editId:D=null}=a;try{const{prizeaek:w,prizereal:c,winner:A,loser:s}=this.calculatePrizeMoney(x,p,d,N,f,m);D&&await this.deleteMatchTransactions(D);const l=[...y],b=[...h];u>0&&b.push({count:u,player:"Eigentore_AEK"}),i>0&&l.push({count:i,player:"Eigentore_Real"});const j={date:r,teama:t,teamb:o,goalsa:parseInt(x)||0,goalsb:parseInt(p)||0,goalslista:y,goalslistb:h,yellowa:parseInt(d)||0,reda:parseInt(N)||0,yellowb:parseInt(f)||0,redb:parseInt(m)||0,manofthematch:E||null,prizeaek:w,prizereal:c},C=await T.insert("matches",j);if(C.error)throw new Error(`Match insert failed: ${C.error.message}`);const F=(z=C.data)==null?void 0:z.id,P=new Date().toISOString().slice(0,10);if(l.length>0){const G=l.filter(I=>typeof I=="object"&&I.player?!I.player.startsWith("Eigentore_"):!I.startsWith("Eigentore_"));await this.updatePlayersGoals(G,"AEK")}if(b.length>0){const G=b.filter(I=>typeof I=="object"&&I.player?!I.player.startsWith("Eigentore_"):!I.startsWith("Eigentore_"));await this.updatePlayersGoals(G,"Real")}E&&await this.updatePlayerOfTheMatchStats(E),await this.processFinancialTransactions({matchId:F,date:P,prizeaek:w,prizereal:c,manofthematch:E,winner:A,loser:s}),await this.decrementBansAfterMatch();try{xe({id:F,goalsa:parseInt(x)||0,goalsb:parseInt(p)||0,date:r})}catch(G){console.warn("Failed to update alcohol calculator:",G)}return{success:!0,matchId:F,message:`Match ${t} vs ${o} (${x}:${p}) erfolgreich hinzugef√ºgt`}}catch(w){throw console.error("Error in submitMatch:",w),new Error(`Fehler beim Speichern des Matches: ${w.message}`)}}static calculatePrizeMoney(a,r,t,o,x,p){let y=0,h=0,u=null,i=null;return a>r?(u="AEK",i="Real"):a<r&&(u="Real",i="AEK"),u&&i&&(u==="AEK"?(y=1e6-r*5e4-t*2e4-o*5e4,h=-(5e5+a*5e4+x*2e4+p*5e4)):(h=1e6-a*5e4-x*2e4-p*5e4,y=-(5e5+r*5e4+t*2e4+o*5e4))),{prizeaek:y,prizereal:h,winner:u,loser:i}}static async updatePlayersGoals(a,r){const t={};if(a.length>0&&typeof a[0]=="object"&&a[0].player!==void 0)a.forEach(o=>{o.player&&!o.player.startsWith("Eigentore_")&&(t[o.player]=(t[o.player]||0)+(o.count||1))});else for(const o of a)!o||!o.trim()||o.startsWith("Eigentore_")||(t[o]=(t[o]||0)+1);for(const[o,x]of Object.entries(t))try{const p=await T.select("players","id, goals",{eq:{name:o,team:r}});if(p.data&&p.data.length>0){const y=p.data[0],h=(y.goals||0)+x;await T.update("players",{goals:h},y.id)}}catch(p){console.warn(`Failed to update goals for player ${o}:`,p)}}static async updatePlayerOfTheMatchStats(a){try{const r=await T.select("players","team",{eq:{name:a}});if(!r.data||r.data.length===0){console.warn(`Player ${a} not found for SdS stats`);return}const t=r.data[0].team,o=await T.select("spieler_des_spiels","*",{eq:{name:a,team:t}});if(o.data&&o.data.length>0){const x=o.data[0];await T.update("spieler_des_spiels",{count:x.count+1},x.id)}else await T.insert("spieler_des_spiels",{name:a,team:t,count:1})}catch(r){console.warn(`Failed to update SdS stats for ${a}:`,r)}}static async processFinancialTransactions({matchId:a,date:r,prizeaek:t,prizereal:o,manofthematch:x,winner:p,loser:y}){const h=await this.getTeamFinance("AEK"),u=await this.getTeamFinance("Real");let i=h.balance||0,d=u.balance||0;const N=x?await this.getSdSBonus(x,"AEK"):0,f=x?await this.getSdSBonus(x,"Real"):0;N>0&&(i+=N,await this.insertTransaction({date:r,type:"SdS Bonus",team:"AEK",amount:N,match_id:a,info:"SdS Bonus"}),await this.updateTeamBalance("AEK",i)),f>0&&(d+=f,await this.insertTransaction({date:r,type:"SdS Bonus",team:"Real",amount:f,match_id:a,info:"SdS Bonus"}),await this.updateTeamBalance("Real",d)),t!==0&&(i+=t,i<0&&(i=0),await this.insertTransaction({date:r,type:"Preisgeld",team:"AEK",amount:t,match_id:a,info:"Preisgeld"}),await this.updateTeamBalance("AEK",i)),o!==0&&(d+=o,d<0&&(d=0),await this.insertTransaction({date:r,type:"Preisgeld",team:"Real",amount:o,match_id:a,info:"Preisgeld"}),await this.updateTeamBalance("Real",d)),p&&y&&await this.processEchtgeldAusgleich({date:r,matchId:a,winner:p,loser:y,aekBalance:i,realBalance:d,prizeaek:t,prizereal:o,sdsBonusAek:N>0?1:0,sdsBonusReal:f>0?1:0,manofthematch:x})}static async getTeamFinance(a){const r=await T.select("finances","*",{eq:{team:a}});return r.data&&r.data.length>0?r.data[0]:{balance:0,debt:0}}static async getSdSBonus(a,r){const t=await T.select("players","team",{eq:{name:a}});return t.data&&t.data.length>0&&t.data[0].team===r?1e5:0}static async insertTransaction(a){return await T.insert("transactions",a)}static async updateTeamBalance(a,r){const t=await T.select("finances","id",{eq:{team:a}});return t.data&&t.data.length>0?await T.update("finances",{balance:r},t.data[0].id):await T.insert("finances",{team:a,balance:r,debt:0})}static async processEchtgeldAusgleich({date:a,matchId:r,winner:t,loser:o,aekBalance:x,realBalance:p,prizeaek:y,prizereal:h,sdsBonusAek:u,sdsBonusReal:i,manofthematch:d}){const N=await this.getTeamFinance("AEK"),f=await this.getTeamFinance("Real"),m={AEK:N.debt||0,Real:f.debt||0},E=(F,P,G)=>{let I=F;G&&(I+=1e5);let V=(Math.abs(P)-I)/1e5;return V<0&&(V=0),5+Math.round(V)},D=E(x,y,u),z=E(p,h,i),w=o==="AEK"?D:z,c=m[t],A=m[o],s=Math.min(c,w*1),l=Math.max(0,c-s),b=w*1-s,j=A+Math.max(0,b),C=await T.select("finances","id",{eq:{team:t}});if(C.data&&C.data.length>0&&await T.update("finances",{debt:l},C.data[0].id),b>0){await this.insertTransaction({date:a,type:"Echtgeld-Ausgleich",team:o,amount:Math.max(0,b),match_id:r,info:"Echtgeld-Ausgleich"});const F=await T.select("finances","id",{eq:{team:o}});F.data&&F.data.length>0&&await T.update("finances",{debt:j},F.data[0].id)}s>0&&await this.insertTransaction({date:a,type:"Echtgeld-Ausgleich (getilgt)",team:t,amount:-s,match_id:r,info:"Echtgeld-Ausgleich (getilgt)"})}static async deleteMatchTransactions(a){try{await ee(a)}catch(r){throw console.error(`Failed to delete match ${a} comprehensively:`,r),r}}static async decrementBansAfterMatch(){try{const a=await T.select("bans","*");if(!a.data)return;for(const r of a.data)if(r.matchesserved<r.totalgames){const t=r.matchesserved+1;await T.update("bans",{matchesserved:t},r.id)}}catch(a){console.warn("Failed to decrement bans:",a)}}}function Ne(){const{data:n}=O("players","*"),[a,r]=$.useState(!1),[t,o]=$.useState({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),[x,p]=$.useState(!1),y=(s,l,b)=>s.reduce((C,F)=>C+F.count,0)+b,h=s=>{o(l=>{const b={...l,...s};b.goalsa=y(b.goalslista,b.ownGoalsA,b.ownGoalsB),b.goalsb=y(b.goalslistb,b.ownGoalsB,b.ownGoalsA);const{prizeaek:j,prizereal:C}=ie.calculatePrizeMoney(b.goalsa,b.goalsb,b.yellowa,b.reda,b.yellowb,b.redb);return b.prizeaek=j,b.prizereal=C,b})},u=(s,l)=>{h({[s]:l})},i=async s=>{s.preventDefault(),p(!0);try{const l=await ie.submitMatch({date:t.date,teama:t.teama.trim(),teamb:t.teamb.trim(),goalsa:t.goalsa,goalsb:t.goalsb,goalslista:t.goalslista,goalslistb:t.goalslistb,ownGoalsA:t.ownGoalsA,ownGoalsB:t.ownGoalsB,yellowa:parseInt(t.yellowa)||0,reda:parseInt(t.reda)||0,yellowb:parseInt(t.yellowb)||0,redb:parseInt(t.redb)||0,manofthematch:t.manofthematch||null});o({teama:"AEK",teamb:"Real",date:new Date().toISOString().split("T")[0],goalsa:0,goalsb:0,goalslista:[],goalslistb:[],ownGoalsA:0,ownGoalsB:0,yellowa:0,reda:0,yellowb:0,redb:0,prizeaek:0,prizereal:0,manofthematch:"",motmTeamFilter:"all"}),r(!1),R.success(l.message),L("match-created",{matchId:l.matchId||"latest",date:t.date,teama:t.teama,teamb:t.teamb,goalsa:t.goalsa,goalsb:t.goalsb,manofthematch:t.manofthematch})}catch(l){console.error("Match submission error:",l),R.error(l.message||"Fehler beim Hinzuf√ºgen des Spiels")}finally{p(!1)}},d=()=>{if(!t.date||t.goalsa===t.goalsb||t.goalsa===0&&t.goalsb===0||!t.manofthematch||t.manofthematch.trim()==="")return!1;if(t.goalsa>0){const s=t.goalslista.reduce((b,j)=>b+j.count,0),l=t.ownGoalsB||0;if(s+l<t.goalsa)return!1}if(t.goalsb>0){const s=t.goalslistb.reduce((b,j)=>b+j.count,0),l=t.ownGoalsA||0;if(s+l<t.goalsb)return!1}return!0},N=()=>{const s=[];if(t.date||s.push("Datum fehlt"),t.goalsa===0&&t.goalsb===0&&s.push("Mindestens ein Tor erforderlich"),t.goalsa===t.goalsb&&(t.goalsa>0||t.goalsb>0)&&s.push("Unentschieden nicht erlaubt"),(!t.manofthematch||t.manofthematch.trim()==="")&&s.push("Spieler des Spiels fehlt"),t.goalsa>0){const l=t.goalslista.reduce((j,C)=>j+C.count,0),b=t.ownGoalsB||0;l+b<t.goalsa&&s.push(`AEK Torsch√ºtzen fehlen (${l+b}/${t.goalsa})`)}if(t.goalsb>0){const l=t.goalslistb.reduce((j,C)=>j+C.count,0),b=t.ownGoalsA||0;l+b<t.goalsb&&s.push(`Real Torsch√ºtzen fehlen (${l+b}/${t.goalsb})`)}return{isValid:s.length===0,issues:s}},f=(s,l)=>{const b=Math.max(0,(t[s]||0)+l);h({[s]:b})},m=s=>n?n.filter(l=>l.team===s):[],E=()=>n?t.motmTeamFilter==="all"?n:n.filter(s=>s.team===t.motmTeamFilter):[],D=(s,l)=>{const b=s==="AEK"?"goalslista":"goalslistb";h({[b]:t[b].map(j=>j.player===l?{...j,count:j.count+1}:j).concat(t[b].find(j=>j.player===l)?[]:[{player:l,count:1}])})},z=(s,l)=>{const b=s==="AEK"?"goalslista":"goalslistb";h({[b]:t[b].map(j=>j.player===l?{...j,count:Math.max(0,j.count-1)}:j).filter(j=>j.count>0)})},w=(s,l)=>{const b=s==="AEK"?"ownGoalsA":"ownGoalsB",j=Math.max(0,t[b]+l);h({[b]:j})},c=(s,l)=>{if(!l)return;const b=s==="AEK"?"goalslista":"goalslistb",j=t[b].find(C=>C.player===l);h(j?{[b]:t[b].map(C=>C.player===l?{...C,count:C.count+1}:C)}:{[b]:[...t[b],{player:l,count:1}]})},A=(s,l)=>{const b=s==="AEK"?"goalslista":"goalslistb";h({[b]:t[b].filter(j=>j.player!==l)})};return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neues Spiel hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"F√ºgen Sie ein neues Spiel zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"‚öΩ"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Spiel hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um ein neues Spiel zu erfassen."}),e.jsxs("button",{onClick:()=>r(!0),className:"btn-primary inline-flex items-center px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neues Spiel erfassen"]})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start sm:items-center justify-center z-[60] p-2 sm:p-4 overflow-y-auto",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg w-full max-w-lg modal-content match-modal-content modal-mobile-safe my-4 sm:my-8",style:{maxHeight:"calc(100vh - 2rem)"},children:e.jsxs("div",{className:"p-4 sm:p-6 overflow-y-auto mobile-safe-bottom",style:{maxHeight:"calc(100vh - 4rem)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 sticky top-0 bg-bg-secondary z-10 pb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neues Spiel"}),e.jsx("button",{onClick:()=>r(!1),className:"text-text-secondary hover:text-text-primary text-2xl font-bold bg-bg-tertiary hover:bg-bg-hover rounded-full w-8 h-8 flex items-center justify-center transition-colors",disabled:x,children:"√ó"})]}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-700 mb-2",children:"‚öΩ Spielpaarung"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("div",{className:"bg-blue-100 text-blue-800 px-4 py-2 rounded-lg font-medium",children:"AEK Athen"}),e.jsx("div",{className:"text-gray-500 font-bold text-xl",children:"vs"}),e.jsx("div",{className:"bg-red-100 text-red-800 px-4 py-2 rounded-lg font-medium",children:"Real Madrid"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:t.date,onChange:s=>u("date",s.target.value),className:"form-input",required:!0,disabled:x})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"‚öΩ Live Torwertung"}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-red-50 rounded-xl p-6 mb-4 text-center border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"text-4xl font-bold text-gray-800 mb-2",children:[e.jsx("span",{className:"text-blue-600",children:t.goalsa}),e.jsx("span",{className:"mx-4 text-gray-400",children:":"}),e.jsx("span",{className:"text-red-600",children:t.goalsb})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:[e.jsx("span",{className:"font-medium text-blue-700",children:"AEK Athen"}),e.jsx("span",{className:"mx-2",children:"vs"}),e.jsx("span",{className:"font-medium text-red-700",children:"Real Madrid"})]}),(t.goalsa>0||t.goalsb>0)&&e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:t.goalsa>t.goalsb?"üèÜ AEK f√ºhrt":t.goalsb>t.goalsa?"üèÜ Real f√ºhrt":"‚öñÔ∏è Unentschieden"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-blue-600 mb-3",children:"‚öΩ AEK Athen Torsch√ºtzen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslista.map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.count," Tor",s.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>z("AEK",s.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:s.count}),e.jsx("button",{type:"button",onClick:()=>D("AEK",s.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"}),e.jsx("button",{type:"button",onClick:()=>A("AEK",s.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:x,title:"Torsch√ºtze entfernen",children:"‚úï"})]})]},`aek-${s.player}-${l}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:s=>{s.target.value&&(c("AEK",s.target.value),s.target.value="")},className:"w-full form-input bg-blue-100 border-blue-300 text-blue-800",disabled:x,children:[e.jsx("option",{value:"",children:"+ Torsch√ºtze hinzuf√ºgen"}),m("AEK").map(s=>e.jsxs("option",{value:s.name,children:[s.name," (",s.position,")"]},s.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Z√§hlen f√ºr Real Madrid"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>w("AEK",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.ownGoalsA===0,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsA}),e.jsx("button",{type:"button",onClick:()=>w("AEK",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-center",children:e.jsx("h5",{className:"text-sm font-medium text-red-600 mb-3",children:"‚öΩ Real Madrid Torsch√ºtzen"})}),e.jsx("div",{className:"space-y-2",children:t.goalslistb.map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between bg-red-50 rounded-lg p-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:s.player}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.count," Tor",s.count!==1?"e":""]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>z("Real",s.player),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:s.count}),e.jsx("button",{type:"button",onClick:()=>D("Real",s.player),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"}),e.jsx("button",{type:"button",onClick:()=>A("Real",s.player),className:"w-8 h-8 bg-gray-500 hover:bg-gray-600 text-white rounded-full flex items-center justify-center text-xs font-bold transition-colors",disabled:x,title:"Torsch√ºtze entfernen",children:"‚úï"})]})]},`real-${s.player}-${l}`))}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("select",{onChange:s=>{s.target.value&&(c("Real",s.target.value),s.target.value="")},className:"w-full form-input bg-red-100 border-red-300 text-red-800",disabled:x,children:[e.jsx("option",{value:"",children:"+ Torsch√ºtze hinzuf√ºgen"}),m("Real").map(s=>e.jsxs("option",{value:s.name,children:[s.name," (",s.position,")"]},s.id))]})}),e.jsxs("div",{className:"flex items-center justify-between bg-orange-50 rounded-lg p-2 border border-orange-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Eigentore"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Z√§hlen f√ºr AEK Athen"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>w("Real",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.ownGoalsB===0,children:"‚àí"}),e.jsx("span",{className:"w-8 text-center font-bold text-lg text-gray-700",children:t.ownGoalsB}),e.jsx("button",{type:"button",onClick:()=>w("Real",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"üü®üü• Karten"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"AEK Athen"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü® Gelbe Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-yellow-50 border border-yellow-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>f("yellowa",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.yellowa<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:t.yellowa}),e.jsx("button",{type:"button",onClick:()=>f("yellowa",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü• Rote Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-red-50 border border-red-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>f("reda",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.reda<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:t.reda}),e.jsx("button",{type:"button",onClick:()=>f("reda",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Real Madrid"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü® Gelbe Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-yellow-50 border border-yellow-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>f("yellowb",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.yellowb<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:t.yellowb}),e.jsx("button",{type:"button",onClick:()=>f("yellowb",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"üü• Rote Karten"}),e.jsxs("div",{className:"flex items-center justify-center bg-red-50 border border-red-300 rounded-lg p-2",children:[e.jsx("button",{type:"button",onClick:()=>f("redb",-1),className:"w-8 h-8 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x||t.redb<=0,children:"‚àí"}),e.jsx("span",{className:"mx-3 text-lg font-bold text-gray-700 min-w-[2rem] text-center",children:t.redb}),e.jsx("button",{type:"button",onClick:()=>f("redb",1),className:"w-8 h-8 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors",disabled:x,children:"+"})]})]})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"‚≠ê Spieler des Spiels"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-text-muted mb-2",children:"Team Filter:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>u("motmTeamFilter","all"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="all"?"bg-gray-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,disabled:x,children:"Alle"}),e.jsx("button",{type:"button",onClick:()=>u("motmTeamFilter","AEK"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="AEK"?"bg-blue-600 text-white":"bg-blue-100 text-blue-700 hover:bg-blue-200"}`,disabled:x,children:"AEK"}),e.jsx("button",{type:"button",onClick:()=>u("motmTeamFilter","Real"),className:`px-3 py-1 rounded-lg text-xs font-medium transition-colors ${t.motmTeamFilter==="Real"?"bg-red-600 text-white":"bg-red-100 text-red-700 hover:bg-red-200"}`,disabled:x,children:"Real"})]})]}),e.jsxs("select",{value:t.manofthematch,onChange:s=>u("manofthematch",s.target.value),className:"form-input",disabled:x,children:[e.jsx("option",{value:"",children:"Keinen Spieler ausw√§hlen"}),E().map(s=>e.jsxs("option",{value:s.name,children:[s.name," (",s.team," - ",s.position,")"]},s.id))]}),!n||n.length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler verf√ºgbar. Bitte f√ºgen Sie erst Spieler hinzu."})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"üí∞ Preisgelder (automatisch berechnet)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld AEK (‚Ç¨)"}),e.jsx("input",{type:"number",value:t.prizeaek,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Preisgeld Real (‚Ç¨)"}),e.jsx("input",{type:"number",value:t.prizereal,className:"form-input bg-gray-100",placeholder:"Automatisch berechnet",disabled:!0,readOnly:!0})]})]}),e.jsx("p",{className:"text-xs text-text-muted mt-2",children:"Basierend auf Ergebnis und Karten: Gewinner 1M‚Ç¨ - (Verlierer-Tore √ó 50k‚Ç¨) - (Karten √ó 20k‚Ç¨/50k‚Ç¨)"})]}),t.goalsa===t.goalsb&&(t.goalsa>0||t.goalsb>0)&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 mr-2",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-red-800",children:"Unentschieden nicht erlaubt"}),e.jsx("p",{className:"text-sm text-red-700",children:"Ein Team muss gewinnen. Unentschieden sind in dieser App nicht m√∂glich."})]})]})}),!t.manofthematch&&(t.goalsa>0||t.goalsb>0)&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-yellow-600 mr-2",children:"‚≠ê"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-yellow-800",children:"Spieler des Spiels erforderlich"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Bitte w√§hlen Sie einen Spieler des Spiels aus, bevor Sie das Match speichern."})]})]})}),d()&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h5",{className:"font-medium text-green-800 mb-3 flex items-center",children:[e.jsx("i",{className:"fas fa-check-circle mr-2"}),"Spiel-Zusammenfassung"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Datum:"}),e.jsx("span",{className:"font-medium text-green-800",children:new Date(t.date).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Ergebnis:"}),e.jsxs("span",{className:"font-medium text-green-800",children:["AEK ",t.goalsa," : ",t.goalsb," Real"]})]}),t.manofthematch&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Spieler des Spiels:"}),e.jsx("span",{className:"font-medium text-green-800",children:t.manofthematch})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-700",children:"Preisgelder:"}),e.jsxs("span",{className:"font-medium text-green-800",children:["AEK ",t.prizeaek.toLocaleString(),"‚Ç¨, Real ",t.prizereal.toLocaleString(),"‚Ç¨"]})]})]})]}),!d()&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-2 mt-1",children:"‚ö†Ô∏è"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-red-800 mb-1",children:"Formular unvollst√§ndig"}),e.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:N().issues.map((s,l)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2",children:"‚Ä¢"}),e.jsx("span",{children:s})]},l))})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4 pb-20 sm:pb-4",children:[e.jsx("button",{type:"button",onClick:()=>r(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:x,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:x||!d(),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${d()?"bg-green-600 hover:bg-green-700 text-white":"bg-red-500 text-white cursor-not-allowed opacity-75"} ${x?"opacity-50 cursor-not-allowed":""}`,children:x?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):d()?"‚úÖ Spiel speichern":`‚ùå ${N().issues[0]||"Eingaben unvollst√§ndig"}`})]})]})]})})})]})}const _=[{value:"AEK",label:"AEK Athen",color:"blue",icon:"aek"},{value:"Real",label:"Real Madrid",color:"red",icon:"real"},{value:"Ehemalige",label:"Ehemalige",color:"gray",icon:"‚ö´"}],U=n=>{const a=_.find(r=>r.value===n);return a?a.label:n};function we(){const{data:n}=O("players","*"),[a,r]=$.useState(!1),[t,o]=$.useState(""),[x,p]=$.useState({player_id:"",type:"",reason:"",customDuration:1}),[y,h]=$.useState(!1),u=(m,E)=>{p(D=>({...D,[m]:E})),m==="team"&&p(D=>({...D,player_id:""}))},i=()=>!n||!t?[]:n.filter(m=>m.team===t),d=async m=>{var E;m.preventDefault(),h(!0);try{const D=n==null?void 0:n.find(l=>l.id===parseInt(x.player_id)),z=W.find(l=>l.value===x.type);if(!D)throw new Error("Spieler nicht gefunden");if(!z)throw new Error("Sperrart nicht gefunden");const c=(E=(await T.select("bans","*",{eq:{player_id:D.id}})).data)==null?void 0:E.find(l=>(l.matchesserved||0)<(l.totalgames||0));if(c)throw new Error(`Spieler "${D.name}" ist bereits gesperrt (${c.totalgames-c.matchesserved} Spiele verbleibend)`);const A=z.fixedDuration?z.duration:x.customDuration,s=await T.insert("bans",{player_id:D.id,team:D.team,type:z.value,totalgames:A,matchesserved:0,reason:x.reason||z.value});if(s.error)throw new Error(`Ban insert failed: ${s.error.message}`);p({player_id:"",type:"",reason:"",customDuration:1}),o(""),r(!1),R.success(`Sperre f√ºr "${D.name}" erfolgreich hinzugef√ºgt!`)}catch(D){console.error("Ban submission error:",D),R.error(D.message||"Fehler beim Hinzuf√ºgen der Sperre")}finally{h(!1)}},N=t&&x.player_id&&x.type,f=W.find(m=>m.value===x.type);return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Sperre hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erstellen Sie eine neue Spielersperre in der Datenbank."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üö´"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Sperre hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Spielersperre zu erfassen."}),e.jsxs("button",{onClick:()=>r(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Sperre erfassen"]})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Sperre"}),e.jsx("button",{onClick:()=>r(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:y,children:"√ó"})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:t,onChange:m=>{o(m.target.value),p(E=>({...E,player_id:""}))},className:"form-input",required:!0,disabled:y,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),_.filter(m=>m.value!=="Ehemalige").map(m=>e.jsx("option",{value:m.value,children:U(m.value)},m.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spieler *"}),e.jsxs("select",{value:x.player_id,onChange:m=>u("player_id",m.target.value),className:"form-input",required:!0,disabled:y||!t,children:[e.jsx("option",{value:"",children:t?"Spieler w√§hlen":"Bitte zuerst Team w√§hlen"}),i().map(m=>e.jsxs("option",{value:m.id,children:[m.name," (",m.position,")"]},m.id))]}),t&&i().length===0&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Keine Spieler im gew√§hlten Team verf√ºgbar."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Sperrart *"}),e.jsxs("select",{value:x.type,onChange:m=>u("type",m.target.value),className:"form-input",required:!0,disabled:y,children:[e.jsx("option",{value:"",children:"Sperrart w√§hlen"}),W.map(m=>e.jsxs("option",{value:m.value,children:[m.icon," ",m.label,m.fixedDuration?` (${m.duration} Spiel${m.duration!==1?"e":""})`:` (1-${m.maxDuration} Spiele)`]},m.value))]})]}),f&&!f.fixedDuration&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Spiele *"}),e.jsx("select",{value:x.customDuration,onChange:m=>u("customDuration",parseInt(m.target.value)),className:"form-input",required:!0,disabled:y,children:Array.from({length:f.maxDuration},(m,E)=>E+1).map(m=>e.jsxs("option",{value:m,children:[m," Spiel",m!==1?"e":""]},m))}),e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["W√§hlen Sie zwischen ",f.minDuration," und ",f.maxDuration," Spielen"]})]}),f&&f.fixedDuration&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Gelb-Rote Karten haben immer eine feste Sperre von 1 Spiel."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Zus√§tzlicher Grund (optional)"}),e.jsx("input",{type:"text",value:x.reason,onChange:m=>u("reason",m.target.value),className:"form-input",placeholder:"Weitere Details zur Sperre...",disabled:y})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>r(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:y,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!N||y||!n||n.length===0,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:y?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Sperrarten"}),e.jsx("div",{className:"space-y-2",children:W.map(m=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:m.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:m.label})]}),e.jsx("span",{className:"text-sm text-text-muted",children:m.fixedDuration?`${m.duration} Spiel${m.duration!==1?"e":""} (fest)`:`1-${m.maxDuration} Spiele (variabel)`})]},m.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-yellow-50 border-yellow-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-yellow-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie die Sperre in der Sperren-√úbersicht einsehen und verwalten."})]})]})})]})}const oe=[{value:"TH",label:"Torwart (TH)"},{value:"IV",label:"Innenverteidiger (IV)"},{value:"AV",label:"Au√üenverteidiger (AV)"},{value:"ZM",label:"Zentrales Mittelfeld (ZM)"},{value:"OM",label:"Offensives Mittelfeld (OM)"},{value:"ST",label:"St√ºrmer (ST)"}];function Se(){const[n,a]=$.useState(!1),[r,t]=$.useState({name:"",team:"",position:"",goals:0,value:0}),[o,x]=$.useState(!1),p=(u,i)=>{t(d=>({...d,[u]:i}))},y=async u=>{u.preventDefault(),x(!0);try{const i=await T.select("players","*",{eq:{name:r.name.trim(),team:r.team.trim()}});if(i.data&&i.data.length>0)throw new Error(`Spieler "${r.name}" existiert bereits im Team "${r.team}"`);const d=await T.insert("players",{name:r.name.trim(),team:r.team.trim(),position:r.position.trim().toUpperCase(),goals:parseInt(r.goals)||0,value:parseFloat(r.value)||0});if(d.error)throw new Error(`Player insert failed: ${d.error.message}`);t({name:"",team:"",position:"",goals:0,value:0}),a(!1),R.success(`Spieler "${r.name}" erfolgreich hinzugef√ºgt!`)}catch(i){console.error("Player submission error:",i),R.error(i.message||"Fehler beim Hinzuf√ºgen des Spielers")}finally{x(!1)}},h=r.name&&r.team&&r.position&&r.value!=="";return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neuen Spieler hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"F√ºgen Sie einen neuen Spieler zur Datenbank hinzu."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üë§"}),e.jsxs("h4",{className:"text-lg font-medium text-text-primary mb-2",children:[e.jsx("i",{className:"fas fa-user-plus mr-2"}),"Spieler hinzuf√ºgen"]}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um einen neuen Spieler zu erfassen."}),e.jsxs("button",{onClick:()=>a(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neuen Spieler erfassen"]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neuer Spieler"}),e.jsx("button",{onClick:()=>a(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:o,children:"√ó"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Spielername *"}),e.jsx("input",{type:"text",value:r.name,onChange:u=>p("name",u.target.value),className:"form-input",placeholder:"z.B. Max Mustermann",required:!0,disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:r.team,onChange:u=>p("team",u.target.value),className:"form-input",required:!0,disabled:o,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),_.map(u=>e.jsx("option",{value:u.value,children:U(u.value)},u.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position *"}),e.jsxs("select",{value:r.position,onChange:u=>p("position",u.target.value),className:"form-input",required:!0,disabled:o,children:[e.jsx("option",{value:"",children:"Position w√§hlen"}),oe.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Marktwert (Millionen ‚Ç¨) *"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:r.value,onChange:u=>p("value",u.target.value),onFocus:u=>u.target.select(),className:"form-input",placeholder:"0.0",disabled:o}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Marktwert in Millionen Euro (z.B. 1.5 f√ºr 1.5M ‚Ç¨)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Anzahl Tore"}),e.jsx("input",{type:"number",min:"0",value:r.goals,onChange:u=>p("goals",u.target.value),onFocus:u=>u.target.select(),className:"form-input",placeholder:"0",disabled:o})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:o,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!h||o,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Teams"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:_.map(u=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${u.color==="blue"?"text-blue-600":u.color==="red"?"text-red-600":"text-gray-600"}`,children:U(u.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",u.value,")"]})]},u.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Positionen"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:oe.map(u=>e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:e.jsx("span",{className:"font-medium text-text-primary text-sm",children:u.label})},u.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-green-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-green-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie den Spieler in der Kader-√úbersicht einsehen und verwalten."})]})]})})]})}const ce=[{value:"Preisgeld",label:"Preisgeld",icon:"üèÜ"},{value:"Strafe",label:"Strafe",icon:"üìâ"},{value:"Spielerkauf",label:"Spielerkauf",icon:"üë§"},{value:"Spielerverkauf",label:"Spielerverkauf",icon:"üí∞"},{value:"Echtgeld-Ausgleich",label:"Echtgeld-Ausgleich",icon:"üí≥"},{value:"SdS Bonus",label:"Spieler des Spiels Bonus",icon:"‚≠ê"},{value:"Sonstiges",label:"Sonstiges",icon:"üìà"}];function ke(){const[n,a]=$.useState(!1),[r,t]=$.useState({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),[o,x]=$.useState(!1),p=(i,d)=>{t(N=>({...N,[i]:d}))},y=async i=>{i.preventDefault(),x(!0);try{const d=parseFloat(r.amount),N=await T.insert("transactions",{date:r.date,type:r.type.trim(),team:r.team.trim(),amount:d,info:r.info.trim(),match_id:null});if(N.error)throw new Error(`Transaction insert failed: ${N.error.message}`);await h(r.team.trim(),r.type.trim(),d),t({team:"",type:"",amount:"",info:"",date:new Date().toISOString().split("T")[0]}),a(!1),R.success("Transaktion erfolgreich hinzugef√ºgt!")}catch(d){console.error("Transaction submission error:",d),R.error(d.message||"Fehler beim Hinzuf√ºgen der Transaktion")}finally{x(!1)}},h=async(i,d,N)=>{try{const f=await T.select("finances","*",{eq:{team:i}});let m=f.data&&f.data.length>0?f.data[0]:{team:i,balance:0,debt:0},E={};if(d==="Echtgeld-Ausgleich")E.debt=(m.debt||0)+N;else{let D=(m.balance||0)+N;D<0&&(D=0),E.balance=D}m.id?await T.update("finances",E,m.id):await T.insert("finances",{team:i,balance:E.balance||0,debt:E.debt||0})}catch(f){console.warn("Failed to update finances:",f)}},u=r.team&&r.type&&r.amount&&r.date;return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Neue Transaktion hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Erfassen Sie eine neue finanzielle Transaktion."})]}),e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"üí∞"}),e.jsx("h4",{className:"text-lg font-medium text-text-primary mb-2",children:"Transaktion hinzuf√ºgen"}),e.jsx("p",{className:"text-text-muted mb-6",children:"Klicken Sie auf den Button, um eine neue Transaktion zu erfassen."}),e.jsxs("button",{onClick:()=>a(!0),className:"btn-primary",children:[e.jsx("i",{className:"fas fa-plus mr-2"}),"Neue Transaktion erfassen"]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsx("div",{className:"bg-bg-secondary rounded-lg max-w-md w-full modal-content modal-mobile-safe",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-text-primary",children:"Neue Transaktion"}),e.jsx("button",{onClick:()=>a(!1),className:"text-text-muted hover:text-text-primary text-2xl",disabled:o,children:"√ó"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Team *"}),e.jsxs("select",{value:r.team,onChange:i=>p("team",i.target.value),className:"form-input",required:!0,disabled:o,children:[e.jsx("option",{value:"",children:"Team w√§hlen"}),_.filter(i=>i.value!=="Ehemalige").map(i=>e.jsx("option",{value:i.value,children:U(i.value)},i.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Transaktionsart *"}),e.jsxs("select",{value:r.type,onChange:i=>p("type",i.target.value),className:"form-input",required:!0,disabled:o,children:[e.jsx("option",{value:"",children:"Typ w√§hlen"}),ce.map(i=>e.jsxs("option",{value:i.value,children:[i.icon," ",i.label]},i.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Betrag (‚Ç¨) *"}),e.jsx("input",{type:"number",step:"0.01",value:r.amount,onChange:i=>p("amount",i.target.value),onFocus:i=>i.target.select(),className:"form-input",placeholder:"0.00",required:!0,disabled:o}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Negative Werte f√ºr Ausgaben, positive f√ºr Einnahmen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Beschreibung"}),e.jsx("input",{type:"text",value:r.info,onChange:i=>p("info",i.target.value),className:"form-input",placeholder:"Zus√§tzliche Informationen...",disabled:o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Datum *"}),e.jsx("input",{type:"date",value:r.date,onChange:i=>p("date",i.target.value),className:"form-input",required:!0,disabled:o})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-border-light rounded-lg text-text-secondary hover:bg-bg-tertiary transition-colors",disabled:o,children:"Abbrechen"}),e.jsx("button",{type:"submit",disabled:!u||o,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"spinner w-4 h-4 mr-2"}),"Speichern..."]}):"Speichern"})]})]})]})})}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Transaktionsarten"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ce.map(i=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:i.icon}),e.jsx("span",{className:"font-medium text-text-primary",children:i.label})]},i.value))})]}),e.jsxs("div",{className:"mt-6 modern-card",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Verf√ºgbare Teams"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:_.filter(i=>i.value!=="Ehemalige").map(i=>e.jsxs("div",{className:"p-3 bg-bg-secondary rounded-lg text-center",children:[e.jsx("span",{className:`font-medium ${i.color==="blue"?"text-blue-600":"text-red-600"}`,children:U(i.value)}),e.jsxs("div",{className:"text-xs text-text-muted mt-1",children:["(",i.value,")"]})]},i.value))})]}),e.jsx("div",{className:"mt-6 modern-card bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:e.jsx("i",{className:"fas fa-info-circle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Hinweis"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Nach dem Hinzuf√ºgen k√∂nnen Sie die Transaktion in der Finanzen-√úbersicht einsehen."})]})]})})]})}function Ee(){var ne;const[n,a]=$.useState("players"),[r,t]=$.useState(!1),[o,x]=$.useState(""),[p,y]=$.useState(new Set),{data:h,refetch:u}=O("players","*",{order:{column:"id",ascending:!1}}),{data:i,refetch:d}=O("matches","*",{order:{column:"date",ascending:!1}}),{data:N,refetch:f}=O("bans","*",{order:{column:"id",ascending:!1}}),{data:m,refetch:E}=O("transactions","*",{order:{column:"date",ascending:!1}}),{remove:D}=X("players"),{remove:z}=X("bans"),{remove:w}=X("transactions"),c=[{id:"players",label:"Spieler l√∂schen",icon:"fas fa-users"},{id:"matches",label:"Spiele l√∂schen (Einzel & Bulk)",icon:"fas fa-futbol"},{id:"bans",label:"Sperren l√∂schen",icon:"fas fa-ban"},{id:"transactions",label:"Transaktionen l√∂schen",icon:"fas fa-euro-sign"}],A=g=>{a(g),x(""),y(new Set)},s=(g,S)=>{const k=new Set(p);S?k.add(g):k.delete(g),y(k)},l=g=>{const S=Y(g);p.size===S.length?y(new Set):y(new Set(S.map(k=>k.id)))},b=async()=>{if(p.size===0){R.error("Keine Spiele ausgew√§hlt");return}const S=((i==null?void 0:i.filter(M=>p.has(M.id)))||[]).reduce((M,H)=>M+((m==null?void 0:m.filter(Q=>Q.match_id===H.id).length)||0),0);let k=`Sind Sie sicher, dass Sie ${p.size} ausgew√§hlte Spiele l√∂schen m√∂chten?`;if(S>0&&(k+=`

Achtung: ${S} zugeh√∂rige Transaktion(en) werden ebenfalls gel√∂scht.`),k+=`

Dieser Vorgang kann nicht r√ºckg√§ngig gemacht werden!`,!confirm(k))return;t(!0);let v=0,B=0;try{for(const M of p)try{console.log(`Deleting match ${M}`),await ee(M),v++}catch(H){console.error(`Failed to delete match ${M}:`,H),B++}y(new Set),v>0&&B===0?R.success(`Alle ${v} Spiele erfolgreich gel√∂scht`):v>0&&B>0?R.success(`${v} Spiele gel√∂scht, ${B} fehlgeschlagen`):R.error(`Alle ${B} L√∂schvorg√§nge fehlgeschlagen`),d(),E(),setTimeout(()=>{d(),E()},1e3)}catch(M){console.error("Bulk delete error:",M),R.error("Fehler beim Bulk-L√∂schen: "+M.message),y(new Set)}finally{t(!1)}},j=()=>{switch(n){case"players":return{total:(h==null?void 0:h.length)||0,filtered:V(h).length};case"matches":return{total:(i==null?void 0:i.length)||0,filtered:Y(i).length};case"bans":return{total:(N==null?void 0:N.length)||0,filtered:se(N).length};case"transactions":return{total:(m==null?void 0:m.length)||0,filtered:ae(m).length};default:return{total:0,filtered:0}}},C=async g=>{const S=(N==null?void 0:N.filter(v=>v.player_id===g.id||v.player_name===g.name))||[];let k=`Sind Sie sicher, dass Sie ${g.name} (${g.team}) l√∂schen m√∂chten?`;if(S.length>0&&(k+=`

Achtung: ${S.length} zugeh√∂rige Sperre(n) werden ebenfalls gel√∂scht.`),g.goals&&g.goals>0&&(k+=`
Der Spieler hat ${g.goals} Tor(e) erzielt.`),!!confirm(k)){t(!0);try{await D(g.id),R.success(`Spieler ${g.name} erfolgreich gel√∂scht`),u(),S.length>0&&f()}catch(v){R.error("Fehler beim L√∂schen des Spielers: "+v.message)}finally{t(!1)}}},F=async g=>{const S=(m==null?void 0:m.filter(B=>B.match_id===g.id))||[],k=`AEK ${g.goalsa||0} - ${g.goalsb||0} Real`;let v=`Sind Sie sicher, dass Sie das Spiel vom ${new Date(g.date).toLocaleDateString("de-DE")} (${k}) l√∂schen m√∂chten?`;if(S.length>0&&(v+=`

Achtung: ${S.length} zugeh√∂rige Transaktion(en) werden ebenfalls gel√∂scht.`),g.manofthematch&&(v+=`
Spieler des Spiels: ${g.manofthematch}`),!!confirm(v)){t(!0);try{console.log(`Attempting to delete match ${g.id}`),await ee(g.id),console.log(`Successfully deleted match ${g.id}`),R.success("Spiel erfolgreich gel√∂scht"),d(),E(),setTimeout(()=>{d(),E()},1e3)}catch(B){console.error("Error deleting match:",B);let M="Fehler beim L√∂schen des Spiels: ";B.message.includes("not found")?M+=`Spiel mit ID ${g.id} wurde nicht in der Datenbank gefunden. M√∂glicherweise wurde es bereits gel√∂scht.`:B.message.includes("Invalid match ID")?M+=`Ung√ºltige Spiel-ID: ${g.id}`:B.message.includes("fetch failed")||B.message.includes("network")?M+="Netzwerkfehler. Bitte √ºberpr√ºfen Sie Ihre Internetverbindung.":M+=B.message,R.error(M)}finally{t(!1)}}},P=async g=>{var B;const S=g.player_name||(g.player_id&&h?(B=h.find(M=>M.id===g.player_id))==null?void 0:B.name:"Unbekannter Spieler"),k=Math.max(0,(g.totalgames||0)-(g.matchesserved||0));let v=`Sind Sie sicher, dass Sie die Sperre f√ºr ${S} l√∂schen m√∂chten?`;if(v+=`
Sperrtyp: ${g.type}`,k>0?v+=`
Noch ${k} Spiel(e) verbleibend`:v+=`
Sperre bereits abgesessen`,g.reason&&(v+=`
Grund: ${g.reason}`),!!confirm(v)){t(!0);try{await z(g.id),R.success(`Sperre f√ºr ${S} erfolgreich gel√∂scht`),f()}catch(M){R.error("Fehler beim L√∂schen der Sperre: "+M.message)}finally{t(!1)}}},G=async g=>{const S=g.match_id&&i?i.find(v=>v.id===g.match_id):null;let k=`Sind Sie sicher, dass Sie die Transaktion "${g.type}" l√∂schen m√∂chten?`;if(k+=`
Betrag: ${g.amount>0?"+":""}${g.amount}M ‚Ç¨ (${g.team})`,g.date&&(k+=`
Datum: ${new Date(g.date).toLocaleDateString("de-DE")}`),g.info&&(k+=`
Info: ${g.info}`),S&&(k+=`
Zugeh√∂riges Spiel: ${new Date(S.date).toLocaleDateString("de-DE")} (AEK ${S.goalsa||0} - ${S.goalsb||0} Real)`),!!confirm(k)){t(!0);try{await w(g.id),R.success("Transaktion erfolgreich gel√∂scht"),E()}catch(v){R.error("Fehler beim L√∂schen der Transaktion: "+v.message)}finally{t(!1)}}},I=g=>{const S=_.find(k=>k.value===g);return S?S.icon:"‚ö´"},V=g=>o?(g||[]).filter(S=>{var k,v,B;return((k=S.name)==null?void 0:k.toLowerCase().includes(o.toLowerCase()))||((v=S.team)==null?void 0:v.toLowerCase().includes(o.toLowerCase()))||((B=S.position)==null?void 0:B.toLowerCase().includes(o.toLowerCase()))}):g||[],Y=g=>o?(g||[]).filter(S=>{var k;return new Date(S.date).toLocaleDateString("de-DE").includes(o)||((k=S.manofthematch)==null?void 0:k.toLowerCase().includes(o.toLowerCase()))}):g||[],se=g=>o?(g||[]).filter(S=>{var v,B,M,H;const k=S.player_name||(S.player_id&&h?(v=h.find(Q=>Q.id===S.player_id))==null?void 0:v.name:"");return(k==null?void 0:k.toLowerCase().includes(o.toLowerCase()))||((B=S.type)==null?void 0:B.toLowerCase().includes(o.toLowerCase()))||((M=S.team)==null?void 0:M.toLowerCase().includes(o.toLowerCase()))||((H=S.reason)==null?void 0:H.toLowerCase().includes(o.toLowerCase()))}):g||[],ae=g=>o?(g||[]).filter(S=>{var k,v,B,M;return((k=S.type)==null?void 0:k.toLowerCase().includes(o.toLowerCase()))||((v=S.team)==null?void 0:v.toLowerCase().includes(o.toLowerCase()))||((B=S.info)==null?void 0:B.toLowerCase().includes(o.toLowerCase()))||((M=S.amount)==null?void 0:M.toString().includes(o))}):g||[],re=()=>{const g=V(h);return!g||g.length===0?e.jsx("p",{className:"text-text-muted text-center py-4",children:o?"Keine Spieler gefunden":"Keine Spieler vorhanden"}):e.jsx("div",{className:"space-y-2",children:g.map(S=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:I(S.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:S.name}),e.jsxs("p",{className:"text-sm text-text-muted",children:[S.team," ‚Ä¢ ",S.position,S.goals!==void 0&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ ",S.goals," Tore"]})]})]})]}),e.jsxs("button",{onClick:()=>C(S),disabled:r,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},S.id))})},ge=()=>{const g=Y(i);if(!g||g.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:o?"Keine Spiele gefunden":"Keine Spiele vorhanden"});const S=g.length>0&&g.every(v=>p.has(v.id)),k=p.size>0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-secondary rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:()=>l(i),className:"w-4 h-4 text-accent-primary focus:ring-accent-primary border-gray-300 rounded"}),e.jsxs("span",{className:"text-sm text-text-primary",children:[S?"Alle abw√§hlen":"Alle ausw√§hlen"," (",g.length,")"]})]}),p.size>0&&e.jsxs("span",{className:"text-sm text-accent-primary font-medium",children:[p.size," ausgew√§hlt"]})]}),k&&e.jsxs("button",{onClick:b,disabled:r,className:"btn-primary btn-sm bg-red-600 hover:bg-red-700 text-white disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),p.size," Spiele l√∂schen"]})]}),e.jsx("div",{className:"space-y-2",children:g.map(v=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("label",{className:"flex items-center cursor-pointer",children:e.jsx("input",{type:"checkbox",checked:p.has(v.id),onChange:B=>s(v.id,B.target.checked),className:"w-4 h-4 text-accent-primary focus:ring-accent-primary border-gray-300 rounded"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-text-primary",children:["ID ",v.id," ‚Ä¢ ",new Date(v.date).toLocaleDateString("de-DE")]}),e.jsxs("p",{className:"text-sm text-text-muted",children:["AEK ",v.goalsa||0," - ",v.goalsb||0," Real"]}),v.manofthematch&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:[e.jsx("i",{className:"fas fa-star mr-1"}),"SdS: ",v.manofthematch]})]}),e.jsxs("button",{onClick:()=>F(v),disabled:r,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"Einzeln l√∂schen"]})]})})]},v.id))})]})},be=()=>{const g=se(N);if(!g||g.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:o?"Keine Sperren gefunden":"Keine Sperren vorhanden"});const S=v=>{if(v.player_name)return v.player_name;if(v.player_id&&h){const B=h.find(M=>M.id===v.player_id);return B?B.name:"Unbekannter Spieler"}return"Unbekannter Spieler"},k=v=>{const B=(v.totalgames||0)-(v.matchesserved||0);return Math.max(0,B)};return e.jsx("div",{className:"space-y-2",children:g.map(v=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:I(v.team)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:S(v)}),e.jsxs("p",{className:"text-sm text-text-muted",children:[v.type," ‚Ä¢ ",v.totalgames||0," Spiele",k(v)>0?` (${k(v)} verbleibend)`:" (abgesessen)"]}),v.reason&&e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["Grund: ",v.reason]})]})]}),e.jsxs("button",{onClick:()=>P(v),disabled:r,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},v.id))})},fe=()=>{const g=ae(m);if(!g||g.length===0)return e.jsx("p",{className:"text-text-muted text-center py-4",children:o?"Keine Transaktionen gefunden":"Keine Transaktionen vorhanden"});const S=k=>{if(!k.match_id||!i)return null;const v=i.find(B=>B.id===k.match_id);return v?`Match: ${new Date(v.date).toLocaleDateString("de-DE")} (AEK ${v.goalsa||0} - ${v.goalsb||0} Real)`:null};return e.jsx("div",{className:"space-y-2",children:g.map(k=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:I(k.team)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:k.type}),e.jsxs("p",{className:"text-sm text-text-muted",children:[e.jsxs("span",{className:k.amount>0?"text-green-600":"text-red-600",children:[k.amount>0?"+":"",k.amount,"M ‚Ç¨"]}),k.date&&e.jsxs("span",{className:"ml-2",children:["‚Ä¢ ",new Date(k.date).toLocaleDateString("de-DE")]})]}),k.info&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:k.info}),S(k)&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[e.jsx("i",{className:"fas fa-futbol mr-1"}),S(k)]})]})]}),e.jsxs("button",{onClick:()=>G(k),disabled:r,className:"btn-secondary btn-sm text-accent-red hover:bg-red-50 disabled:opacity-50",children:[e.jsx("i",{className:"fas fa-trash mr-1"}),"L√∂schen"]})]},k.id))})},pe=()=>{switch(n){case"players":return re();case"matches":return ge();case"bans":return be();case"transactions":return fe();default:return re()}};return e.jsxs("div",{className:"p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Daten l√∂schen"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Verwalten Sie die L√∂schung von Spielern, Spielen, Sperren und Transaktionen."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-6",children:c.map(g=>e.jsxs("button",{onClick:()=>A(g.id),className:`p-3 rounded-lg text-sm font-medium transition-colors ${n===g.id?"bg-accent-red text-white":"bg-bg-tertiary text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${g.icon} mr-2`}),g.label]},g.id))}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:`${(ne=c.find(g=>g.id===n))==null?void 0:ne.label.replace(" l√∂schen","")} durchsuchen...`,value:o,onChange:g=>x(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-accent-red focus:border-transparent text-text-primary bg-bg-secondary"}),e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"fas fa-search text-text-muted"})}),o&&e.jsx("button",{onClick:()=>x(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-text-muted hover:text-text-primary",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[o&&e.jsxs("p",{className:"text-xs text-text-muted",children:[e.jsx("i",{className:"fas fa-filter mr-1"}),"Gefiltert nach: ‚Äú",o,"‚Äù"]}),e.jsx("p",{className:"text-xs text-text-muted ml-auto",children:(()=>{const g=j();return o?`${g.filtered} von ${g.total} Eintr√§gen`:`${g.total} Eintr√§ge`})()})]})]}),e.jsxs("div",{className:"modern-card",children:[r&&e.jsx(ue,{message:"L√∂sche..."}),!r&&pe()]}),e.jsx("div",{className:"mt-6 modern-card bg-red-50 border-red-200",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-red-600 mr-3",children:e.jsx("i",{className:"fas fa-exclamation-triangle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Achtung"}),e.jsx("p",{className:"text-red-700 text-sm",children:"Das L√∂schen von Daten ist permanent und kann nicht r√ºckg√§ngig gemacht werden. Bitte √ºberpr√ºfen Sie Ihre Auswahl sorgf√§ltig, bevor Sie fortfahren."})]})]})})]})}function Ae({data:n=[],searchFields:a=[],filterOptions:r=[],onResults:t,placeholder:o="Suchen...",showCount:x=!0,searchExtractor:p}){const[y,h]=$.useState(""),[u,i]=$.useState({}),[d,N]=$.useState(""),[f,m]=$.useState("asc"),E=$.useRef(null),D=$.useMemo(()=>{let s=[...n];if(y.trim()){const l=y.toLowerCase().trim();s=s.filter(b=>{if(p){const j=p(b);return j&&j.toLowerCase().includes(l)}return a.some(j=>{const C=J(b,j);return C&&C.toString().toLowerCase().includes(l)})})}return Object.entries(u).forEach(([l,b])=>{if(b&&b!=="all"){const j=r.find(C=>C.key===l);j&&j.filterFn?s=s.filter(C=>j.filterFn(C,b)):s=s.filter(C=>J(C,l)===b)}}),d&&s.sort((l,b)=>{const j=J(l,d),C=J(b,d);let F=0;return typeof j=="number"&&typeof C=="number"?F=j-C:j instanceof Date&&C instanceof Date?F=j.getTime()-C.getTime():F=String(j).localeCompare(String(C)),f==="desc"?-F:F}),s},[n,y,u,d,f,a,r,p]);$.useEffect(()=>{t&&JSON.stringify(D)!==E.current&&(E.current=JSON.stringify(D),t(D))},[D,t]);const z=(s,l)=>{i(b=>({...b,[s]:l}))},w=s=>{d===s?m(f==="asc"?"desc":"asc"):(N(s),m("asc"))},c=()=>{h(""),i({}),N(""),m("asc")},A=y||Object.values(u).some(s=>s&&s!=="all")||d;return e.jsxs("div",{className:"bg-bg-primary border border-border-light rounded-lg shadow-sm mb-4",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center",children:e.jsx("span",{className:"text-text-secondary","aria-hidden":"true",children:"üîç"})}),e.jsx("input",{type:"text",value:y,onChange:s=>h(s.target.value),placeholder:`${o} (Strg+K f√ºr globale Suche)`,className:"w-full pl-10 pr-20 py-2 bg-bg-secondary border border-border-light rounded-lg text-text-primary placeholder-text-secondary focus:outline-none focus:ring-2 focus:ring-primary-green focus:border-transparent"}),e.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center gap-1 pr-3",children:[e.jsx("button",{onClick:()=>{const s=new CustomEvent("global-search-toggle");window.dispatchEvent(s)},className:"text-text-secondary hover:text-primary-green transition-colors p-1 rounded",title:"Globale Suche √∂ffnen (Strg+K)",children:e.jsx("span",{"aria-hidden":"true",children:"üåê"})}),y&&e.jsx("button",{onClick:()=>h(""),className:"text-text-secondary hover:text-text-primary transition-colors p-1 rounded",title:"Suchfeld leeren",children:e.jsx("span",{"aria-hidden":"true",children:"‚úï"})})]})]})}),(r.length>0||d)&&e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[r.map(s=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"text-sm font-medium text-text-primary",children:[s.label,":"]}),e.jsxs("select",{value:u[s.key]||"",onChange:l=>z(s.key,l.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Alle"}),s.options.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]})]},s.key)),a.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-text-primary",children:"Sortieren:"}),e.jsxs("select",{value:d,onChange:s=>N(s.target.value),className:"px-3 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green",children:[e.jsx("option",{value:"",children:"Standard"}),a.map(s=>e.jsx("option",{value:s,children:de(s)},s))]}),d&&e.jsx("button",{onClick:()=>w(d),className:"px-2 py-1 bg-bg-secondary border border-border-light rounded text-sm text-text-primary hover:bg-bg-tertiary transition-colors duration-200",title:`Sortierung: ${f==="asc"?"Aufsteigend":"Absteigend"}`,children:f==="asc"?"‚Üë":"‚Üì"})]}),A&&e.jsx("button",{onClick:c,className:"px-3 py-1 bg-red-100 text-red-800 border border-red-200 rounded text-sm hover:bg-red-200 transition-colors duration-200",children:"Filter zur√ºcksetzen"})]})}),x&&e.jsx("div",{className:"px-4 py-2 bg-bg-secondary border-b border-border-light",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:D.length===n.length?`${n.length} Eintr√§ge`:`${D.length} von ${n.length} Eintr√§gen`}),A&&e.jsxs("div",{className:"flex items-center gap-2",children:[y&&e.jsxs("span",{className:"bg-primary-green bg-opacity-10 text-primary-green px-2 py-1 rounded text-xs",children:['üîç "',y,'"']}),Object.entries(u).filter(([,s])=>s&&s!=="all").map(([s,l])=>{const b=r.find(C=>C.key===s),j=b==null?void 0:b.options.find(C=>C.value===l);return e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:[b==null?void 0:b.label,": ",(j==null?void 0:j.label)||l]},s)}),d&&e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs",children:["üìä ",de(d)," ",f==="asc"?"‚Üë":"‚Üì"]})]})]})})]})}function J(n,a){return!n||!a?"":a.split(".").reduce((r,t)=>r&&r[t]!==void 0?r[t]:"",n)}function de(n){return{name:"Name",team:"Team",position:"Position",value:"Wert",date:"Datum",goalsa:"AEK Tore",goalsb:"Real Tore",type:"Typ",amount:"Betrag",description:"Beschreibung",totalgames:"Gesamt Spiele",matchesserved:"Gespielte Spiele"}[n]||n.charAt(0).toUpperCase()+n.slice(1)}function me({onNavigate:n}){const[a,r]=$.useState("players"),[t,o]=$.useState([]),{data:x,loading:p}=O("players","*"),{data:y,loading:h}=O("matches","*",{order:{column:"date",ascending:!1}}),{data:u,loading:i}=O("transactions","*",{order:{column:"date",ascending:!1}}),{data:d,loading:N}=O("bans","*",{order:{column:"id",ascending:!1}}),f=p||h||i||N,m=[{id:"players",label:"Spieler",icon:"fas fa-users",data:x||[],searchFields:["name","position","team","value"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"},{value:"Ehemalige",label:"Ehemalige"}]},{key:"position",label:"Position",options:[{value:"TH",label:"Torwart"},{value:"IV",label:"Innenverteidiger"},{value:"LV",label:"Linksverteidiger"},{value:"RV",label:"Rechtsverteidiger"},{value:"ZDM",label:"Defensives Mittelfeld"},{value:"ZM",label:"Zentrales Mittelfeld"},{value:"ZOM",label:"Offensives Mittelfeld"},{value:"LM",label:"Linkes Mittelfeld"},{value:"RM",label:"Rechtes Mittelfeld"},{value:"LF",label:"Linker Fl√ºgel"},{value:"RF",label:"Rechter Fl√ºgel"},{value:"ST",label:"St√ºrmer"}]}]},{id:"matches",label:"Spiele",icon:"fas fa-futbol",data:y||[],searchFields:["date","goalsa","goalsb","goalscorers","manofthematch","teama","teamb"],filterOptions:[],searchExtractor:w=>{const c=[];if(w.date&&c.push(new Date(w.date).toLocaleDateString("de-DE")),w.teama&&c.push(w.teama),w.teamb&&c.push(w.teamb),w.goalsa!==void 0&&c.push(w.goalsa.toString()),w.goalsb!==void 0&&c.push(w.goalsb.toString()),w.goalslista)try{const A=typeof w.goalslista=="string"?JSON.parse(w.goalslista):w.goalslista;Array.isArray(A)&&A.forEach(s=>{typeof s=="string"?c.push(s):s&&s.player&&c.push(s.player)})}catch{}if(w.goalslistb)try{const A=typeof w.goalslistb=="string"?JSON.parse(w.goalslistb):w.goalslistb;Array.isArray(A)&&A.forEach(s=>{typeof s=="string"?c.push(s):s&&s.player&&c.push(s.player)})}catch{}return w.manofthematch&&(c.push(w.manofthematch),c.push("Spieler des Spiels"),c.push("SdS")),c.join(" ").toLowerCase()}},{id:"transactions",label:"Transaktionen",icon:"fas fa-euro-sign",data:u||[],searchFields:["type","description","amount","date"],filterOptions:[{key:"type",label:"Typ",options:[{value:"transfer",label:"Transfer"},{value:"preis",label:"Preisgeld"},{value:"strafe",label:"Strafe"},{value:"sonstige",label:"Sonstige"}],filterFn:(w,c)=>{var l,b;const A=((l=w.type)==null?void 0:l.toLowerCase())||"",s=((b=w.description)==null?void 0:b.toLowerCase())||"";switch(c){case"transfer":return A.includes("transfer")||s.includes("transfer");case"preis":return A.includes("preis")||s.includes("preis")||w.amount>0;case"strafe":return A.includes("strafe")||s.includes("strafe");case"sonstige":return!A.includes("transfer")&&!A.includes("preis")&&!A.includes("strafe");default:return!0}}}]},{id:"bans",label:"Sperren",icon:"fas fa-ban",data:d||[],searchFields:["player_name","team","type","reason"],filterOptions:[{key:"team",label:"Team",options:[{value:"AEK",label:"AEK Athen"},{value:"Real",label:"Real Madrid"}]},{key:"type",label:"Typ",options:[{value:"Gelbe Karte",label:"Gelbe Karte"},{value:"Gelb-Rote Karte",label:"Gelb-Rote Karte"},{value:"Rote Karte",label:"Rote Karte"},{value:"Verletzung",label:"Verletzung"}]}]}],E=m.find(w=>w.id===a),D=(w,c)=>{switch(c){case"players":n==null||n("squad");break;case"matches":n==null||n("matches");break;case"transactions":n==null||n("finances");break;case"bans":n==null||n("bans");break}},z=()=>{const w=t.length>0?t:E.data;return w.length===0?e.jsxs("div",{className:"p-6 text-center text-text-secondary",children:[e.jsx("i",{className:`${E.icon} text-4xl mb-2`}),e.jsxs("p",{children:["Keine ",E.label.toLowerCase()," gefunden"]})]}):e.jsx("div",{className:"divide-y divide-border-light",children:w.map(c=>e.jsxs("button",{onClick:()=>D(c,a),className:"w-full p-4 hover:bg-bg-secondary transition-colors text-left focus:outline-none focus:ring-2 focus:ring-primary-green focus:ring-inset",children:[a==="players"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:c.name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[c.position," ‚Ä¢ ",c.team," ‚Ä¢ ",c.value||0,"M ‚Ç¨"]}),(c.goals||0)>0&&e.jsxs("p",{className:"text-xs text-primary-green",children:["‚öΩ ",c.goals||0," Tore"]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[c.value||0,"M ‚Ç¨"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zum Spieler ‚Üí"})]})]}),a==="matches"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:new Date(c.date).toLocaleDateString("de-DE")}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[c.teama||"AEK"," ",c.goalsa||0," - ",c.goalsb||0," ",c.teamb||"Real"]}),(()=>{const A=[];try{if(c.goalslista){const s=typeof c.goalslista=="string"?JSON.parse(c.goalslista):c.goalslista;Array.isArray(s)&&s.forEach(l=>{const b=typeof l=="string"?l:l==null?void 0:l.player;b&&A.push(`${b} (AEK)`)})}if(c.goalslistb){const s=typeof c.goalslistb=="string"?JSON.parse(c.goalslistb):c.goalslistb;Array.isArray(s)&&s.forEach(l=>{const b=typeof l=="string"?l:l==null?void 0:l.player;b&&A.push(`${b} (Real)`)})}}catch{}return A.length>0?e.jsxs("p",{className:"text-xs text-text-muted mt-1",children:["‚öΩ ",A.slice(0,3).join(", "),A.length>3?"...":""]}):null})(),c.manofthematch&&e.jsxs("p",{className:"text-xs text-yellow-600 mt-1",children:["‚≠ê SdS: ",c.manofthematch]})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-lg font-bold text-primary-green",children:[(c.goalsa||0)+(c.goalsb||0)," Tore"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zum Spiel ‚Üí"})]})]}),a==="transactions"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:c.type||"Transaktion"}),e.jsx("p",{className:"text-sm text-text-secondary",children:c.description||"Keine Beschreibung"}),e.jsx("p",{className:"text-xs text-text-secondary",children:new Date(c.date).toLocaleDateString("de-DE")})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:`text-lg font-bold ${(c.amount||0)>=0?"text-green-600":"text-red-600"}`,children:[(c.amount||0)>0?"+":"",c.amount||0,"‚Ç¨"]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zu Finanzen ‚Üí"})]})]}),a==="bans"&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-text-primary",children:c.player_name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[c.team," ‚Ä¢ ",c.type]}),c.reason&&e.jsx("p",{className:"text-xs text-text-secondary",children:c.reason})]}),e.jsxs("div",{className:"text-right ml-4",children:[e.jsxs("div",{className:"text-sm text-accent-red",children:[c.duration||1," Spiel",(c.duration||1)!==1?"e":""]}),e.jsx("div",{className:"text-xs text-text-muted",children:"Zu Sperren ‚Üí"})]})]})]},c.id))})};return f?e.jsx(ue,{message:"Lade Daten..."}):e.jsxs("div",{className:"p-4 pb-20 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-1",children:"üîç Globale Suche"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Durchsuche alle Daten zentral an einem Ort"})]}),e.jsx("div",{className:"icon-only-nav flex overflow-x-auto space-x-2 pb-2",children:m.map(w=>e.jsxs("button",{onClick:()=>{r(w.id),o([])},className:`search-nav-button flex items-center space-x-2 px-4 py-2 rounded-lg whitespace-nowrap transition-colors ${a===w.id?"bg-primary-green text-white":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary"}`,title:w.label,"aria-label":w.label,children:[e.jsx("i",{className:w.icon}),e.jsx("span",{className:"font-medium hidden sm:inline",children:w.label}),e.jsxs("span",{className:"text-xs opacity-75",children:["(",w.data.length,")"]})]},w.id))}),e.jsx(Ae,{data:E.data,searchFields:E.searchFields,filterOptions:E.filterOptions,searchExtractor:E.searchExtractor,onResults:o,placeholder:`${E.label} durchsuchen...`}),e.jsxs("div",{className:"modern-card",children:[e.jsx("div",{className:"p-4 border-b border-border-light",children:e.jsxs("h4",{className:"font-medium text-text-primary",children:[t.length>0?"Suchergebnisse":`Alle ${E.label}`,e.jsxs("span",{className:"text-text-secondary ml-2",children:["(",t.length>0?t.length:E.data.length,")"]})]})}),z()]})]})}function Ce(){const{theme:n,autoMode:a,toggleTheme:r,setAutoTheme:t,setManualTheme:o}=ye();return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üé®"}),"Design & Darstellung"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Darstellungsmodus"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>t(!0),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${a?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"üåó"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Automatisch"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Folgt den Systemeinstellungen"})]}),e.jsxs("button",{onClick:()=>o("light"),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${!a&&n==="light"?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"‚òÄÔ∏è"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Hell"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Helle Darstellung"})]}),e.jsxs("button",{onClick:()=>o("dark"),className:`p-4 rounded-lg border-2 transition-all duration-300 flex flex-col items-center space-y-2 ${!a&&n==="dark"?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsx("div",{className:"text-2xl",children:"üåô"}),e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Dunkel"}),e.jsx("div",{className:"text-xs text-text-muted text-center",children:"Dunkle Darstellung"})]})]})]}),e.jsx("div",{className:"bg-bg-tertiary rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Aktueller Modus"}),e.jsx("div",{className:"text-xs text-text-muted",children:a?`Automatisch (${n==="dark"?"Dunkel":"Hell"} - basierend auf Systemeinstellung)`:`Manuell (${n==="dark"?"Dunkel":"Hell"})`})]}),e.jsx("div",{className:"text-2xl",children:n==="dark"?"üåô":"‚òÄÔ∏è"})]})}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Schnellwechsel"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Wechselt zwischen Hell und Dunkel"})]}),e.jsxs("button",{onClick:r,className:"bg-primary-green hover:bg-primary-green-dark text-white px-4 py-2 rounded-lg transition-all duration-300 flex items-center space-x-2",children:[e.jsx("span",{children:n==="dark"?"‚òÄÔ∏è":"üåô"}),e.jsxs("span",{className:"text-sm font-medium",children:["Zu ",n==="dark"?"Hell":"Dunkel"]})]})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üí°"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Darstellungshinweise"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Automatisch:"})," Wechselt automatisch basierend auf Ihren Systemeinstellungen"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Hell:"})," Optimiert f√ºr helle Umgebungen und bessere Akkulaufzeit"]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("strong",{children:"Dunkel:"})," Reduziert Augenbelastung bei schwachem Licht"]}),e.jsx("p",{children:"‚Ä¢ Alle Karten, Modals und UI-Elemente passen sich automatisch an"})]})]})]})})]})})}function Te(){const[n,a]=$.useState({primaryGreen:"#10B981",primaryGreenDark:"#059669",primaryGreenLight:"#34D399",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#3B82F6"}),[r]=$.useState([{name:"Standard",colors:{primaryGreen:"#10B981",primaryGreenDark:"#059669",primaryGreenLight:"#34D399",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#3B82F6"}},{name:"AEK Blau",colors:{primaryGreen:"#1E40AF",primaryGreenDark:"#1E3A8A",primaryGreenLight:"#3B82F6",accentOrange:"#F59E0B",accentRed:"#EF4444",accentBlue:"#60A5FA"}},{name:"Real Rot",colors:{primaryGreen:"#DC2626",primaryGreenDark:"#B91C1C",primaryGreenLight:"#EF4444",accentOrange:"#F59E0B",accentRed:"#F87171",accentBlue:"#3B82F6"}},{name:"Dunkles Gold",colors:{primaryGreen:"#D97706",primaryGreenDark:"#B45309",primaryGreenLight:"#F59E0B",accentOrange:"#FBBF24",accentRed:"#EF4444",accentBlue:"#3B82F6"}}]),[t,o]=$.useState(!1),[x,p]=$.useState("Standard");$.useEffect(()=>{const f=localStorage.getItem("fifa-tracker-custom-colors");if(f)try{const m=JSON.parse(f);a(m),y(m)}catch(m){console.error("Error loading custom colors:",m)}},[]);const y=f=>{const m=document.documentElement;m.style.setProperty("--primary-green",f.primaryGreen),m.style.setProperty("--primary-green-dark",f.primaryGreenDark),m.style.setProperty("--primary-green-light",f.primaryGreenLight),m.style.setProperty("--accent-orange",f.accentOrange),m.style.setProperty("--accent-red",f.accentRed),m.style.setProperty("--accent-blue",f.accentBlue)},h=(f,m)=>{const E={...n,[f]:m};a(E),o(!0),p("Benutzerdefiniert"),y(E)},u=f=>{a(f.colors),p(f.name),o(!0),y(f.colors)},i=()=>{localStorage.setItem("fifa-tracker-custom-colors",JSON.stringify(n)),o(!1);const f=new CustomEvent("show-toast",{detail:{message:"Farbschema gespeichert!",type:"success"}});window.dispatchEvent(f)},d=()=>{const f=r[0].colors;a(f),p("Standard"),o(!0),y(f)},N=({label:f,colorKey:m,value:E,description:D})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary",children:f}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"color",value:E,onChange:z=>h(m,z.target.value),className:"w-12 h-12 rounded-lg border-2 border-border-medium cursor-pointer appearance-none",style:{background:E}}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 rounded-lg border-2 border-white pointer-events-none shadow-sm"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"text",value:E,onChange:z=>h(m,z.target.value),className:"w-full px-3 py-2 text-sm border border-border-medium rounded-lg bg-bg-secondary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green/50",placeholder:"#000000"}),D&&e.jsx("p",{className:"text-xs text-text-muted mt-1",children:D})]})]})]});return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üé®"}),"Farbkonfiguration"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-3",children:"Vorgefertigte Farbschemata"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:r.map(f=>e.jsxs("button",{onClick:()=>u(f),className:`p-3 rounded-lg border-2 transition-all duration-300 ${x===f.name?"border-primary-green bg-primary-green/10":"border-border-medium hover:border-border-dark"}`,children:[e.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:f.colors.primaryGreen}}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:f.colors.accentRed}}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-white/50",style:{backgroundColor:f.colors.accentBlue}})]}),e.jsx("div",{className:"text-xs font-medium text-text-primary",children:f.name})]},f.name))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-text-primary",children:"Individuelle Farbanpassung"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(N,{label:"Prim√§rfarbe",colorKey:"primaryGreen",value:n.primaryGreen,description:"Hauptfarbe f√ºr Buttons und Akzente"}),e.jsx(N,{label:"Prim√§rfarbe (Dunkel)",colorKey:"primaryGreenDark",value:n.primaryGreenDark,description:"Dunklere Variante f√ºr Hover-Effekte"}),e.jsx(N,{label:"Prim√§rfarbe (Hell)",colorKey:"primaryGreenLight",value:n.primaryGreenLight,description:"Hellere Variante f√ºr Highlights"}),e.jsx(N,{label:"Akzentfarbe Orange",colorKey:"accentOrange",value:n.accentOrange,description:"Orange Akzente und Warnungen"}),e.jsx(N,{label:"Akzentfarbe Rot",colorKey:"accentRed",value:n.accentRed,description:"Rote Akzente und Fehler"}),e.jsx(N,{label:"Akzentfarbe Blau",colorKey:"accentBlue",value:n.accentBlue,description:"Blaue Akzente und Informationen"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-border-light",children:[e.jsx("button",{onClick:i,disabled:!t,className:`flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-300 ${t?"bg-primary-green hover:bg-primary-green-dark text-white":"bg-border-medium text-text-muted cursor-not-allowed"}`,children:t?"Farben speichern":"Keine √Ñnderungen"}),e.jsx("button",{onClick:d,className:"py-3 px-4 bg-bg-tertiary hover:bg-border-light text-text-primary border border-border-medium rounded-lg font-medium transition-all duration-300",children:"Zur√ºcksetzen"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-bg-tertiary rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-text-primary mb-3",children:"Vorschau"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"btn-primary text-sm py-2 px-4",style:{backgroundColor:n.primaryGreen,borderColor:n.primaryGreen},children:"Prim√§r Button"}),e.jsx("div",{className:"px-3 py-2 rounded text-white text-sm",style:{backgroundColor:n.accentRed},children:"Rot Akzent"}),e.jsx("div",{className:"px-3 py-2 rounded text-white text-sm",style:{backgroundColor:n.accentBlue},children:"Blau Akzent"}),e.jsx("div",{className:"px-3 py-2 rounded text-white text-sm",style:{backgroundColor:n.accentOrange},children:"Orange Akzent"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üí°"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Farbhinweise"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsx("p",{children:"‚Ä¢ √Ñnderungen werden sofort in der Vorschau angezeigt"}),e.jsx("p",{children:"‚Ä¢ Gespeicherte Farben werden automatisch bei der n√§chsten Anmeldung geladen"}),e.jsx("p",{children:"‚Ä¢ Verwenden Sie Hex-Codes (#RRGGBB) f√ºr pr√§zise Farben"}),e.jsx("p",{children:"‚Ä¢ Team-spezifische Presets helfen bei der schnellen Anpassung"})]})]})]})})]})})}class De{constructor(){this.isSupported="serviceWorker"in navigator&&"PushManager"in window,this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent),this.permission=Notification.permission,this.subscription=null,this.settings=this.loadSettings()}async initialize(){if(!this.isSupported)return console.warn("Push notifications not supported"),!1;try{if("serviceWorker"in navigator){const a=await navigator.serviceWorker.register("/sw.js");console.log("Service Worker registered:",a)}return this.permission=Notification.permission,!0}catch(a){return console.error("Failed to initialize notifications:",a),!1}}async requestPermission(){if(!this.isSupported)throw new Error("Notifications not supported");if(this.permission==="granted")return!0;try{if(this.isIOS){const a=await Notification.requestPermission();return this.permission=a,a==="granted"}else{const a=await Notification.requestPermission();return this.permission=a,a==="granted"}}catch(a){return console.error("Permission request failed:",a),!1}}async subscribe(){if(!this.isSupported||this.permission!=="granted")throw new Error("Cannot subscribe: permission not granted");try{const a=await navigator.serviceWorker.ready,r=await a.pushManager.getSubscription();if(r)return this.subscription=r,r;const t=await a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.getVAPIDKey()});return this.subscription=t,await this.sendSubscriptionToServer(t),t}catch(a){throw console.error("Subscription failed:",a),a}}async unsubscribe(){if(!this.subscription)return!0;try{return await this.subscription.unsubscribe(),await this.removeSubscriptionFromServer(this.subscription),this.subscription=null,!0}catch(a){return console.error("Unsubscribe failed:",a),!1}}async scheduleMatchReminder(a,r=30){if(!this.settings.matchReminders)return;const t=new Date(a.date),o=new Date(t.getTime()-r*60*1e3),x=new Date;if(o<=x)return;const p=o.getTime()-x.getTime();setTimeout(()=>{this.showNotification({title:"‚öΩ FIFA Match Reminder",body:`Match starting in ${r} minutes: AEK vs Real Madrid`,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`match-reminder-${a.id}`,data:{type:"match_reminder",matchId:a.id,url:"/matches"},actions:[{action:"view",title:"View Match",icon:"/assets/icon-180.png"},{action:"dismiss",title:"Dismiss"}]})},p)}async notifyAchievement(a){this.settings.achievements&&await this.showNotification({title:"üèÜ Achievement Unlocked!",body:a.title,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`achievement-${a.id}`,data:{type:"achievement",achievementId:a.id,url:"/stats"}})}async notifyGoal(a,r,t){this.settings.goals&&await this.showNotification({title:"‚öΩ GOAL!",body:`${t} scored for ${r}!`,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`goal-${a.id}-${Date.now()}`,data:{type:"goal",matchId:a.id,url:"/matches"}})}async notifyEvent(a){this.settings.events&&await this.showNotification({title:`üéâ ${a.name}`,body:a.description,icon:"/assets/icon-180.png",badge:"/assets/icon-180.png",tag:`event-${a.id}`,data:{type:"event",eventId:a.id,url:"/events"}})}async showNotification(a){if(this.permission!=="granted"){console.warn("Cannot show notification: permission not granted");return}try{"serviceWorker"in navigator?await(await navigator.serviceWorker.ready).showNotification(a.title,{body:a.body,icon:a.icon,badge:a.badge,tag:a.tag,data:a.data,actions:a.actions||[],vibrate:this.isIOS?void 0:[200,100,200],requireInteraction:!1,silent:!1}):new Notification(a.title,{body:a.body,icon:a.icon,tag:a.tag,data:a.data})}catch(r){console.error("Failed to show notification:",r)}}updateSettings(a){this.settings={...this.settings,...a},localStorage.setItem("fifa-tracker-notification-settings",JSON.stringify(this.settings))}loadSettings(){const a=localStorage.getItem("fifa-tracker-notification-settings"),r={matchReminders:!0,goals:!0,achievements:!0,events:!0,reminderTime:30};return a?{...r,...JSON.parse(a)}:r}getVAPIDKey(){return"BEl62iUYgUivxIkv69yViEuiBIa40HI0DLLuxazjqak_7kYDjLE2cI5GkJM-5z9z9LzsQI7JClZgZmKjgKrRxfQ"}async sendSubscriptionToServer(a){try{console.log("Would send subscription to server:",a)}catch(r){console.error("Failed to send subscription to server:",r)}}async removeSubscriptionFromServer(a){try{console.log("Would remove subscription from server:",a)}catch(r){console.error("Failed to remove subscription from server:",r)}}async testNotification(){await this.showNotification({title:"üß™ Test Notification",body:"FUSTA notifications are working!",icon:"/assets/icon-180.png",tag:"test-notification"})}getStatus(){return{supported:this.isSupported,permission:this.permission,subscribed:!!this.subscription,isIOS:this.isIOS,settings:this.settings}}}const K=new De;typeof window<"u"&&(window.NotificationService=K,K.initialize());function $e(){const[n,a]=$.useState(K.getStatus()),[r,t]=$.useState(K.settings),[o,x]=$.useState(!1);$.useEffect(()=>{a(K.getStatus()),t(K.settings)},[]);const p=async()=>{x(!0);try{await K.requestPermission()&&await K.subscribe(),a(K.getStatus())}catch(i){console.error("Permission request failed:",i);const d=new CustomEvent("show-toast",{detail:{message:"Benachrichtigungen konnten nicht aktiviert werden.",type:"error"}});window.dispatchEvent(d)}finally{x(!1)}},y=async()=>{x(!0);try{await K.unsubscribe(),a(K.getStatus())}catch(i){console.error("Unsubscribe failed:",i)}finally{x(!1)}},h=(i,d)=>{const N={...r,[i]:d};t(N),K.updateSettings(N)},u=async()=>{try{await K.testNotification();const i=new CustomEvent("show-toast",{detail:{message:"Test-Benachrichtigung gesendet!",type:"success"}});window.dispatchEvent(i)}catch(i){console.error("Test notification failed:",i)}};return n.supported?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üì±"}),"Push-Benachrichtigungen"]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"Status"}),e.jsxs("div",{className:"text-xs text-text-muted",children:[n.permission==="granted"?"Benachrichtigungen aktiviert":n.permission==="denied"?"Benachrichtigungen blockiert":"Berechtigung ausstehend",n.isIOS&&" (iOS)"]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${n.permission==="granted"?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300":n.permission==="denied"?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300"}`,children:n.permission==="granted"?"Aktiv":n.permission==="denied"?"Blockiert":"Ausstehend"})]})}),n.permission!=="granted"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:p,disabled:o||n.permission==="denied",className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-300 ${n.permission==="denied"?"bg-border-medium text-text-muted cursor-not-allowed":"bg-primary-green hover:bg-primary-green-dark text-white"}`,children:o?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Aktiviere..."]}):n.permission==="denied"?"In Browsereinstellungen aktivieren":"Benachrichtigungen aktivieren"}),n.permission==="denied"&&e.jsx("p",{className:"text-xs text-text-muted mt-2 text-center",children:"√ñffnen Sie die Browsereinstellungen und erlauben Sie Benachrichtigungen f√ºr diese Seite."})]}),n.permission==="granted"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-md font-medium text-text-primary",children:"Benachrichtigungseinstellungen"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"‚öΩ Spiel-Erinnerungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Erinnerungen vor Spielbeginn"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.matchReminders,onChange:i=>h("matchReminders",i.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),r.matchReminders&&e.jsxs("div",{className:"ml-4 p-3 bg-bg-tertiary rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Erinnerungszeit (Minuten vor Spielbeginn)"}),e.jsxs("select",{value:r.reminderTime,onChange:i=>h("reminderTime",parseInt(i.target.value)),className:"w-full px-3 py-2 text-sm border border-border-medium rounded-lg bg-bg-secondary text-text-primary focus:outline-none focus:ring-2 focus:ring-primary-green/50",children:[e.jsx("option",{value:5,children:"5 Minuten"}),e.jsx("option",{value:15,children:"15 Minuten"}),e.jsx("option",{value:30,children:"30 Minuten"}),e.jsx("option",{value:60,children:"1 Stunde"}),e.jsx("option",{value:120,children:"2 Stunden"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"‚öΩ Tor-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei Toren w√§hrend Live-Matches"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.goals,onChange:i=>h("goals",i.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"üèÜ Achievement-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei freigeschalteten Erfolgen"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.achievements,onChange:i=>h("achievements",i.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-tertiary rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-text-primary",children:"üéâ Event-Benachrichtigungen"}),e.jsx("div",{className:"text-xs text-text-muted",children:"Bei neuen Events und Turnieren"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.events,onChange:i=>h("events",i.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-border-medium peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-green/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-green"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-border-light",children:[e.jsx("button",{onClick:u,className:"flex-1 py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-all duration-300",children:"Test-Benachrichtigung"}),e.jsx("button",{onClick:y,disabled:o,className:"py-2 px-4 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-all duration-300 disabled:opacity-50",children:o?"Deaktiviere...":"Deaktivieren"})]})]}),n.isIOS&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-blue-500 text-xl flex-shrink-0",children:"üì±"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"iOS-Hinweis"}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1",children:[e.jsx("p",{children:'‚Ä¢ Installieren Sie die App √ºber "Zum Home-Bildschirm hinzuf√ºgen" f√ºr beste Benachrichtigungen'}),e.jsx("p",{children:"‚Ä¢ Benachrichtigungen funktionieren nur bei aktiver App oder im Hintergrund"}),e.jsx("p",{children:"‚Ä¢ √úberpr√ºfen Sie die iOS-Einstellungen f√ºr App-Benachrichtigungen"})]})]})]})})]})}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 border border-border-light",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"text-xl mr-2",children:"üì±"}),"Push-Benachrichtigungen"]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"text-yellow-500 text-xl flex-shrink-0",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200 mb-1",children:"Nicht unterst√ºtzt"}),e.jsx("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:"Ihr Browser unterst√ºtzt keine Push-Benachrichtigungen. Verwenden Sie einen modernen Browser oder installieren Sie die App f√ºr Benachrichtigungen."})]})]})})]})})}function Be(){const[n,a]=$.useState({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}}),[r,t]=$.useState(!1),[o,x]=$.useState(!0);$.useEffect(()=>{p()},[]);const p=async()=>{try{x(!0),console.log("üîÑ [AdminTab] Loading managers from database...");const d=await q.getManagers();if(console.log("üìä [AdminTab] Manager data result:",d),d&&d.data&&Array.isArray(d.data)&&d.data.length>=2){console.log("‚úÖ [AdminTab] Manager data loaded successfully:",d.data);const N=d.data.find(m=>m.id===1)||{name:"Alexander",gewicht:110},f=d.data.find(m=>m.id===2)||{name:"Philip",gewicht:105};console.log("üë§ [AdminTab] AEK Manager:",N),console.log("üë§ [AdminTab] Real Manager:",f),a({aek:{name:N.name,age:30,weight:N.gewicht},real:{name:f.name,age:30,weight:f.gewicht}})}else console.warn("‚ö†Ô∏è [AdminTab] No manager data found, using defaults. Result:",d),await y()}catch(d){console.error("‚ùå [AdminTab] Error loading manager settings from database:",d),await y()}finally{x(!1)}},y=async()=>{try{console.log("üîß [AdminTab] Initializing default managers...");const d={name:"Alexander",gewicht:110},N=await q.insert("managers",d);console.log("‚úÖ [AdminTab] AEK manager created:",N);const f={name:"Philip",gewicht:105},m=await q.insert("managers",f);console.log("‚úÖ [AdminTab] Real manager created:",m),a({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}})}catch(d){console.error("‚ùå [AdminTab] Error initializing managers:",d),a({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}})}},h=(d,N,f)=>{a(m=>({...m,[d]:{...m[d],[N]:N==="name"?f:parseInt(f)||0}})),t(!0)},u=async()=>{try{x(!0),console.log("üíæ [TeamSettings] Saving manager settings:",n);const d={name:n.aek.name,gewicht:n.aek.weight},N={name:n.real.name,gewicht:n.real.weight};console.log("üíæ [TeamSettings] AEK Data:",d),console.log("üíæ [TeamSettings] Real Data:",N);const f=await q.update("managers",d,1);console.log("üíæ [TeamSettings] AEK Update Result:",f);const m=await q.update("managers",N,2);console.log("üíæ [TeamSettings] Real Update Result:",m),t(!1),window.dispatchEvent(new CustomEvent("managerSettingsChanged"));const E=document.createElement("div");E.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",E.textContent="Manager-Einstellungen gespeichert!",document.body.appendChild(E),setTimeout(()=>{document.body.contains(E)&&document.body.removeChild(E)},3e3)}catch(d){console.error("Error saving manager settings:",d);const N=document.createElement("div");N.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",N.textContent="Fehler beim Speichern!",document.body.appendChild(N),setTimeout(()=>{document.body.contains(N)&&document.body.removeChild(N)},3e3)}finally{x(!1)}},i=()=>{a({aek:{name:"Alexander",age:30,weight:110},real:{name:"Philip",age:30,weight:105}}),t(!0)};return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsx(Ce,{}),e.jsx(Te,{}),e.jsx($e,{}),o?e.jsx("div",{className:"modern-card",children:e.jsxs("div",{className:"flex justify-center items-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-green"}),e.jsx("span",{className:"ml-2 text-text-muted",children:"Lade Manager-Einstellungen..."})]})}):e.jsxs("div",{className:"modern-card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"üèÜ Team-Manager Einstellungen"}),r&&e.jsx("span",{className:"text-sm text-orange-600 font-medium",children:"Ungespeicherte √Ñnderungen"})]}),e.jsx("div",{className:"text-sm text-text-muted mb-6",children:"Hier k√∂nnen Sie die Daten der Team-Manager f√ºr die BAK-Berechnung anpassen."}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4 p-4 border border-blue-200 rounded-lg bg-blue-50",children:[e.jsxs("h4",{className:"font-medium text-blue-800 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded mr-2"}),"AEK Manager"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.aek.name,onChange:d=>h("aek","name",d.target.value),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Manager Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Alter"}),e.jsx("input",{type:"number",min:"18",max:"80",value:n.aek.age,onChange:d=>h("aek","age",d.target.value),onFocus:d=>d.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gewicht (kg)"}),e.jsx("input",{type:"number",min:"40",max:"200",value:n.aek.weight,onChange:d=>h("aek","weight",d.target.value),onFocus:d=>d.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 border border-red-200 rounded-lg bg-red-50",children:[e.jsxs("h4",{className:"font-medium text-red-800 flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-red-600 rounded mr-2"}),"Real Manager"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{type:"text",value:n.real.name,onChange:d=>h("real","name",d.target.value),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Manager Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Alter"}),e.jsx("input",{type:"number",min:"18",max:"80",value:n.real.age,onChange:d=>h("real","age",d.target.value),onFocus:d=>d.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gewicht (kg)"}),e.jsx("input",{type:"number",min:"40",max:"200",value:n.real.weight,onChange:d=>h("real","weight",d.target.value),onFocus:d=>d.target.select(),className:"w-full px-3 py-2 border border-border-light rounded-lg bg-white text-text-primary focus:outline-none focus:ring-2 focus:ring-red-500"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-border-light",children:[e.jsx("button",{onClick:i,className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-200 transition-colors",children:"Standardwerte wiederherstellen"}),e.jsx("button",{onClick:u,disabled:!r||o,className:`px-4 py-2 text-sm rounded-lg transition-colors ${r&&!o?"bg-primary-green text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:o?"Speichern...":"Einstellungen speichern"})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Hinweis:"})," Diese Einstellungen werden f√ºr die BAK-Berechnung in der Statistik verwendet. Die Werte werden in der Datenbank gespeichert."]})})]})]})}function Me(){const[n,a]=$.useState(()=>{const u=localStorage.getItem("eventsTabEnabled");return u!==null?JSON.parse(u):!1}),[r,t]=$.useState({title:"",message:"",type:"general"}),[o,x]=$.useState(()=>{const u=localStorage.getItem("customEvents");return u?JSON.parse(u):[]}),p=u=>{a(u),localStorage.setItem("eventsTabEnabled",JSON.stringify(u)),setTimeout(()=>{window.location.reload()},500)},y=()=>{if(!r.title||!r.message){alert("Bitte Titel und Nachricht eingeben");return}L(r.type,{title:r.title,message:r.message,timestamp:new Date().toISOString(),custom:!0});const i=[{id:Date.now(),...r,timestamp:new Date().toISOString()},...o.slice(0,9)];x(i),localStorage.setItem("customEvents",JSON.stringify(i)),t({title:"",message:"",type:"general"}),alert("Benachrichtigung gesendet!")},h=[{value:"general",label:"üì¢ Allgemein",color:"bg-gray-500"},{value:"match-created",label:"‚öΩ Spiel erstellt",color:"bg-green-500"},{value:"player-ban",label:"üö´ Spieler gesperrt",color:"bg-red-500"},{value:"financial-milestone",label:"üí∞ Finanzmeilenstein",color:"bg-yellow-500"},{value:"achievement-unlocked",label:"üèÖ Achievement",color:"bg-purple-500"},{value:"system-update",label:"üîÑ System Update",color:"bg-blue-500"}];return e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üéâ"}),"Events Tab Konfiguration"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-secondary rounded-lg border border-border-light",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-text-primary",children:"Events Tab anzeigen"}),e.jsx("div",{className:"text-sm text-text-muted",children:"Zeigt den Events Tab in der Navigation an oder blendet ihn aus"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:u=>p(u.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Hinweis:"})," Der Events Tab ist standardm√§√üig ausgeblendet. Nach dem Aktivieren wird die Seite neu geladen um die Navigation zu aktualisieren."]})})]})]}),e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üöÄ"}),"Schnell-Tests f√ºr Push-Benachrichtigungen"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>L("match-result",{goalsa:3,goalsb:1,manofthematch:"Max M√ºller",date:new Date().toISOString()}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"‚öΩ"}),"Spielergebnis-Test"]}),e.jsxs("button",{onClick:()=>L("player-ban",{playerName:"Tom Schmidt",games:3}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üö´"}),"Spieler-Sperre"]}),e.jsxs("button",{onClick:()=>L("financial-milestone",{team:"AEK Athen",amount:250}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üí∞"}),"Finanzmeilenstein"]}),e.jsxs("button",{onClick:()=>L("achievement-unlocked",{name:"Torj√§ger",description:"10 Tore in einer Saison"}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üèÖ"}),"Achievement"]}),e.jsxs("button",{onClick:()=>L("system-update",{message:"Neue Funktionen verf√ºgbar!"}),className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üîÑ"}),"System-Update"]}),e.jsxs("button",{onClick:()=>{setTimeout(()=>L("match-created",{date:new Date().toISOString()}),0),setTimeout(()=>L("player-ban",{playerName:"Test Player",games:1}),300),setTimeout(()=>L("financial-milestone",{team:"Real Madrid",amount:100}),600)},className:"btn-secondary text-sm py-3 px-4 card-hover-lift btn-spring-press flex items-center justify-center gap-2",children:[e.jsx("span",{children:"üìö"}),"Mehrere Tests"]})]}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Tipp:"})," Diese Buttons testen die neuen Push-Up Benachrichtigungen mit realistischen Daten und Animationen."]})})]}),e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üì¢"}),"Individuelle Push-Benachrichtigungen"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Nachrichtentyp"}),e.jsx("select",{value:r.type,onChange:u=>t(i=>({...i,type:u.target.value})),className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors",children:h.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Titel"}),e.jsx("input",{type:"text",value:r.title,onChange:u=>t(i=>({...i,title:u.target.value})),placeholder:"z.B. Neues Tournament startet",className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Nachricht"}),e.jsx("textarea",{value:r.message,onChange:u=>t(i=>({...i,message:u.target.value})),placeholder:"z.B. Das Weihnachts-Tournament beginnt morgen um 19:00 Uhr!",rows:3,className:"w-full px-3 py-2 bg-bg-secondary border border-border-light rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-blue transition-colors resize-none"})]}),e.jsxs("button",{onClick:y,disabled:!r.title||!r.message,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("i",{className:"fas fa-paper-plane mr-2"}),"Benachrichtigung senden"]})]})]}),o.length>0&&e.jsxs("div",{className:"modern-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üìã"}),"Gesendete Benachrichtigungen"]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:o.map(u=>{var i;return e.jsx("div",{className:"p-3 bg-bg-secondary rounded-lg border border-border-light",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-text-primary text-sm flex items-center",children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${((i=h.find(d=>d.value===u.type))==null?void 0:i.color)||"bg-gray-500"}`}),u.title]}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:u.message}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:new Date(u.timestamp).toLocaleString("de-DE")})]})})},u.id)})}),o.length>=10&&e.jsx("div",{className:"text-xs text-text-muted mt-2 text-center",children:"Nur die letzten 10 Benachrichtigungen werden angezeigt"})]})]})}function Ie({onLogout:n,onNavigate:a,showHints:r=!1}){const[t,o]=$.useState("search"),x=[{id:"search",label:"Globale Suche",icon:"fas fa-search"},{id:"matches",label:"Spiele hinzuf√ºgen",icon:"fas fa-futbol"},{id:"bans",label:"Sperren hinzuf√ºgen",icon:"fas fa-ban"},{id:"players",label:"Spieler hinzuf√ºgen",icon:"fas fa-users"},{id:"transactions",label:"Transaktionen hinzuf√ºgen",icon:"fas fa-euro-sign"},{id:"settings",label:"Team-Einstellungen",icon:"fas fa-cog"},{id:"events",label:"Events & Benachrichtigungen",icon:"fas fa-bell"},{id:"delete",label:"Daten l√∂schen",icon:"fas fa-trash"}],p=()=>{switch(t){case"search":return e.jsx(me,{onNavigate:a});case"matches":return e.jsx(Ne,{});case"bans":return e.jsx(we,{});case"players":return e.jsx(Se,{});case"transactions":return e.jsx(ke,{});case"settings":return e.jsx(Be,{});case"events":return e.jsx(Me,{});case"delete":return e.jsx(Ee,{});default:return e.jsx(me,{onNavigate:a})}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-4 bg-bg-secondary border-b border-border-light flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-1",children:"Verwaltung"}),e.jsx("p",{className:"text-text-muted text-sm",children:"Hinzuf√ºgen und verwalten von Daten"})]}),e.jsxs("button",{onClick:n,className:"flex items-center px-3 py-2 bg-accent-red text-white rounded-lg hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50","aria-label":"Abmelden",children:[e.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),e.jsx("span",{className:"text-sm",children:"Logout"})]})]}),e.jsx("div",{className:"bg-bg-secondary border-b border-border-light",children:e.jsx("div",{className:"flex overflow-x-auto",children:x.map(y=>e.jsxs("button",{onClick:()=>o(y.id),className:`flex-shrink-0 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap ${t===y.id?"text-primary-green border-b-2 border-primary-green bg-bg-primary":"text-text-secondary hover:text-text-primary hover:bg-bg-hover"}`,children:[e.jsx("i",{className:`${y.icon} mr-2`}),y.label]},y.id))})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:p()})]})}export{Ie as default};
